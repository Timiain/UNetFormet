/disk1/lhl/env/airs/lib/python3.8/site-packages/torch/functional.py:478: UserWarning:

torch.meshgrid: in an upcoming release, it will be required to pass the indexing argument. (Triggered internally at  /opt/conda/conda-bld/pytorch_1659484657607/work/aten/src/ATen/native/TensorShape.cpp:2895.)

GPU available: True, used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0,1,2]

  | Name | Type           | Params
----------------------------------------
0 | net  | UNetFormer     | 11.7 M
1 | loss | UnetFormerLoss | 0     
----------------------------------------
11.7 M    Trainable params
0         Non-trainable params
11.7 M    Total params
46.900    Total estimated model params size (MB)
/disk1/lhl/env/airs/lib/python3.8/site-packages/pytorch_lightning/trainer/data_loading.py:132: UserWarning:

The dataloader, val_dataloader 0, does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` (try 16 which is the number of cpus on this machine) in the `DataLoader` init to improve performance.

/disk1/lhl/workspace/unetformer/GeoSeg/tools/metric.py:29: RuntimeWarning:

invalid value encountered in divide

/disk1/lhl/env/airs/lib/python3.8/site-packages/pytorch_lightning/trainer/data_loading.py:132: UserWarning:

The dataloader, train_dataloader, does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` (try 16 which is the number of cpus on this machine) in the `DataLoader` init to improve performance.

/disk1/lhl/env/airs/lib/python3.8/site-packages/pytorch_lightning/trainer/data_loading.py:432: UserWarning:

The number of training samples (45) is smaller than the logging interval Trainer(log_every_n_steps=50). Set a lower value for log_every_n_steps if you want to see logs for the training epoch.

/disk1/lhl/env/airs/lib/python3.8/site-packages/torch/functional.py:478: UserWarning:

torch.meshgrid: in an upcoming release, it will be required to pass the indexing argument. (Triggered internally at  /opt/conda/conda-bld/pytorch_1659484657607/work/aten/src/ATen/native/TensorShape.cpp:2895.)

  0%|          | 0/57 [00:00<?, ?it/s]  2%|▏         | 1/57 [00:06<06:15,  6.70s/it]  4%|▎         | 2/57 [00:08<03:34,  3.90s/it]  5%|▌         | 3/57 [00:10<02:43,  3.03s/it]  7%|▋         | 4/57 [00:12<02:18,  2.61s/it]  9%|▉         | 5/57 [00:14<02:03,  2.37s/it] 11%|█         | 6/57 [00:16<01:54,  2.24s/it] 12%|█▏        | 7/57 [00:18<01:48,  2.17s/it] 14%|█▍        | 8/57 [00:20<01:43,  2.10s/it] 16%|█▌        | 9/57 [00:22<01:39,  2.08s/it] 18%|█▊        | 10/57 [00:24<01:36,  2.06s/it] 19%|█▉        | 11/57 [00:26<01:36,  2.09s/it] 21%|██        | 12/57 [00:28<01:33,  2.08s/it] 23%|██▎       | 13/57 [00:30<01:29,  2.04s/it] 25%|██▍       | 14/57 [00:32<01:27,  2.05s/it] 26%|██▋       | 15/57 [00:34<01:26,  2.06s/it] 28%|██▊       | 16/57 [00:36<01:23,  2.03s/it] 30%|██▉       | 17/57 [00:39<01:22,  2.07s/it] 32%|███▏      | 18/57 [00:41<01:20,  2.06s/it] 33%|███▎      | 19/57 [00:43<01:17,  2.04s/it] 35%|███▌      | 20/57 [00:45<01:16,  2.06s/it] 37%|███▋      | 21/57 [00:47<01:14,  2.06s/it] 39%|███▊      | 22/57 [00:49<01:12,  2.06s/it] 40%|████      | 23/57 [00:51<01:09,  2.05s/it] 42%|████▏     | 24/57 [00:53<01:07,  2.04s/it] 44%|████▍     | 25/57 [00:55<01:04,  2.03s/it] 46%|████▌     | 26/57 [00:57<01:03,  2.05s/it] 47%|████▋     | 27/57 [00:59<01:01,  2.06s/it] 49%|████▉     | 28/57 [01:01<00:59,  2.05s/it] 51%|█████     | 29/57 [01:03<00:56,  2.03s/it] 53%|█████▎    | 30/57 [01:05<00:55,  2.05s/it] 54%|█████▍    | 31/57 [01:07<00:53,  2.05s/it] 56%|█████▌    | 32/57 [01:09<00:51,  2.04s/it] 58%|█████▊    | 33/57 [01:11<00:49,  2.05s/it] 60%|█████▉    | 34/57 [01:13<00:46,  2.04s/it] 61%|██████▏   | 35/57 [01:15<00:44,  2.04s/it] 63%|██████▎   | 36/57 [01:17<00:43,  2.08s/it] 65%|██████▍   | 37/57 [01:19<00:41,  2.06s/it] 67%|██████▋   | 38/57 [01:21<00:38,  2.04s/it] 68%|██████▊   | 39/57 [01:23<00:36,  2.03s/it] 70%|███████   | 40/57 [01:26<00:34,  2.03s/it] 72%|███████▏  | 41/57 [01:28<00:32,  2.04s/it] 74%|███████▎  | 42/57 [01:30<00:30,  2.05s/it] 75%|███████▌  | 43/57 [01:32<00:28,  2.06s/it] 77%|███████▋  | 44/57 [01:34<00:26,  2.05s/it] 79%|███████▉  | 45/57 [01:36<00:24,  2.04s/it] 81%|████████  | 46/57 [01:38<00:22,  2.04s/it] 82%|████████▏ | 47/57 [01:40<00:20,  2.06s/it] 84%|████████▍ | 48/57 [01:42<00:18,  2.06s/it] 86%|████████▌ | 49/57 [01:44<00:16,  2.05s/it] 88%|████████▊ | 50/57 [01:46<00:14,  2.03s/it] 89%|████████▉ | 51/57 [01:48<00:12,  2.04s/it] 91%|█████████ | 52/57 [01:50<00:10,  2.04s/it] 93%|█████████▎| 53/57 [01:52<00:08,  2.07s/it] 95%|█████████▍| 54/57 [01:54<00:06,  2.05s/it] 96%|█████████▋| 55/57 [01:56<00:04,  2.03s/it] 98%|█████████▊| 56/57 [01:58<00:02,  2.04s/it]100%|██████████| 57/57 [02:02<00:00,  2.54s/it]100%|██████████| 57/57 [02:02<00:00,  2.15s/it]
/disk1/lhl/env/airs/lib/python3.8/site-packages/torch/functional.py:478: UserWarning:

torch.meshgrid: in an upcoming release, it will be required to pass the indexing argument. (Triggered internally at  /opt/conda/conda-bld/pytorch_1659484657607/work/aten/src/ATen/native/TensorShape.cpp:2895.)

GPU available: True, used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0,1,2]
/disk1/lhl/env/airs/lib/python3.8/site-packages/torch/functional.py:478: UserWarning:

torch.meshgrid: in an upcoming release, it will be required to pass the indexing argument. (Triggered internally at  /opt/conda/conda-bld/pytorch_1659484657607/work/aten/src/ATen/native/TensorShape.cpp:2895.)

GPU available: True, used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0,1,2]

  | Name | Type           | Params
----------------------------------------
0 | net  | UNetFormer     | 11.7 M
1 | loss | UnetFormerLoss | 0     
----------------------------------------
11.7 M    Trainable params
0         Non-trainable params
11.7 M    Total params
46.900    Total estimated model params size (MB)
/disk1/lhl/env/airs/lib/python3.8/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:631: UserWarning:

Checkpoint directory /disk1/lhl/workspace/unetformer/GeoSeg/model_weights/vaihingen/unetformer-r18-512-crop-ms-e100 exists and is not empty.


  | Name | Type           | Params
----------------------------------------
0 | net  | UNetFormer     | 11.7 M
1 | loss | UnetFormerLoss | 0     
----------------------------------------
11.7 M    Trainable params
0         Non-trainable params
11.7 M    Total params
46.900    Total estimated model params size (MB)
/disk1/lhl/env/airs/lib/python3.8/site-packages/pytorch_lightning/trainer/data_loading.py:132: UserWarning:

The dataloader, val_dataloader 0, does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` (try 16 which is the number of cpus on this machine) in the `DataLoader` init to improve performance.

/disk1/lhl/env/airs/lib/python3.8/site-packages/pytorch_lightning/trainer/data_loading.py:132: UserWarning:

The dataloader, train_dataloader, does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` (try 16 which is the number of cpus on this machine) in the `DataLoader` init to improve performance.

/disk1/lhl/env/airs/lib/python3.8/site-packages/pytorch_lightning/trainer/data_loading.py:132: UserWarning:

The dataloader, val_dataloader 0, does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` (try 16 which is the number of cpus on this machine) in the `DataLoader` init to improve performance.

/disk1/lhl/env/airs/lib/python3.8/site-packages/pytorch_lightning/trainer/data_loading.py:132: UserWarning:

The dataloader, train_dataloader, does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` (try 16 which is the number of cpus on this machine) in the `DataLoader` init to improve performance.

/disk1/lhl/env/airs/lib/python3.8/site-packages/pytorch_lightning/trainer/data_loading.py:432: UserWarning:

The number of training samples (45) is smaller than the logging interval Trainer(log_every_n_steps=50). Set a lower value for log_every_n_steps if you want to see logs for the training epoch.

Killed
/disk1/lhl/env/airs/lib/python3.8/site-packages/torch/functional.py:478: UserWarning:

torch.meshgrid: in an upcoming release, it will be required to pass the indexing argument. (Triggered internally at  /opt/conda/conda-bld/pytorch_1659484657607/work/aten/src/ATen/native/TensorShape.cpp:2895.)

Traceback (most recent call last):
  File "./potsdam_test.py", line 134, in <module>
    main()
  File "./potsdam_test.py", line 69, in main
    model = Supervision_Train.load_from_checkpoint(
  File "/disk1/lhl/env/airs/lib/python3.8/site-packages/pytorch_lightning/core/saving.py", line 134, in load_from_checkpoint
    checkpoint = pl_load(checkpoint_path, map_location=lambda storage, loc: storage)
  File "/disk1/lhl/env/airs/lib/python3.8/site-packages/pytorch_lightning/utilities/cloud_io.py", line 37, in load
    with fs.open(path_or_url, "rb") as f:
  File "/disk1/lhl/env/airs/lib/python3.8/site-packages/fsspec/spec.py", line 1034, in open
    f = self._open(
  File "/disk1/lhl/env/airs/lib/python3.8/site-packages/fsspec/implementations/local.py", line 162, in _open
    return LocalFileOpener(path, mode, fs=self, **kwargs)
  File "/disk1/lhl/env/airs/lib/python3.8/site-packages/fsspec/implementations/local.py", line 260, in __init__
    self._open()
  File "/disk1/lhl/env/airs/lib/python3.8/site-packages/fsspec/implementations/local.py", line 265, in _open
    self.f = open(self.path, mode=self.mode)
FileNotFoundError: [Errno 2] No such file or directory: '/disk1/lhl/workspace/unetformer/GeoSeg/model_weights/potsdam/unetformer-r18-768crop-ms-e45/unetformer-r18-768crop-ms-e45.ckpt'
/disk1/lhl/env/airs/lib/python3.8/site-packages/torch/functional.py:478: UserWarning:

torch.meshgrid: in an upcoming release, it will be required to pass the indexing argument. (Triggered internally at  /opt/conda/conda-bld/pytorch_1659484657607/work/aten/src/ATen/native/TensorShape.cpp:2895.)

GPU available: True, used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0,1,2]

  | Name | Type           | Params
----------------------------------------
0 | net  | UNetFormer     | 11.7 M
1 | loss | UnetFormerLoss | 0     
----------------------------------------
11.7 M    Trainable params
0         Non-trainable params
11.7 M    Total params
46.900    Total estimated model params size (MB)
/disk1/lhl/env/airs/lib/python3.8/site-packages/pytorch_lightning/trainer/data_loading.py:132: UserWarning:

The dataloader, val_dataloader 0, does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` (try 16 which is the number of cpus on this machine) in the `DataLoader` init to improve performance.

/disk1/lhl/env/airs/lib/python3.8/site-packages/pytorch_lightning/trainer/data_loading.py:132: UserWarning:

The dataloader, train_dataloader, does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` (try 16 which is the number of cpus on this machine) in the `DataLoader` init to improve performance.

/disk1/lhl/workspace/unetformer/GeoSeg/tools/metric.py:29: RuntimeWarning:

invalid value encountered in divide

/disk1/lhl/env/airs/lib/python3.8/site-packages/torch/functional.py:478: UserWarning:

torch.meshgrid: in an upcoming release, it will be required to pass the indexing argument. (Triggered internally at  /opt/conda/conda-bld/pytorch_1659484657607/work/aten/src/ATen/native/TensorShape.cpp:2895.)

  0%|          | 0/57 [00:00<?, ?it/s]Traceback (most recent call last):
  File "/disk1/lhl/env/airs/lib/python3.8/multiprocessing/resource_sharer.py", line 149, in _serve
    send(conn, destination_pid)
  File "/disk1/lhl/env/airs/lib/python3.8/multiprocessing/resource_sharer.py", line 50, in send
    reduction.send_handle(conn, new_fd, pid)
  File "/disk1/lhl/env/airs/lib/python3.8/multiprocessing/reduction.py", line 184, in send_handle
    sendfds(s, [handle])
  File "/disk1/lhl/env/airs/lib/python3.8/multiprocessing/reduction.py", line 149, in sendfds
    sock.sendmsg([msg], [(socket.SOL_SOCKET, socket.SCM_RIGHTS, fds)])
OSError: [Errno 9] Bad file descriptor

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/disk1/lhl/env/airs/lib/python3.8/multiprocessing/resource_sharer.py", line 151, in _serve
    close()
  File "/disk1/lhl/env/airs/lib/python3.8/multiprocessing/resource_sharer.py", line 52, in close
    os.close(new_fd)
OSError: [Errno 9] Bad file descriptor
Exception in thread Thread-2:
Traceback (most recent call last):
  File "/disk1/lhl/env/airs/lib/python3.8/threading.py", line 932, in _bootstrap_inner
    self.run()
  File "/disk1/lhl/env/airs/lib/python3.8/threading.py", line 870, in run
    self._target(*self._args, **self._kwargs)
  File "/disk1/lhl/env/airs/lib/python3.8/site-packages/torch/utils/data/_utils/pin_memory.py", line 28, in _pin_memory_loop
    r = in_queue.get(timeout=MP_STATUS_CHECK_INTERVAL)
  File "/disk1/lhl/env/airs/lib/python3.8/multiprocessing/queues.py", line 116, in get
    return _ForkingPickler.loads(res)
  File "/disk1/lhl/env/airs/lib/python3.8/site-packages/torch/multiprocessing/reductions.py", line 297, in rebuild_storage_fd
    fd = df.detach()
  File "/disk1/lhl/env/airs/lib/python3.8/multiprocessing/resource_sharer.py", line 58, in detach
    return reduction.recv_handle(conn)
  File "/disk1/lhl/env/airs/lib/python3.8/multiprocessing/reduction.py", line 189, in recv_handle
    return recvfds(s, 1)[0]
  File "/disk1/lhl/env/airs/lib/python3.8/multiprocessing/reduction.py", line 159, in recvfds
    raise EOFError
EOFError
  0%|          | 0/57 [00:06<?, ?it/s]
Traceback (most recent call last):
  File "./vaihingen_test.py", line 132, in <module>
    main()
  File "./vaihingen_test.py", line 102, in main
    for input in tqdm(test_loader):
  File "/disk1/lhl/env/airs/lib/python3.8/site-packages/tqdm/std.py", line 1195, in __iter__
    for obj in iterable:
  File "/disk1/lhl/env/airs/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 681, in __next__
    data = self._next_data()
  File "/disk1/lhl/env/airs/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 1359, in _next_data
    idx, data = self._get_data()
  File "/disk1/lhl/env/airs/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 1320, in _get_data
    raise RuntimeError('Pin memory thread exited unexpectedly')
RuntimeError: Pin memory thread exited unexpectedly
/disk1/lhl/env/airs/lib/python3.8/site-packages/torch/functional.py:478: UserWarning:

torch.meshgrid: in an upcoming release, it will be required to pass the indexing argument. (Triggered internally at  /opt/conda/conda-bld/pytorch_1659484657607/work/aten/src/ATen/native/TensorShape.cpp:2895.)

  0%|          | 0/252 [00:00<?, ?it/s]  0%|          | 1/252 [00:05<23:10,  5.54s/it]  1%|          | 2/252 [00:06<11:52,  2.85s/it]  1%|          | 3/252 [00:07<08:15,  1.99s/it]  2%|▏         | 4/252 [00:08<06:33,  1.59s/it]  2%|▏         | 5/252 [00:09<05:36,  1.36s/it]  2%|▏         | 6/252 [00:10<05:02,  1.23s/it]  3%|▎         | 7/252 [00:11<04:40,  1.15s/it]  3%|▎         | 8/252 [00:12<04:25,  1.09s/it]  4%|▎         | 9/252 [00:13<04:15,  1.05s/it]  4%|▍         | 10/252 [00:14<04:08,  1.03s/it]  4%|▍         | 11/252 [00:15<04:03,  1.01s/it]  5%|▍         | 12/252 [00:16<03:59,  1.00it/s]  5%|▌         | 13/252 [00:17<03:56,  1.01it/s]  6%|▌         | 14/252 [00:18<03:54,  1.02it/s]  6%|▌         | 15/252 [00:19<03:52,  1.02it/s]  6%|▋         | 16/252 [00:20<03:51,  1.02it/s]  7%|▋         | 17/252 [00:21<03:49,  1.02it/s]  7%|▋         | 18/252 [00:22<03:48,  1.02it/s]  8%|▊         | 19/252 [00:23<03:47,  1.02it/s]  8%|▊         | 20/252 [00:23<03:46,  1.02it/s]  8%|▊         | 21/252 [00:24<03:45,  1.02it/s]  9%|▊         | 22/252 [00:25<03:47,  1.01it/s]  9%|▉         | 23/252 [00:26<03:45,  1.01it/s] 10%|▉         | 24/252 [00:27<03:43,  1.02it/s] 10%|▉         | 25/252 [00:28<03:44,  1.01it/s] 10%|█         | 26/252 [00:29<03:43,  1.01it/s] 11%|█         | 27/252 [00:30<03:41,  1.02it/s] 11%|█         | 28/252 [00:31<03:42,  1.01it/s] 12%|█▏        | 29/252 [00:32<03:40,  1.01it/s] 12%|█▏        | 30/252 [00:33<03:40,  1.00it/s] 12%|█▏        | 31/252 [00:34<03:38,  1.01it/s] 13%|█▎        | 32/252 [00:35<03:37,  1.01it/s] 13%|█▎        | 33/252 [00:36<03:35,  1.02it/s] 13%|█▎        | 34/252 [00:37<03:35,  1.01it/s] 14%|█▍        | 35/252 [00:38<03:36,  1.00it/s] 14%|█▍        | 36/252 [00:39<03:33,  1.01it/s] 15%|█▍        | 37/252 [00:40<03:36,  1.01s/it] 15%|█▌        | 38/252 [00:41<03:34,  1.00s/it] 15%|█▌        | 39/252 [00:42<03:35,  1.01s/it] 16%|█▌        | 40/252 [00:43<03:32,  1.00s/it] 16%|█▋        | 41/252 [00:44<03:29,  1.01it/s] 17%|█▋        | 42/252 [00:45<03:28,  1.01it/s] 17%|█▋        | 43/252 [00:46<03:30,  1.01s/it] 17%|█▋        | 44/252 [00:47<03:29,  1.01s/it] 18%|█▊        | 45/252 [00:48<03:27,  1.00s/it] 18%|█▊        | 46/252 [00:49<03:27,  1.01s/it] 19%|█▊        | 47/252 [00:50<03:25,  1.00s/it] 19%|█▉        | 48/252 [00:51<03:25,  1.01s/it] 19%|█▉        | 49/252 [00:52<03:24,  1.01s/it] 20%|█▉        | 50/252 [00:53<03:22,  1.00s/it] 20%|██        | 51/252 [00:54<03:20,  1.00it/s] 21%|██        | 52/252 [00:55<03:18,  1.01it/s] 21%|██        | 53/252 [00:56<03:21,  1.01s/it] 21%|██▏       | 54/252 [00:57<03:22,  1.02s/it] 22%|██▏       | 55/252 [00:59<03:23,  1.03s/it] 22%|██▏       | 56/252 [01:00<03:19,  1.02s/it] 23%|██▎       | 57/252 [01:01<03:16,  1.01s/it] 23%|██▎       | 58/252 [01:02<03:16,  1.01s/it] 23%|██▎       | 59/252 [01:03<03:16,  1.02s/it] 24%|██▍       | 60/252 [01:04<03:14,  1.01s/it] 24%|██▍       | 61/252 [01:05<03:15,  1.03s/it] 25%|██▍       | 62/252 [01:06<03:12,  1.01s/it] 25%|██▌       | 63/252 [01:07<03:13,  1.02s/it] 25%|██▌       | 64/252 [01:08<03:10,  1.01s/it] 26%|██▌       | 65/252 [01:09<03:10,  1.02s/it] 26%|██▌       | 66/252 [01:10<03:10,  1.03s/it] 27%|██▋       | 67/252 [01:11<03:11,  1.03s/it] 27%|██▋       | 68/252 [01:12<03:08,  1.02s/it] 27%|██▋       | 69/252 [01:13<03:07,  1.03s/it] 28%|██▊       | 70/252 [01:14<03:04,  1.01s/it] 28%|██▊       | 71/252 [01:15<03:02,  1.01s/it] 29%|██▊       | 72/252 [01:16<03:00,  1.00s/it] 29%|██▉       | 73/252 [01:17<02:58,  1.00it/s] 29%|██▉       | 74/252 [01:18<02:56,  1.01it/s] 30%|██▉       | 75/252 [01:19<02:54,  1.01it/s] 30%|███       | 76/252 [01:20<02:56,  1.00s/it] 31%|███       | 77/252 [01:21<02:57,  1.01s/it] 31%|███       | 78/252 [01:22<02:58,  1.02s/it] 31%|███▏      | 79/252 [01:23<02:55,  1.02s/it] 32%|███▏      | 80/252 [01:24<02:53,  1.01s/it] 32%|███▏      | 81/252 [01:25<02:54,  1.02s/it] 33%|███▎      | 82/252 [01:26<02:52,  1.02s/it] 33%|███▎      | 83/252 [01:27<02:54,  1.03s/it] 33%|███▎      | 84/252 [01:28<02:53,  1.04s/it] 34%|███▎      | 85/252 [01:29<02:52,  1.03s/it] 34%|███▍      | 86/252 [01:30<02:48,  1.02s/it] 35%|███▍      | 87/252 [01:31<02:47,  1.02s/it] 35%|███▍      | 88/252 [01:32<02:45,  1.01s/it] 35%|███▌      | 89/252 [01:33<02:47,  1.03s/it] 36%|███▌      | 90/252 [01:34<02:44,  1.01s/it] 36%|███▌      | 91/252 [01:35<02:43,  1.02s/it] 37%|███▋      | 92/252 [01:39<04:40,  1.75s/it] 37%|███▋      | 93/252 [01:40<04:03,  1.53s/it] 37%|███▋      | 94/252 [01:41<03:37,  1.38s/it] 38%|███▊      | 95/252 [01:42<03:17,  1.26s/it] 38%|███▊      | 96/252 [01:43<03:03,  1.18s/it] 38%|███▊      | 97/252 [01:44<02:52,  1.11s/it] 39%|███▉      | 98/252 [01:45<02:47,  1.09s/it] 39%|███▉      | 99/252 [01:46<02:42,  1.06s/it] 40%|███▉      | 100/252 [01:47<02:53,  1.14s/it] 40%|████      | 101/252 [01:48<02:58,  1.18s/it] 40%|████      | 102/252 [01:49<02:51,  1.15s/it] 41%|████      | 103/252 [01:50<02:46,  1.12s/it] 41%|████▏     | 104/252 [01:51<02:41,  1.09s/it] 42%|████▏     | 105/252 [01:52<02:40,  1.09s/it] 42%|████▏     | 106/252 [01:57<05:25,  2.23s/it] 42%|████▏     | 107/252 [01:58<04:29,  1.86s/it] 43%|████▎     | 108/252 [01:59<03:50,  1.60s/it] 43%|████▎     | 109/252 [02:00<03:21,  1.41s/it] 44%|████▎     | 110/252 [02:01<03:03,  1.29s/it] 44%|████▍     | 111/252 [02:02<02:54,  1.24s/it] 44%|████▍     | 112/252 [02:03<02:42,  1.16s/it] 45%|████▍     | 113/252 [02:04<02:36,  1.13s/it] 45%|████▌     | 114/252 [02:05<02:32,  1.11s/it] 46%|████▌     | 115/252 [02:06<02:28,  1.08s/it] 46%|████▌     | 116/252 [02:07<02:23,  1.06s/it] 46%|████▋     | 117/252 [02:08<02:21,  1.05s/it] 47%|████▋     | 118/252 [02:10<02:22,  1.06s/it] 47%|████▋     | 119/252 [02:11<02:23,  1.08s/it] 48%|████▊     | 120/252 [02:15<04:20,  1.97s/it] 48%|████▊     | 121/252 [02:19<05:33,  2.55s/it] 48%|████▊     | 122/252 [02:22<06:16,  2.89s/it] 49%|████▉     | 123/252 [02:24<05:33,  2.59s/it] 49%|████▉     | 124/252 [02:25<04:29,  2.11s/it] 50%|████▉     | 125/252 [02:26<03:46,  1.78s/it] 50%|█████     | 126/252 [02:27<03:15,  1.55s/it] 50%|█████     | 127/252 [02:31<04:25,  2.12s/it] 51%|█████     | 128/252 [02:33<04:36,  2.23s/it] 51%|█████     | 129/252 [02:35<04:06,  2.01s/it] 52%|█████▏    | 130/252 [02:36<03:29,  1.72s/it] 52%|█████▏    | 131/252 [02:37<03:02,  1.51s/it] 52%|█████▏    | 132/252 [02:42<05:04,  2.53s/it] 53%|█████▎    | 133/252 [02:46<06:12,  3.13s/it] 53%|█████▎    | 134/252 [02:48<05:15,  2.67s/it] 54%|█████▎    | 135/252 [02:49<04:29,  2.30s/it] 54%|█████▍    | 136/252 [02:53<05:33,  2.87s/it] 54%|█████▍    | 137/252 [02:54<04:25,  2.31s/it] 55%|█████▍    | 138/252 [02:56<04:10,  2.20s/it] 55%|█████▌    | 139/252 [02:57<03:29,  1.85s/it] 56%|█████▌    | 140/252 [03:01<04:29,  2.40s/it] 56%|█████▌    | 141/252 [03:03<03:54,  2.11s/it] 56%|█████▋    | 142/252 [03:04<03:38,  1.99s/it] 57%|█████▋    | 143/252 [03:05<03:05,  1.71s/it] 57%|█████▋    | 144/252 [03:08<03:34,  1.99s/it] 58%|█████▊    | 145/252 [03:10<03:32,  1.98s/it] 58%|█████▊    | 146/252 [03:11<03:07,  1.77s/it] 58%|█████▊    | 147/252 [03:12<02:42,  1.55s/it] 59%|█████▊    | 148/252 [03:13<02:24,  1.39s/it] 59%|█████▉    | 149/252 [03:14<02:12,  1.28s/it] 60%|█████▉    | 150/252 [03:18<03:15,  1.91s/it] 60%|█████▉    | 151/252 [03:20<03:26,  2.05s/it] 60%|██████    | 152/252 [03:22<03:27,  2.07s/it] 61%|██████    | 153/252 [03:23<02:56,  1.78s/it] 61%|██████    | 154/252 [03:26<03:15,  2.00s/it] 62%|██████▏   | 155/252 [03:27<02:46,  1.72s/it] 62%|██████▏   | 156/252 [03:29<02:50,  1.78s/it] 62%|██████▏   | 157/252 [03:30<02:31,  1.59s/it] 63%|██████▎   | 158/252 [03:32<02:40,  1.71s/it] 63%|██████▎   | 159/252 [03:33<02:21,  1.53s/it] 63%|██████▎   | 160/252 [03:34<02:07,  1.39s/it] 64%|██████▍   | 161/252 [03:36<02:32,  1.67s/it] 64%|██████▍   | 162/252 [03:37<02:14,  1.50s/it] 65%|██████▍   | 163/252 [03:40<02:35,  1.75s/it] 65%|██████▌   | 164/252 [03:41<02:16,  1.55s/it] 65%|██████▌   | 165/252 [03:43<02:43,  1.88s/it] 66%|██████▌   | 166/252 [03:45<02:20,  1.63s/it] 66%|██████▋   | 167/252 [03:46<02:26,  1.73s/it] 67%|██████▋   | 168/252 [03:48<02:08,  1.53s/it] 67%|██████▋   | 169/252 [03:49<02:16,  1.64s/it] 67%|██████▋   | 170/252 [03:51<02:00,  1.47s/it] 68%|██████▊   | 171/252 [03:52<02:10,  1.61s/it] 68%|██████▊   | 172/252 [03:56<02:49,  2.12s/it] 69%|██████▊   | 173/252 [03:57<02:37,  1.99s/it] 69%|██████▉   | 174/252 [03:59<02:28,  1.90s/it] 69%|██████▉   | 175/252 [04:00<02:12,  1.72s/it] 70%|██████▉   | 176/252 [04:02<01:57,  1.55s/it] 70%|███████   | 177/252 [04:08<03:45,  3.01s/it] 71%|███████   | 178/252 [04:11<03:50,  3.12s/it] 71%|███████   | 179/252 [04:13<03:09,  2.60s/it] 71%|███████▏  | 180/252 [04:15<02:51,  2.38s/it] 72%|███████▏  | 181/252 [04:16<02:21,  1.99s/it] 72%|███████▏  | 182/252 [04:18<02:18,  1.98s/it] 73%|███████▎  | 183/252 [04:21<02:53,  2.52s/it] 73%|███████▎  | 184/252 [04:22<02:19,  2.05s/it] 73%|███████▎  | 185/252 [04:24<02:00,  1.79s/it] 74%|███████▍  | 186/252 [04:25<01:44,  1.58s/it] 74%|███████▍  | 187/252 [04:27<01:53,  1.74s/it] 75%|███████▍  | 188/252 [04:28<01:38,  1.55s/it] 75%|███████▌  | 189/252 [04:29<01:29,  1.43s/it] 75%|███████▌  | 190/252 [04:31<01:29,  1.44s/it] 76%|███████▌  | 191/252 [04:32<01:20,  1.32s/it] 76%|███████▌  | 192/252 [04:33<01:15,  1.25s/it] 77%|███████▋  | 193/252 [04:34<01:11,  1.21s/it] 77%|███████▋  | 194/252 [04:35<01:10,  1.22s/it] 77%|███████▋  | 195/252 [04:36<01:12,  1.28s/it] 78%|███████▊  | 196/252 [04:38<01:08,  1.22s/it] 78%|███████▊  | 197/252 [04:39<01:05,  1.18s/it] 79%|███████▊  | 198/252 [04:41<01:23,  1.54s/it] 79%|███████▉  | 199/252 [04:42<01:16,  1.44s/it] 79%|███████▉  | 200/252 [04:44<01:24,  1.62s/it] 80%|███████▉  | 201/252 [04:45<01:15,  1.48s/it] 80%|████████  | 202/252 [04:47<01:22,  1.65s/it] 81%|████████  | 203/252 [04:48<01:12,  1.48s/it] 81%|████████  | 204/252 [04:51<01:18,  1.64s/it] 81%|████████▏ | 205/252 [04:52<01:10,  1.49s/it] 82%|████████▏ | 206/252 [04:53<01:04,  1.39s/it] 82%|████████▏ | 207/252 [04:55<01:18,  1.74s/it] 83%|████████▎ | 208/252 [04:56<01:08,  1.56s/it] 83%|████████▎ | 209/252 [04:58<01:04,  1.51s/it] 83%|████████▎ | 210/252 [04:59<01:04,  1.53s/it] 84%|████████▎ | 211/252 [05:01<01:01,  1.50s/it] 84%|████████▍ | 212/252 [05:02<00:56,  1.41s/it] 85%|████████▍ | 213/252 [05:03<00:53,  1.36s/it] 85%|████████▍ | 214/252 [05:04<00:47,  1.24s/it] 85%|████████▌ | 215/252 [05:06<00:46,  1.26s/it] 86%|████████▌ | 216/252 [05:07<00:46,  1.30s/it] 86%|████████▌ | 217/252 [05:08<00:47,  1.35s/it] 87%|████████▋ | 218/252 [05:09<00:42,  1.24s/it] 87%|████████▋ | 219/252 [05:11<00:40,  1.22s/it] 87%|████████▋ | 220/252 [05:12<00:40,  1.28s/it] 88%|████████▊ | 221/252 [05:13<00:37,  1.20s/it] 88%|████████▊ | 222/252 [05:16<00:49,  1.66s/it] 88%|████████▊ | 223/252 [05:18<00:52,  1.83s/it] 89%|████████▉ | 224/252 [05:19<00:45,  1.61s/it] 89%|████████▉ | 225/252 [05:21<00:44,  1.65s/it] 90%|████████▉ | 226/252 [05:22<00:39,  1.52s/it] 90%|█████████ | 227/252 [05:24<00:41,  1.67s/it] 90%|█████████ | 228/252 [05:25<00:38,  1.58s/it] 91%|█████████ | 229/252 [05:26<00:32,  1.42s/it] 91%|█████████▏| 230/252 [05:27<00:28,  1.28s/it] 92%|█████████▏| 231/252 [05:30<00:35,  1.67s/it] 92%|█████████▏| 232/252 [05:31<00:29,  1.49s/it] 92%|█████████▏| 233/252 [05:32<00:26,  1.37s/it] 93%|█████████▎| 234/252 [05:33<00:23,  1.29s/it] 93%|█████████▎| 235/252 [05:36<00:29,  1.72s/it] 94%|█████████▎| 236/252 [05:37<00:25,  1.57s/it] 94%|█████████▍| 237/252 [05:38<00:21,  1.40s/it] 94%|█████████▍| 238/252 [05:41<00:25,  1.83s/it] 95%|█████████▍| 239/252 [05:42<00:20,  1.59s/it] 95%|█████████▌| 240/252 [05:45<00:22,  1.92s/it] 96%|█████████▌| 241/252 [05:46<00:18,  1.65s/it] 96%|█████████▌| 242/252 [05:48<00:16,  1.69s/it] 96%|█████████▋| 243/252 [05:49<00:13,  1.48s/it] 97%|█████████▋| 244/252 [05:50<00:11,  1.44s/it] 97%|█████████▋| 245/252 [05:51<00:09,  1.36s/it] 98%|█████████▊| 246/252 [05:52<00:07,  1.27s/it] 98%|█████████▊| 247/252 [05:53<00:06,  1.24s/it] 98%|█████████▊| 248/252 [05:54<00:04,  1.17s/it] 99%|█████████▉| 249/252 [05:55<00:03,  1.13s/it] 99%|█████████▉| 250/252 [05:57<00:02,  1.13s/it]100%|█████████▉| 251/252 [05:58<00:01,  1.22s/it]100%|██████████| 252/252 [05:59<00:00,  1.20s/it]100%|██████████| 252/252 [06:00<00:00,  1.43s/it]
/disk1/lhl/env/airs/lib/python3.8/site-packages/torch/functional.py:478: UserWarning:

torch.meshgrid: in an upcoming release, it will be required to pass the indexing argument. (Triggered internally at  /opt/conda/conda-bld/pytorch_1659484657607/work/aten/src/ATen/native/TensorShape.cpp:2895.)

GPU available: True, used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0,1,2]

  | Name | Type           | Params
----------------------------------------
0 | net  | UNetFormer     | 11.7 M
1 | loss | UnetFormerLoss | 0     
----------------------------------------
11.7 M    Trainable params
0         Non-trainable params
11.7 M    Total params
46.900    Total estimated model params size (MB)
/disk1/lhl/env/airs/lib/python3.8/site-packages/torch/functional.py:478: UserWarning:

torch.meshgrid: in an upcoming release, it will be required to pass the indexing argument. (Triggered internally at  /opt/conda/conda-bld/pytorch_1659484657607/work/aten/src/ATen/native/TensorShape.cpp:2895.)

GPU available: True, used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0,1,2]

  | Name | Type           | Params
----------------------------------------
0 | net  | UNetFormer     | 11.7 M
1 | loss | UnetFormerLoss | 0     
----------------------------------------
11.7 M    Trainable params
0         Non-trainable params
11.7 M    Total params
46.900    Total estimated model params size (MB)
/disk1/lhl/env/airs/lib/python3.8/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:631: UserWarning:

Checkpoint directory /disk1/lhl/workspace/unetformer/GeoSeg/model_weights/potsdam/unetformer-r18-768crop-ms-e45 exists and is not empty.

/disk1/lhl/env/airs/lib/python3.8/site-packages/pytorch_lightning/trainer/data_loading.py:132: UserWarning:

The dataloader, val_dataloader 0, does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` (try 16 which is the number of cpus on this machine) in the `DataLoader` init to improve performance.

/disk1/lhl/workspace/unetformer/GeoSeg/tools/metric.py:31: RuntimeWarning:

invalid value encountered in divide

/disk1/lhl/env/airs/lib/python3.8/site-packages/pytorch_lightning/trainer/data_loading.py:132: UserWarning:

The dataloader, train_dataloader, does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` (try 16 which is the number of cpus on this machine) in the `DataLoader` init to improve performance.

/disk1/lhl/env/airs/lib/python3.8/site-packages/pytorch_lightning/trainer/data_loading.py:432: UserWarning:

The number of training samples (45) is smaller than the logging interval Trainer(log_every_n_steps=50). Set a lower value for log_every_n_steps if you want to see logs for the training epoch.

/disk1/lhl/env/airs/lib/python3.8/site-packages/pytorch_lightning/trainer/data_loading.py:132: UserWarning:

The dataloader, val_dataloader 0, does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` (try 16 which is the number of cpus on this machine) in the `DataLoader` init to improve performance.

/disk1/lhl/workspace/unetformer/GeoSeg/tools/metric.py:31: RuntimeWarning:

invalid value encountered in divide

/disk1/lhl/env/airs/lib/python3.8/site-packages/pytorch_lightning/trainer/data_loading.py:132: UserWarning:

The dataloader, train_dataloader, does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` (try 16 which is the number of cpus on this machine) in the `DataLoader` init to improve performance.

Killed
/disk1/lhl/env/airs/lib/python3.8/site-packages/torch/functional.py:478: UserWarning:

torch.meshgrid: in an upcoming release, it will be required to pass the indexing argument. (Triggered internally at  /opt/conda/conda-bld/pytorch_1659484657607/work/aten/src/ATen/native/TensorShape.cpp:2895.)

GPU available: True, used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0,1,2]
/disk1/lhl/env/airs/lib/python3.8/site-packages/torch/functional.py:478: UserWarning:

torch.meshgrid: in an upcoming release, it will be required to pass the indexing argument. (Triggered internally at  /opt/conda/conda-bld/pytorch_1659484657607/work/aten/src/ATen/native/TensorShape.cpp:2895.)

  0%|          | 0/252 [00:00<?, ?it/s]
  | Name | Type           | Params
----------------------------------------
0 | net  | UNetFormer     | 11.7 M
1 | loss | UnetFormerLoss | 0     
----------------------------------------
11.7 M    Trainable params
0         Non-trainable params
11.7 M    Total params
46.900    Total estimated model params size (MB)
/disk1/lhl/env/airs/lib/python3.8/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:631: UserWarning:

Checkpoint directory /disk1/lhl/workspace/unetformer/GeoSeg/model_weights/potsdam/unetformer-r18-768crop-ms-e45 exists and is not empty.

  0%|          | 1/252 [00:06<26:37,  6.37s/it]  1%|          | 2/252 [00:07<13:25,  3.22s/it]  1%|          | 3/252 [00:08<09:10,  2.21s/it]  2%|▏         | 4/252 [00:09<07:13,  1.75s/it]  2%|▏         | 5/252 [00:10<06:45,  1.64s/it]/disk1/lhl/env/airs/lib/python3.8/site-packages/pytorch_lightning/trainer/data_loading.py:132: UserWarning:

The dataloader, val_dataloader 0, does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` (try 16 which is the number of cpus on this machine) in the `DataLoader` init to improve performance.

/disk1/lhl/workspace/unetformer/GeoSeg/tools/metric.py:31: RuntimeWarning:

invalid value encountered in divide

/disk1/lhl/env/airs/lib/python3.8/site-packages/pytorch_lightning/trainer/data_loading.py:132: UserWarning:

The dataloader, train_dataloader, does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` (try 16 which is the number of cpus on this machine) in the `DataLoader` init to improve performance.

  2%|▏         | 6/252 [00:11<05:58,  1.46s/it]  3%|▎         | 7/252 [00:12<05:21,  1.31s/it]  3%|▎         | 8/252 [00:14<04:56,  1.21s/it]  4%|▎         | 9/252 [00:15<04:39,  1.15s/it]  4%|▍         | 10/252 [00:16<04:58,  1.23s/it]  4%|▍         | 11/252 [00:17<04:39,  1.16s/it]  5%|▍         | 12/252 [00:18<04:26,  1.11s/it]  5%|▌         | 13/252 [00:19<04:18,  1.08s/it]  6%|▌         | 14/252 [00:20<04:14,  1.07s/it]  6%|▌         | 15/252 [00:21<04:29,  1.14s/it]  6%|▋         | 16/252 [00:22<04:20,  1.10s/it]  7%|▋         | 17/252 [00:23<04:12,  1.08s/it]  7%|▋         | 18/252 [00:25<04:26,  1.14s/it]  8%|▊         | 19/252 [00:26<04:16,  1.10s/it]  8%|▊         | 20/252 [00:27<04:08,  1.07s/it]  8%|▊         | 21/252 [00:28<04:12,  1.09s/it]  9%|▊         | 22/252 [00:29<04:24,  1.15s/it]  9%|▉         | 23/252 [00:30<04:13,  1.11s/it] 10%|▉         | 24/252 [00:31<04:05,  1.07s/it] 10%|▉         | 25/252 [00:32<03:59,  1.06s/it] 10%|█         | 26/252 [00:33<03:57,  1.05s/it] 11%|█         | 27/252 [00:35<04:20,  1.16s/it] 11%|█         | 28/252 [00:36<04:10,  1.12s/it] 12%|█▏        | 29/252 [00:37<04:02,  1.09s/it] 12%|█▏        | 30/252 [00:38<03:55,  1.06s/it] 12%|█▏        | 31/252 [00:39<03:52,  1.05s/it] 13%|█▎        | 32/252 [00:40<04:15,  1.16s/it] 13%|█▎        | 33/252 [00:41<04:04,  1.12s/it] 13%|█▎        | 34/252 [00:42<03:56,  1.08s/it] 14%|█▍        | 35/252 [00:43<03:49,  1.06s/it] 14%|█▍        | 36/252 [00:44<03:47,  1.05s/it] 15%|█▍        | 37/252 [00:45<04:08,  1.16s/it] 15%|█▌        | 38/252 [00:46<03:58,  1.11s/it] 15%|█▌        | 39/252 [00:47<03:50,  1.08s/it] 16%|█▌        | 40/252 [00:49<03:49,  1.08s/it] 16%|█▋        | 41/252 [00:50<04:04,  1.16s/it] 17%|█▋        | 42/252 [00:51<04:00,  1.14s/it] 17%|█▋        | 43/252 [00:52<03:55,  1.13s/it] 17%|█▋        | 44/252 [00:53<03:47,  1.10s/it] 18%|█▊        | 45/252 [00:54<03:40,  1.07s/it] 18%|█▊        | 46/252 [00:55<03:47,  1.11s/it] 19%|█▊        | 47/252 [00:56<03:46,  1.10s/it] 19%|█▉        | 48/252 [00:57<03:43,  1.10s/it] 19%|█▉        | 49/252 [00:59<03:40,  1.09s/it] 20%|█▉        | 50/252 [01:00<03:54,  1.16s/it] 20%|██        | 51/252 [01:01<03:48,  1.14s/it] 21%|██        | 52/252 [01:02<03:45,  1.13s/it] 21%|██        | 53/252 [01:03<03:39,  1.10s/it] 21%|██▏       | 54/252 [01:04<03:41,  1.12s/it] 22%|██▏       | 55/252 [01:06<03:51,  1.18s/it] 22%|██▏       | 56/252 [01:07<03:42,  1.13s/it] 23%|██▎       | 57/252 [01:08<03:33,  1.10s/it] 23%|██▎       | 58/252 [01:09<03:56,  1.22s/it] 23%|██▎       | 59/252 [01:10<03:48,  1.18s/it] 24%|██▍       | 60/252 [01:11<03:40,  1.15s/it] 24%|██▍       | 61/252 [01:12<03:32,  1.11s/it] 25%|██▍       | 62/252 [01:14<03:37,  1.14s/it] 25%|██▌       | 63/252 [01:15<03:32,  1.12s/it] 25%|██▌       | 64/252 [01:16<03:30,  1.12s/it] 26%|██▌       | 65/252 [01:17<03:28,  1.11s/it] 26%|██▌       | 66/252 [01:18<03:47,  1.22s/it] 27%|██▋       | 67/252 [01:19<03:34,  1.16s/it] 27%|██▋       | 68/252 [01:20<03:25,  1.12s/it] 27%|██▋       | 69/252 [01:21<03:24,  1.12s/it] 28%|██▊       | 70/252 [01:23<03:39,  1.21s/it] 28%|██▊       | 71/252 [01:24<03:29,  1.16s/it] 29%|██▊       | 72/252 [01:25<03:20,  1.12s/it] 29%|██▉       | 73/252 [01:26<03:17,  1.11s/it] 29%|██▉       | 74/252 [01:27<03:27,  1.16s/it] 30%|██▉       | 75/252 [01:28<03:22,  1.14s/it] 30%|███       | 76/252 [01:29<03:18,  1.13s/it] 31%|███       | 77/252 [01:31<03:13,  1.11s/it] 31%|███       | 78/252 [01:32<03:16,  1.13s/it] 31%|███▏      | 79/252 [01:33<03:23,  1.18s/it] 32%|███▏      | 80/252 [01:34<03:18,  1.15s/it] 32%|███▏      | 81/252 [01:35<03:14,  1.14s/it] 33%|███▎      | 82/252 [01:36<03:09,  1.12s/it] 33%|███▎      | 83/252 [01:38<03:23,  1.20s/it] 33%|███▎      | 84/252 [01:39<03:12,  1.14s/it] 34%|███▎      | 85/252 [01:40<03:05,  1.11s/it] 34%|███▍      | 86/252 [01:41<03:21,  1.21s/it] 35%|███▍      | 87/252 [01:42<03:15,  1.19s/it] 35%|███▍      | 88/252 [01:43<03:09,  1.16s/it] 35%|███▌      | 89/252 [01:45<03:19,  1.23s/it] 36%|███▌      | 90/252 [01:46<03:08,  1.16s/it] 36%|███▌      | 91/252 [01:47<03:00,  1.12s/it] 37%|███▋      | 92/252 [01:48<03:05,  1.16s/it] 37%|███▋      | 93/252 [01:49<03:11,  1.20s/it] 37%|███▋      | 94/252 [01:50<03:03,  1.16s/it] 38%|███▊      | 95/252 [01:51<02:57,  1.13s/it] 38%|███▊      | 96/252 [01:53<03:13,  1.24s/it] 38%|███▊      | 97/252 [01:54<03:06,  1.20s/it] 39%|███▉      | 98/252 [01:55<02:57,  1.15s/it] 39%|███▉      | 99/252 [01:56<02:52,  1.12s/it] 40%|███▉      | 100/252 [01:58<03:04,  1.22s/it] 40%|████      | 101/252 [01:59<02:55,  1.16s/it] 40%|████      | 102/252 [02:00<02:49,  1.13s/it] 41%|████      | 103/252 [02:01<02:56,  1.19s/it] 41%|████▏     | 104/252 [02:02<02:53,  1.18s/it] 42%|████▏     | 105/252 [02:03<02:47,  1.14s/it] 42%|████▏     | 106/252 [02:04<02:41,  1.10s/it] 42%|████▏     | 107/252 [02:06<02:55,  1.21s/it] 43%|████▎     | 108/252 [02:07<02:49,  1.18s/it] 43%|████▎     | 109/252 [02:08<02:43,  1.14s/it] 44%|████▎     | 110/252 [02:09<02:41,  1.14s/it] 44%|████▍     | 111/252 [02:10<02:50,  1.21s/it] 44%|████▍     | 112/252 [02:11<02:41,  1.16s/it] 45%|████▍     | 113/252 [02:12<02:35,  1.12s/it] 45%|████▌     | 114/252 [02:14<02:39,  1.16s/it] 46%|████▌     | 115/252 [02:15<02:35,  1.14s/it] 46%|████▌     | 116/252 [02:16<02:32,  1.12s/it] 46%|████▋     | 117/252 [02:17<02:30,  1.11s/it] 47%|████▋     | 118/252 [02:18<02:43,  1.22s/it] 47%|████▋     | 119/252 [02:20<02:36,  1.18s/it] 48%|████▊     | 120/252 [02:21<02:29,  1.13s/it] 48%|████▊     | 121/252 [02:22<02:41,  1.23s/it] 48%|████▊     | 122/252 [02:23<02:32,  1.17s/it] 49%|████▉     | 123/252 [02:24<02:26,  1.14s/it] 49%|████▉     | 124/252 [02:25<02:29,  1.16s/it] 50%|████▉     | 125/252 [02:26<02:28,  1.17s/it] 50%|█████     | 126/252 [02:28<02:21,  1.12s/it] 50%|█████     | 127/252 [02:29<02:22,  1.14s/it] 51%|█████     | 128/252 [02:30<02:31,  1.22s/it] 51%|█████     | 129/252 [02:31<02:24,  1.17s/it] 52%|█████▏    | 130/252 [02:32<02:18,  1.14s/it] 52%|█████▏    | 131/252 [02:33<02:18,  1.15s/it] 52%|█████▏    | 132/252 [02:35<02:19,  1.16s/it] 53%|█████▎    | 133/252 [02:36<02:13,  1.12s/it] 53%|█████▎    | 134/252 [02:37<02:11,  1.11s/it] 54%|█████▎    | 135/252 [02:38<02:21,  1.21s/it] 54%|█████▍    | 136/252 [02:39<02:17,  1.19s/it] 54%|█████▍    | 137/252 [02:40<02:12,  1.15s/it] 55%|█████▍    | 138/252 [02:41<02:06,  1.11s/it] 55%|█████▌    | 139/252 [02:42<02:05,  1.11s/it] 56%|█████▌    | 140/252 [02:44<02:02,  1.09s/it] 56%|█████▌    | 141/252 [02:45<02:00,  1.09s/it] 56%|█████▋    | 142/252 [02:46<02:09,  1.18s/it] 57%|█████▋    | 143/252 [02:47<02:03,  1.14s/it] 57%|█████▋    | 144/252 [02:48<01:59,  1.10s/it] 58%|█████▊    | 145/252 [02:49<02:07,  1.19s/it] 58%|█████▊    | 146/252 [02:50<02:00,  1.14s/it] 58%|█████▊    | 147/252 [02:52<01:57,  1.11s/it] 59%|█████▊    | 148/252 [02:53<01:52,  1.09s/it] 59%|█████▉    | 149/252 [02:54<02:02,  1.19s/it] 60%|█████▉    | 150/252 [02:55<01:56,  1.14s/it] 60%|█████▉    | 151/252 [02:56<01:51,  1.11s/it] 60%|██████    | 152/252 [02:57<01:50,  1.10s/it] 61%|██████    | 153/252 [02:58<01:57,  1.18s/it] 61%|██████    | 154/252 [03:00<01:50,  1.13s/it] 62%|██████▏   | 155/252 [03:01<01:47,  1.11s/it] 62%|██████▏   | 156/252 [03:02<01:43,  1.08s/it] 62%|██████▏   | 157/252 [03:03<01:51,  1.17s/it] 63%|██████▎   | 158/252 [03:04<01:46,  1.14s/it] 63%|██████▎   | 159/252 [03:05<01:43,  1.11s/it] 63%|██████▎   | 160/252 [03:06<01:43,  1.13s/it] 64%|██████▍   | 161/252 [03:08<01:48,  1.19s/it] 64%|██████▍   | 162/252 [03:09<01:44,  1.17s/it] 65%|██████▍   | 163/252 [03:10<01:40,  1.13s/it] 65%|██████▌   | 164/252 [03:11<01:49,  1.25s/it] 65%|██████▌   | 165/252 [03:12<01:44,  1.20s/it] 66%|██████▌   | 166/252 [03:13<01:38,  1.15s/it] 66%|██████▋   | 167/252 [03:14<01:37,  1.14s/it] 67%|██████▋   | 168/252 [03:16<01:42,  1.22s/it] 67%|██████▋   | 169/252 [03:17<01:36,  1.16s/it] 67%|██████▋   | 170/252 [03:18<01:32,  1.12s/it] 68%|██████▊   | 171/252 [03:19<01:31,  1.13s/it] 68%|██████▊   | 172/252 [03:20<01:36,  1.21s/it] 69%|██████▊   | 173/252 [03:21<01:31,  1.15s/it] 69%|██████▉   | 174/252 [03:23<01:29,  1.15s/it] 69%|██████▉   | 175/252 [03:24<01:31,  1.19s/it] 70%|██████▉   | 176/252 [03:27<02:14,  1.77s/it] 70%|███████   | 177/252 [03:29<02:05,  1.68s/it] 71%|███████   | 178/252 [03:30<01:56,  1.58s/it] 71%|███████   | 179/252 [03:31<01:42,  1.41s/it] 71%|███████▏  | 180/252 [03:32<01:34,  1.31s/it] 72%|███████▏  | 181/252 [03:33<01:34,  1.34s/it] 72%|███████▏  | 182/252 [03:34<01:26,  1.24s/it] 73%|███████▎  | 183/252 [03:36<01:33,  1.36s/it] 73%|███████▎  | 184/252 [03:37<01:30,  1.33s/it] 73%|███████▎  | 185/252 [03:38<01:25,  1.28s/it] 74%|███████▍  | 186/252 [03:39<01:19,  1.20s/it] 74%|███████▍  | 187/252 [03:41<01:16,  1.17s/it] 75%|███████▍  | 188/252 [03:42<01:12,  1.13s/it] 75%|███████▌  | 189/252 [03:43<01:09,  1.11s/it] 75%|███████▌  | 190/252 [03:44<01:12,  1.17s/it] 76%|███████▌  | 191/252 [03:45<01:09,  1.13s/it] 76%|███████▌  | 192/252 [03:46<01:06,  1.11s/it] 77%|███████▋  | 193/252 [03:48<01:18,  1.34s/it] 77%|███████▋  | 194/252 [03:49<01:18,  1.35s/it] 77%|███████▋  | 195/252 [03:50<01:13,  1.29s/it] 78%|███████▊  | 196/252 [03:51<01:07,  1.20s/it] 78%|███████▊  | 197/252 [03:53<01:19,  1.45s/it] 79%|███████▊  | 198/252 [03:55<01:19,  1.47s/it] 79%|███████▉  | 199/252 [03:56<01:13,  1.38s/it] 79%|███████▉  | 200/252 [03:58<01:17,  1.50s/it] 80%|███████▉  | 201/252 [03:59<01:09,  1.36s/it] 80%|████████  | 202/252 [04:01<01:10,  1.42s/it] 81%|████████  | 203/252 [04:02<01:05,  1.34s/it] 81%|████████  | 204/252 [04:03<01:10,  1.48s/it] 81%|████████▏ | 205/252 [04:05<01:11,  1.52s/it] 82%|████████▏ | 206/252 [04:07<01:14,  1.62s/it] 82%|████████▏ | 207/252 [04:09<01:14,  1.65s/it] 83%|████████▎ | 208/252 [04:10<01:06,  1.50s/it] 83%|████████▎ | 209/252 [04:11<01:02,  1.46s/it] 83%|████████▎ | 210/252 [04:12<00:57,  1.38s/it] 84%|████████▎ | 211/252 [04:21<02:26,  3.57s/it] 84%|████████▍ | 212/252 [04:28<03:05,  4.65s/it] 85%|████████▍ | 213/252 [04:36<03:42,  5.70s/it] 85%|████████▍ | 214/252 [04:43<03:43,  5.89s/it] 85%|████████▌ | 215/252 [04:48<03:31,  5.72s/it] 86%|████████▌ | 216/252 [04:53<03:20,  5.56s/it] 86%|████████▌ | 217/252 [04:54<02:28,  4.23s/it] 87%|████████▋ | 218/252 [05:01<02:44,  4.85s/it] 87%|████████▋ | 219/252 [05:07<02:52,  5.23s/it] 87%|████████▋ | 220/252 [05:13<02:56,  5.50s/it] 88%|████████▊ | 221/252 [05:14<02:09,  4.18s/it] 88%|████████▊ | 222/252 [05:21<02:30,  5.01s/it] 88%|████████▊ | 223/252 [05:26<02:24,  5.00s/it] 89%|████████▉ | 224/252 [05:34<02:44,  5.89s/it] 89%|████████▉ | 225/252 [05:36<02:08,  4.75s/it] 90%|████████▉ | 226/252 [05:37<01:34,  3.65s/it] 90%|█████████ | 227/252 [05:47<02:19,  5.58s/it] 90%|█████████ | 228/252 [05:48<01:42,  4.27s/it] 91%|█████████ | 229/252 [05:56<02:03,  5.38s/it] 91%|█████████▏| 230/252 [05:59<01:39,  4.53s/it] 92%|█████████▏| 231/252 [06:00<01:12,  3.48s/it] 92%|█████████▏| 232/252 [06:02<00:58,  2.92s/it] 92%|█████████▏| 233/252 [06:03<00:49,  2.60s/it] 93%|█████████▎| 234/252 [06:04<00:38,  2.13s/it] 93%|█████████▎| 235/252 [06:05<00:30,  1.79s/it] 94%|█████████▎| 236/252 [06:07<00:26,  1.67s/it] 94%|█████████▍| 237/252 [06:13<00:43,  2.93s/it] 94%|█████████▍| 238/252 [06:21<01:03,  4.52s/it] 95%|█████████▍| 239/252 [06:23<00:48,  3.71s/it] 95%|█████████▌| 240/252 [06:24<00:34,  2.90s/it] 96%|█████████▌| 241/252 [06:25<00:26,  2.39s/it] 96%|█████████▌| 242/252 [06:26<00:20,  2.00s/it] 96%|█████████▋| 243/252 [06:27<00:15,  1.72s/it] 97%|█████████▋| 244/252 [06:33<00:24,  3.04s/it] 97%|█████████▋| 245/252 [06:35<00:19,  2.77s/it] 98%|█████████▊| 246/252 [06:38<00:16,  2.70s/it] 98%|█████████▊| 247/252 [06:41<00:13,  2.75s/it] 98%|█████████▊| 248/252 [06:42<00:08,  2.24s/it] 99%|█████████▉| 249/252 [06:44<00:06,  2.22s/it] 99%|█████████▉| 250/252 [06:45<00:03,  1.94s/it]100%|█████████▉| 251/252 [06:47<00:01,  1.79s/it]100%|██████████| 252/252 [06:48<00:00,  1.79s/it]100%|██████████| 252/252 [06:49<00:00,  1.62s/it]
/disk1/lhl/env/airs/lib/python3.8/site-packages/torch/functional.py:478: UserWarning:

torch.meshgrid: in an upcoming release, it will be required to pass the indexing argument. (Triggered internally at  /opt/conda/conda-bld/pytorch_1659484657607/work/aten/src/ATen/native/TensorShape.cpp:2895.)

  0%|          | 0/57 [00:00<?, ?it/s]  2%|▏         | 1/57 [00:07<06:41,  7.16s/it]  4%|▎         | 2/57 [00:09<03:46,  4.12s/it]  5%|▌         | 3/57 [00:11<02:50,  3.17s/it]  7%|▋         | 4/57 [00:13<02:23,  2.71s/it]  9%|▉         | 5/57 [00:15<02:07,  2.45s/it] 11%|█         | 6/57 [00:17<01:57,  2.31s/it] 12%|█▏        | 7/57 [00:19<01:50,  2.22s/it] 14%|█▍        | 8/57 [00:21<01:45,  2.15s/it] 16%|█▌        | 9/57 [00:23<01:41,  2.12s/it] 18%|█▊        | 10/57 [00:25<01:38,  2.09s/it] 19%|█▉        | 11/57 [00:27<01:36,  2.09s/it] 21%|██        | 12/57 [00:29<01:33,  2.08s/it] 23%|██▎       | 13/57 [00:31<01:30,  2.05s/it] 25%|██▍       | 14/57 [00:33<01:28,  2.05s/it] 26%|██▋       | 15/57 [00:35<01:25,  2.04s/it] 28%|██▊       | 16/57 [00:37<01:23,  2.03s/it] 30%|██▉       | 17/57 [00:39<01:21,  2.05s/it] 32%|███▏      | 18/57 [00:41<01:21,  2.09s/it] 33%|███▎      | 19/57 [00:44<01:20,  2.12s/it] 35%|███▌      | 20/57 [00:46<01:19,  2.14s/it] 37%|███▋      | 21/57 [00:48<01:16,  2.12s/it] 39%|███▊      | 22/57 [00:50<01:13,  2.09s/it] 40%|████      | 23/57 [00:52<01:11,  2.09s/it] 42%|████▏     | 24/57 [00:54<01:08,  2.08s/it] 44%|████▍     | 25/57 [00:56<01:06,  2.08s/it] 46%|████▌     | 26/57 [00:58<01:04,  2.07s/it] 47%|████▋     | 27/57 [01:00<01:03,  2.10s/it] 49%|████▉     | 28/57 [01:02<01:00,  2.09s/it] 51%|█████     | 29/57 [01:04<00:57,  2.07s/it] 53%|█████▎    | 30/57 [01:06<00:55,  2.07s/it] 54%|█████▍    | 31/57 [01:08<00:53,  2.08s/it] 56%|█████▌    | 32/57 [01:11<00:51,  2.07s/it] 58%|█████▊    | 33/57 [01:13<00:49,  2.06s/it] 60%|█████▉    | 34/57 [01:15<00:47,  2.06s/it] 61%|██████▏   | 35/57 [01:17<00:45,  2.05s/it] 63%|██████▎   | 36/57 [01:19<00:43,  2.06s/it] 65%|██████▍   | 37/57 [01:21<00:41,  2.05s/it] 67%|██████▋   | 38/57 [01:23<00:38,  2.05s/it] 68%|██████▊   | 39/57 [01:25<00:37,  2.06s/it] 70%|███████   | 40/57 [01:27<00:35,  2.09s/it] 72%|███████▏  | 41/57 [01:29<00:33,  2.09s/it] 74%|███████▎  | 42/57 [01:31<00:31,  2.09s/it] 75%|███████▌  | 43/57 [01:33<00:29,  2.09s/it] 77%|███████▋  | 44/57 [01:35<00:27,  2.11s/it] 79%|███████▉  | 45/57 [01:38<00:25,  2.09s/it] 81%|████████  | 46/57 [01:40<00:22,  2.08s/it] 82%|████████▏ | 47/57 [01:42<00:20,  2.08s/it] 84%|████████▍ | 48/57 [01:44<00:18,  2.06s/it] 86%|████████▌ | 49/57 [01:46<00:16,  2.05s/it] 88%|████████▊ | 50/57 [01:48<00:14,  2.05s/it] 89%|████████▉ | 51/57 [01:50<00:12,  2.06s/it] 91%|█████████ | 52/57 [01:52<00:10,  2.05s/it] 93%|█████████▎| 53/57 [01:54<00:08,  2.05s/it] 95%|█████████▍| 54/57 [01:56<00:06,  2.05s/it] 96%|█████████▋| 55/57 [01:58<00:04,  2.04s/it] 98%|█████████▊| 56/57 [02:00<00:02,  2.04s/it]100%|██████████| 57/57 [02:04<00:00,  2.54s/it]100%|██████████| 57/57 [02:04<00:00,  2.18s/it]
/disk1/lhl/env/airs/lib/python3.8/site-packages/torch/functional.py:478: UserWarning:

torch.meshgrid: in an upcoming release, it will be required to pass the indexing argument. (Triggered internally at  /opt/conda/conda-bld/pytorch_1659484657607/work/aten/src/ATen/native/TensorShape.cpp:2895.)

  0%|          | 0/252 [00:00<?, ?it/s]  0%|          | 1/252 [00:05<22:58,  5.49s/it]  1%|          | 2/252 [00:06<11:46,  2.83s/it]  1%|          | 3/252 [00:07<08:11,  1.97s/it]  2%|▏         | 4/252 [00:08<06:31,  1.58s/it]  2%|▏         | 5/252 [00:09<05:34,  1.36s/it]  2%|▏         | 6/252 [00:10<05:00,  1.22s/it]  3%|▎         | 7/252 [00:11<04:39,  1.14s/it]  3%|▎         | 8/252 [00:12<04:24,  1.08s/it]  4%|▎         | 9/252 [00:13<04:14,  1.05s/it]  4%|▍         | 10/252 [00:14<04:08,  1.02s/it]  4%|▍         | 11/252 [00:15<04:02,  1.01s/it]  5%|▍         | 12/252 [00:16<03:58,  1.01it/s]  5%|▌         | 13/252 [00:17<03:56,  1.01it/s]  6%|▌         | 14/252 [00:18<03:54,  1.02it/s]  6%|▌         | 15/252 [00:19<03:52,  1.02it/s]  6%|▋         | 16/252 [00:20<03:50,  1.02it/s]  7%|▋         | 17/252 [00:20<03:49,  1.02it/s]  7%|▋         | 18/252 [00:21<03:48,  1.02it/s]  8%|▊         | 19/252 [00:22<03:47,  1.03it/s]  8%|▊         | 20/252 [00:23<03:46,  1.02it/s]  8%|▊         | 21/252 [00:24<03:50,  1.00it/s]  9%|▊         | 22/252 [00:25<03:52,  1.01s/it]  9%|▉         | 23/252 [00:27<03:51,  1.01s/it] 10%|▉         | 24/252 [00:27<03:48,  1.00s/it] 10%|▉         | 25/252 [00:28<03:45,  1.00it/s] 10%|█         | 26/252 [00:29<03:44,  1.01it/s] 11%|█         | 27/252 [00:30<03:41,  1.02it/s] 11%|█         | 28/252 [00:31<03:39,  1.02it/s] 12%|█▏        | 29/252 [00:32<03:42,  1.00it/s] 12%|█▏        | 30/252 [00:33<03:39,  1.01it/s] 12%|█▏        | 31/252 [00:34<03:39,  1.01it/s] 13%|█▎        | 32/252 [00:35<03:38,  1.01it/s] 13%|█▎        | 33/252 [00:36<03:35,  1.01it/s] 13%|█▎        | 34/252 [00:37<03:34,  1.02it/s] 14%|█▍        | 35/252 [00:38<03:35,  1.01it/s] 14%|█▍        | 36/252 [00:39<03:33,  1.01it/s] 15%|█▍        | 37/252 [00:40<03:34,  1.00it/s] 15%|█▌        | 38/252 [00:41<03:32,  1.01it/s] 15%|█▌        | 39/252 [00:42<03:31,  1.01it/s] 16%|█▌        | 40/252 [00:43<03:29,  1.01it/s] 16%|█▋        | 41/252 [00:44<03:27,  1.02it/s] 17%|█▋        | 42/252 [00:45<03:31,  1.01s/it] 17%|█▋        | 43/252 [00:46<03:29,  1.00s/it] 17%|█▋        | 44/252 [00:47<03:29,  1.01s/it] 18%|█▊        | 45/252 [00:48<03:26,  1.00it/s] 18%|█▊        | 46/252 [00:49<03:26,  1.00s/it] 19%|█▊        | 47/252 [00:50<03:24,  1.00it/s] 19%|█▉        | 48/252 [00:51<03:22,  1.01it/s] 19%|█▉        | 49/252 [00:52<03:21,  1.01it/s] 20%|█▉        | 50/252 [00:53<03:20,  1.01it/s] 20%|██        | 51/252 [00:54<03:21,  1.00s/it] 21%|██        | 52/252 [00:55<03:19,  1.00it/s] 21%|██        | 53/252 [00:56<03:20,  1.01s/it] 21%|██▏       | 54/252 [00:57<03:19,  1.01s/it] 22%|██▏       | 55/252 [00:58<03:16,  1.00it/s] 22%|██▏       | 56/252 [00:59<03:14,  1.01it/s] 23%|██▎       | 57/252 [01:00<03:14,  1.00it/s] 23%|██▎       | 58/252 [01:01<03:14,  1.00s/it] 23%|██▎       | 59/252 [01:02<03:12,  1.00it/s] 24%|██▍       | 60/252 [01:03<03:12,  1.00s/it] 24%|██▍       | 61/252 [01:04<03:12,  1.01s/it] 25%|██▍       | 62/252 [01:05<03:09,  1.00it/s] 25%|██▌       | 63/252 [01:06<03:07,  1.01it/s] 25%|██▌       | 64/252 [01:07<03:06,  1.01it/s] 26%|██▌       | 65/252 [01:08<03:05,  1.01it/s] 26%|██▌       | 66/252 [01:09<03:04,  1.01it/s] 27%|██▋       | 67/252 [01:10<03:06,  1.01s/it] 27%|██▋       | 68/252 [01:11<03:08,  1.02s/it] 27%|██▋       | 69/252 [01:12<03:08,  1.03s/it] 28%|██▊       | 70/252 [01:13<03:05,  1.02s/it] 28%|██▊       | 71/252 [01:14<03:01,  1.01s/it] 29%|██▊       | 72/252 [01:15<03:03,  1.02s/it] 29%|██▉       | 73/252 [01:16<03:00,  1.01s/it] 29%|██▉       | 74/252 [01:17<03:00,  1.02s/it] 30%|██▉       | 75/252 [01:18<02:59,  1.01s/it] 30%|███       | 76/252 [01:19<02:58,  1.01s/it] 31%|███       | 77/252 [01:20<02:55,  1.00s/it] 31%|███       | 78/252 [01:21<02:53,  1.01it/s] 31%|███▏      | 79/252 [01:22<02:51,  1.01it/s] 32%|███▏      | 80/252 [01:23<02:52,  1.00s/it] 32%|███▏      | 81/252 [01:24<02:49,  1.01it/s] 33%|███▎      | 82/252 [01:25<02:51,  1.01s/it] 33%|███▎      | 83/252 [01:26<02:51,  1.02s/it] 33%|███▎      | 84/252 [01:27<02:49,  1.01s/it] 34%|███▎      | 85/252 [01:29<02:49,  1.02s/it] 34%|███▍      | 86/252 [01:30<02:47,  1.01s/it] 35%|███▍      | 87/252 [01:30<02:45,  1.00s/it] 35%|███▍      | 88/252 [01:31<02:43,  1.00it/s] 35%|███▌      | 89/252 [01:32<02:41,  1.01it/s] 36%|███▌      | 90/252 [01:33<02:39,  1.01it/s] 36%|███▌      | 91/252 [01:34<02:41,  1.00s/it] 37%|███▋      | 92/252 [01:35<02:40,  1.01s/it] 37%|███▋      | 93/252 [01:37<02:40,  1.01s/it] 37%|███▋      | 94/252 [01:37<02:38,  1.00s/it] 38%|███▊      | 95/252 [01:39<02:38,  1.01s/it] 38%|███▊      | 96/252 [01:39<02:36,  1.00s/it] 38%|███▊      | 97/252 [01:40<02:34,  1.00it/s] 39%|███▉      | 98/252 [01:41<02:32,  1.01it/s] 39%|███▉      | 99/252 [01:42<02:31,  1.01it/s] 40%|███▉      | 100/252 [01:43<02:32,  1.00s/it] 40%|████      | 101/252 [01:44<02:31,  1.00s/it] 40%|████      | 102/252 [01:45<02:28,  1.01it/s] 41%|████      | 103/252 [01:46<02:27,  1.01it/s] 41%|████▏     | 104/252 [01:47<02:26,  1.01it/s] 42%|████▏     | 105/252 [01:48<02:25,  1.01it/s] 42%|████▏     | 106/252 [01:49<02:26,  1.00s/it] 42%|████▏     | 107/252 [01:50<02:27,  1.02s/it] 43%|████▎     | 108/252 [01:52<02:28,  1.03s/it] 43%|████▎     | 109/252 [01:53<02:26,  1.02s/it] 44%|████▎     | 110/252 [01:54<02:23,  1.01s/it] 44%|████▍     | 111/252 [01:55<02:21,  1.01s/it] 44%|████▍     | 112/252 [01:56<02:22,  1.02s/it] 45%|████▍     | 113/252 [01:57<02:23,  1.03s/it] 45%|████▌     | 114/252 [01:58<02:21,  1.03s/it] 46%|████▌     | 115/252 [01:59<02:19,  1.02s/it] 46%|████▌     | 116/252 [02:00<02:19,  1.03s/it] 46%|████▋     | 117/252 [02:01<02:18,  1.03s/it] 47%|████▋     | 118/252 [02:02<02:16,  1.02s/it] 47%|████▋     | 119/252 [02:03<02:14,  1.01s/it] 48%|████▊     | 120/252 [02:04<02:14,  1.02s/it] 48%|████▊     | 121/252 [02:05<02:15,  1.03s/it] 48%|████▊     | 122/252 [02:06<02:12,  1.02s/it] 49%|████▉     | 123/252 [02:07<02:10,  1.01s/it] 49%|████▉     | 124/252 [02:08<02:10,  1.02s/it] 50%|████▉     | 125/252 [02:09<02:10,  1.03s/it] 50%|█████     | 126/252 [02:10<02:09,  1.03s/it] 50%|█████     | 127/252 [02:11<02:06,  1.02s/it] 51%|█████     | 128/252 [02:12<02:07,  1.03s/it] 51%|█████     | 129/252 [02:13<02:06,  1.03s/it] 52%|█████▏    | 130/252 [02:14<02:05,  1.03s/it] 52%|█████▏    | 131/252 [02:15<02:02,  1.01s/it] 52%|█████▏    | 132/252 [02:16<02:00,  1.01s/it] 53%|█████▎    | 133/252 [02:17<01:58,  1.00it/s] 53%|█████▎    | 134/252 [02:18<01:56,  1.01it/s] 54%|█████▎    | 135/252 [02:19<01:55,  1.02it/s] 54%|█████▍    | 136/252 [02:20<01:54,  1.01it/s] 54%|█████▍    | 137/252 [02:21<01:54,  1.01it/s] 55%|█████▍    | 138/252 [02:22<01:52,  1.01it/s] 55%|█████▌    | 139/252 [02:23<01:51,  1.01it/s] 56%|█████▌    | 140/252 [02:24<01:49,  1.02it/s] 56%|█████▌    | 141/252 [02:25<01:49,  1.02it/s] 56%|█████▋    | 142/252 [02:26<01:49,  1.00it/s] 57%|█████▋    | 143/252 [02:27<01:48,  1.01it/s] 57%|█████▋    | 144/252 [02:28<01:48,  1.00s/it] 58%|█████▊    | 145/252 [02:29<01:46,  1.00it/s] 58%|█████▊    | 146/252 [02:30<01:45,  1.00it/s] 58%|█████▊    | 147/252 [02:31<01:44,  1.00it/s] 59%|█████▊    | 148/252 [02:32<01:42,  1.02it/s] 59%|█████▉    | 149/252 [02:33<01:42,  1.01it/s] 60%|█████▉    | 150/252 [02:34<01:40,  1.01it/s] 60%|█████▉    | 151/252 [02:35<01:41,  1.00s/it] 60%|██████    | 152/252 [02:36<01:39,  1.01it/s] 61%|██████    | 153/252 [02:37<01:38,  1.01it/s] 61%|██████    | 154/252 [02:38<01:36,  1.01it/s] 62%|██████▏   | 155/252 [02:39<01:35,  1.01it/s] 62%|██████▏   | 156/252 [02:40<01:36,  1.00s/it] 62%|██████▏   | 157/252 [02:41<01:35,  1.00s/it] 63%|██████▎   | 158/252 [02:42<01:35,  1.01s/it] 63%|██████▎   | 159/252 [02:43<01:33,  1.00s/it] 63%|██████▎   | 160/252 [02:44<01:32,  1.01s/it] 64%|██████▍   | 161/252 [02:45<01:31,  1.01s/it] 64%|██████▍   | 162/252 [02:46<01:30,  1.00s/it] 65%|██████▍   | 163/252 [02:47<01:28,  1.01it/s] 65%|██████▌   | 164/252 [02:48<01:26,  1.01it/s] 65%|██████▌   | 165/252 [02:49<01:27,  1.00s/it] 66%|██████▌   | 166/252 [02:50<01:26,  1.00s/it] 66%|██████▋   | 167/252 [02:51<01:26,  1.02s/it] 67%|██████▋   | 168/252 [02:52<01:26,  1.03s/it] 67%|██████▋   | 169/252 [02:53<01:24,  1.02s/it] 67%|██████▋   | 170/252 [02:54<01:23,  1.01s/it] 68%|██████▊   | 171/252 [02:55<01:22,  1.02s/it] 68%|██████▊   | 172/252 [02:56<01:20,  1.01s/it] 69%|██████▊   | 173/252 [02:57<01:20,  1.01s/it] 69%|██████▉   | 174/252 [02:58<01:18,  1.00s/it] 69%|██████▉   | 175/252 [02:59<01:16,  1.00it/s] 70%|██████▉   | 176/252 [03:00<01:15,  1.00it/s] 70%|███████   | 177/252 [03:01<01:14,  1.01it/s] 71%|███████   | 178/252 [03:02<01:14,  1.00s/it] 71%|███████   | 179/252 [03:03<01:12,  1.00it/s] 71%|███████▏  | 180/252 [03:04<01:12,  1.00s/it] 72%|███████▏  | 181/252 [03:05<01:10,  1.00it/s] 72%|███████▏  | 182/252 [03:06<01:09,  1.00it/s] 73%|███████▎  | 183/252 [03:07<01:08,  1.01it/s] 73%|███████▎  | 184/252 [03:08<01:07,  1.01it/s] 73%|███████▎  | 185/252 [03:09<01:07,  1.00s/it] 74%|███████▍  | 186/252 [03:10<01:06,  1.00s/it] 74%|███████▍  | 187/252 [03:11<01:05,  1.01s/it] 75%|███████▍  | 188/252 [03:12<01:03,  1.00it/s] 75%|███████▌  | 189/252 [03:13<01:03,  1.01s/it] 75%|███████▌  | 190/252 [03:14<01:01,  1.00it/s] 76%|███████▌  | 191/252 [03:15<01:00,  1.01it/s] 76%|███████▌  | 192/252 [03:16<00:59,  1.01it/s] 77%|███████▋  | 193/252 [03:17<00:58,  1.01it/s] 77%|███████▋  | 194/252 [03:18<00:58,  1.00s/it] 77%|███████▋  | 195/252 [03:19<00:57,  1.01s/it] 78%|███████▊  | 196/252 [03:20<00:57,  1.02s/it] 78%|███████▊  | 197/252 [03:21<00:56,  1.03s/it] 79%|███████▊  | 198/252 [03:22<00:55,  1.03s/it] 79%|███████▉  | 199/252 [03:23<00:53,  1.02s/it] 79%|███████▉  | 200/252 [03:24<00:52,  1.01s/it] 80%|███████▉  | 201/252 [03:25<00:51,  1.02s/it] 80%|████████  | 202/252 [03:26<00:50,  1.01s/it] 81%|████████  | 203/252 [03:27<00:49,  1.01s/it] 81%|████████  | 204/252 [03:28<00:48,  1.00s/it] 81%|████████▏ | 205/252 [03:29<00:47,  1.00s/it] 82%|████████▏ | 206/252 [03:30<00:45,  1.00it/s] 82%|████████▏ | 207/252 [03:31<00:44,  1.01it/s] 83%|████████▎ | 208/252 [03:32<00:44,  1.01s/it] 83%|████████▎ | 209/252 [03:33<00:43,  1.00s/it] 83%|████████▎ | 210/252 [03:34<00:42,  1.02s/it] 84%|████████▎ | 211/252 [03:35<00:41,  1.01s/it] 84%|████████▍ | 212/252 [03:36<00:40,  1.01s/it] 85%|████████▍ | 213/252 [03:37<00:39,  1.00s/it] 85%|████████▍ | 214/252 [03:38<00:38,  1.01s/it] 85%|████████▌ | 215/252 [03:39<00:37,  1.00s/it] 86%|████████▌ | 216/252 [03:40<00:35,  1.00it/s] 86%|████████▌ | 217/252 [03:41<00:34,  1.00it/s] 87%|████████▋ | 218/252 [03:42<00:33,  1.01it/s] 87%|████████▋ | 219/252 [03:43<00:32,  1.01it/s] 87%|████████▋ | 220/252 [03:44<00:31,  1.00it/s] 88%|████████▊ | 221/252 [03:45<00:30,  1.01it/s] 88%|████████▊ | 222/252 [03:46<00:29,  1.01it/s] 88%|████████▊ | 223/252 [03:47<00:28,  1.01it/s] 89%|████████▉ | 224/252 [03:48<00:27,  1.01it/s] 89%|████████▉ | 225/252 [03:49<00:27,  1.00s/it] 90%|████████▉ | 226/252 [03:50<00:26,  1.00s/it] 90%|█████████ | 227/252 [03:51<00:25,  1.02s/it] 90%|█████████ | 228/252 [03:52<00:24,  1.03s/it] 91%|█████████ | 229/252 [03:53<00:23,  1.03s/it] 91%|█████████▏| 230/252 [03:54<00:22,  1.01s/it] 92%|█████████▏| 231/252 [03:55<00:21,  1.01s/it] 92%|█████████▏| 232/252 [03:56<00:20,  1.00s/it] 92%|█████████▏| 233/252 [03:57<00:19,  1.00s/it] 93%|█████████▎| 234/252 [03:58<00:17,  1.00it/s] 93%|█████████▎| 235/252 [03:59<00:18,  1.09s/it] 94%|█████████▎| 236/252 [04:00<00:16,  1.06s/it] 94%|█████████▍| 237/252 [04:02<00:16,  1.07s/it] 94%|█████████▍| 238/252 [04:03<00:15,  1.09s/it] 95%|█████████▍| 239/252 [04:04<00:14,  1.11s/it] 95%|█████████▌| 240/252 [04:05<00:13,  1.12s/it] 96%|█████████▌| 241/252 [04:07<00:14,  1.34s/it] 96%|█████████▌| 242/252 [04:08<00:12,  1.23s/it] 96%|█████████▋| 243/252 [04:11<00:15,  1.72s/it] 97%|█████████▋| 244/252 [04:12<00:11,  1.50s/it] 97%|█████████▋| 245/252 [04:13<00:09,  1.34s/it] 98%|█████████▊| 246/252 [04:14<00:07,  1.24s/it] 98%|█████████▊| 247/252 [04:15<00:05,  1.19s/it] 98%|█████████▊| 248/252 [04:16<00:04,  1.17s/it] 99%|█████████▉| 249/252 [04:17<00:03,  1.15s/it] 99%|█████████▉| 250/252 [04:18<00:02,  1.14s/it]100%|█████████▉| 251/252 [04:19<00:01,  1.11s/it]100%|██████████| 252/252 [04:20<00:00,  1.08s/it]100%|██████████| 252/252 [04:20<00:00,  1.03s/it]
/disk1/lhl/env/airs/lib/python3.8/site-packages/torch/functional.py:478: UserWarning:

torch.meshgrid: in an upcoming release, it will be required to pass the indexing argument. (Triggered internally at  /opt/conda/conda-bld/pytorch_1659484657607/work/aten/src/ATen/native/TensorShape.cpp:2895.)

GPU available: True, used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0,1,2]
/disk1/lhl/env/airs/lib/python3.8/site-packages/torch/functional.py:478: UserWarning:

torch.meshgrid: in an upcoming release, it will be required to pass the indexing argument. (Triggered internally at  /opt/conda/conda-bld/pytorch_1659484657607/work/aten/src/ATen/native/TensorShape.cpp:2895.)

GPU available: True, used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0,1,2]

  | Name | Type           | Params
----------------------------------------
0 | net  | UNetFormer     | 11.7 M
1 | loss | UnetFormerLoss | 0     
----------------------------------------
11.7 M    Trainable params
0         Non-trainable params
11.7 M    Total params
46.900    Total estimated model params size (MB)

  | Name | Type           | Params
----------------------------------------
0 | net  | UNetFormer     | 11.7 M
1 | loss | UnetFormerLoss | 0     
----------------------------------------
11.7 M    Trainable params
0         Non-trainable params
11.7 M    Total params
46.900    Total estimated model params size (MB)
/disk1/lhl/env/airs/lib/python3.8/site-packages/pytorch_lightning/trainer/data_loading.py:132: UserWarning:

The dataloader, val_dataloader 0, does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` (try 16 which is the number of cpus on this machine) in the `DataLoader` init to improve performance.

/disk1/lhl/workspace/unetformer/GeoSeg/tools/metric.py:29: RuntimeWarning:

invalid value encountered in divide

/disk1/lhl/env/airs/lib/python3.8/site-packages/pytorch_lightning/trainer/data_loading.py:132: UserWarning:

The dataloader, train_dataloader, does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` (try 16 which is the number of cpus on this machine) in the `DataLoader` init to improve performance.

/disk1/lhl/env/airs/lib/python3.8/site-packages/pytorch_lightning/trainer/data_loading.py:432: UserWarning:

The number of training samples (45) is smaller than the logging interval Trainer(log_every_n_steps=50). Set a lower value for log_every_n_steps if you want to see logs for the training epoch.

/disk1/lhl/env/airs/lib/python3.8/site-packages/pytorch_lightning/trainer/data_loading.py:132: UserWarning:

The dataloader, val_dataloader 0, does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` (try 16 which is the number of cpus on this machine) in the `DataLoader` init to improve performance.

/disk1/lhl/env/airs/lib/python3.8/site-packages/pytorch_lightning/trainer/data_loading.py:132: UserWarning:

The dataloader, train_dataloader, does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` (try 16 which is the number of cpus on this machine) in the `DataLoader` init to improve performance.

/disk1/lhl/env/airs/lib/python3.8/site-packages/torch/functional.py:478: UserWarning:

torch.meshgrid: in an upcoming release, it will be required to pass the indexing argument. (Triggered internally at  /opt/conda/conda-bld/pytorch_1659484657607/work/aten/src/ATen/native/TensorShape.cpp:2895.)

  0%|          | 0/57 [00:00<?, ?it/s]  2%|▏         | 1/57 [00:06<06:28,  6.94s/it]  4%|▎         | 2/57 [00:08<03:40,  4.01s/it]  5%|▌         | 3/57 [00:10<02:47,  3.10s/it]  7%|▋         | 4/57 [00:12<02:20,  2.66s/it]  9%|▉         | 5/57 [00:14<02:05,  2.41s/it] 11%|█         | 6/57 [00:16<01:55,  2.27s/it] 12%|█▏        | 7/57 [00:18<01:49,  2.18s/it] 14%|█▍        | 8/57 [00:20<01:44,  2.13s/it] 16%|█▌        | 9/57 [00:22<01:41,  2.11s/it] 18%|█▊        | 10/57 [00:25<01:38,  2.10s/it] 19%|█▉        | 11/57 [00:27<01:36,  2.09s/it] 21%|██        | 12/57 [00:29<01:33,  2.08s/it] 23%|██▎       | 13/57 [00:31<01:32,  2.10s/it] 25%|██▍       | 14/57 [00:33<01:31,  2.12s/it] 26%|██▋       | 15/57 [00:35<01:29,  2.13s/it] 28%|██▊       | 16/57 [00:37<01:25,  2.10s/it] 30%|██▉       | 17/57 [00:39<01:23,  2.09s/it] 32%|███▏      | 18/57 [00:41<01:22,  2.11s/it] 33%|███▎      | 19/57 [00:43<01:19,  2.08s/it] 35%|███▌      | 20/57 [00:45<01:16,  2.07s/it] 37%|███▋      | 21/57 [00:47<01:14,  2.06s/it] 39%|███▊      | 22/57 [00:50<01:11,  2.06s/it] 40%|████      | 23/57 [00:52<01:09,  2.05s/it] 42%|████▏     | 24/57 [00:54<01:07,  2.05s/it] 44%|████▍     | 25/57 [00:56<01:06,  2.07s/it] 46%|████▌     | 26/57 [00:58<01:04,  2.09s/it] 47%|████▋     | 27/57 [01:00<01:03,  2.11s/it] 49%|████▉     | 28/57 [01:02<01:01,  2.11s/it] 51%|█████     | 29/57 [01:04<00:59,  2.11s/it] 53%|█████▎    | 30/57 [01:06<00:56,  2.09s/it] 54%|█████▍    | 31/57 [01:08<00:54,  2.10s/it] 56%|█████▌    | 32/57 [01:10<00:52,  2.09s/it] 58%|█████▊    | 33/57 [01:13<00:50,  2.08s/it] 60%|█████▉    | 34/57 [01:15<00:48,  2.10s/it] 61%|██████▏   | 35/57 [01:17<00:45,  2.07s/it] 63%|██████▎   | 36/57 [01:19<00:43,  2.08s/it] 65%|██████▍   | 37/57 [01:21<00:41,  2.09s/it] 67%|██████▋   | 38/57 [01:23<00:39,  2.07s/it] 68%|██████▊   | 39/57 [01:25<00:37,  2.06s/it] 70%|███████   | 40/57 [01:27<00:34,  2.04s/it] 72%|███████▏  | 41/57 [01:29<00:32,  2.02s/it] 74%|███████▎  | 42/57 [01:31<00:30,  2.06s/it] 75%|███████▌  | 43/57 [01:33<00:28,  2.07s/it] 77%|███████▋  | 44/57 [01:35<00:26,  2.06s/it] 79%|███████▉  | 45/57 [01:37<00:24,  2.03s/it] 81%|████████  | 46/57 [01:39<00:22,  2.04s/it] 82%|████████▏ | 47/57 [01:41<00:20,  2.08s/it] 84%|████████▍ | 48/57 [01:44<00:18,  2.09s/it] 86%|████████▌ | 49/57 [01:46<00:16,  2.08s/it] 88%|████████▊ | 50/57 [01:48<00:14,  2.09s/it] 89%|████████▉ | 51/57 [01:50<00:12,  2.07s/it] 91%|█████████ | 52/57 [01:52<00:10,  2.06s/it] 93%|█████████▎| 53/57 [01:54<00:08,  2.07s/it] 95%|█████████▍| 54/57 [01:56<00:06,  2.05s/it] 96%|█████████▋| 55/57 [01:58<00:04,  2.04s/it] 98%|█████████▊| 56/57 [02:00<00:02,  2.07s/it]100%|██████████| 57/57 [02:04<00:00,  2.61s/it]100%|██████████| 57/57 [02:04<00:00,  2.18s/it]
/disk1/lhl/env/airs/lib/python3.8/site-packages/torch/functional.py:478: UserWarning:

torch.meshgrid: in an upcoming release, it will be required to pass the indexing argument. (Triggered internally at  /opt/conda/conda-bld/pytorch_1659484657607/work/aten/src/ATen/native/TensorShape.cpp:2895.)

  0%|          | 0/252 [00:00<?, ?it/s]  0%|          | 1/252 [00:05<22:21,  5.34s/it]  1%|          | 2/252 [00:06<11:32,  2.77s/it]  1%|          | 3/252 [00:07<08:04,  1.95s/it]  2%|▏         | 4/252 [00:08<06:27,  1.56s/it]  2%|▏         | 5/252 [00:09<05:33,  1.35s/it]  2%|▏         | 6/252 [00:10<05:00,  1.22s/it]  3%|▎         | 7/252 [00:11<04:40,  1.14s/it]  3%|▎         | 8/252 [00:12<04:25,  1.09s/it]  4%|▎         | 9/252 [00:13<04:20,  1.07s/it]  4%|▍         | 10/252 [00:14<04:16,  1.06s/it]  4%|▍         | 11/252 [00:15<04:09,  1.04s/it]  5%|▍         | 12/252 [00:16<04:03,  1.02s/it]  5%|▌         | 13/252 [00:17<03:59,  1.00s/it]  6%|▌         | 14/252 [00:18<03:56,  1.00it/s]  6%|▌         | 15/252 [00:19<03:55,  1.01it/s]  6%|▋         | 16/252 [00:20<03:55,  1.00it/s]  7%|▋         | 17/252 [00:21<03:53,  1.01it/s]  7%|▋         | 18/252 [00:22<03:54,  1.00s/it]  8%|▊         | 19/252 [00:23<03:53,  1.00s/it]  8%|▊         | 20/252 [00:24<03:51,  1.00it/s]  8%|▊         | 21/252 [00:25<03:49,  1.01it/s]  9%|▊         | 22/252 [00:26<03:46,  1.01it/s]  9%|▉         | 23/252 [00:27<03:46,  1.01it/s] 10%|▉         | 24/252 [00:28<03:49,  1.01s/it] 10%|▉         | 25/252 [00:29<03:49,  1.01s/it] 10%|█         | 26/252 [00:30<03:51,  1.03s/it] 11%|█         | 27/252 [00:31<03:51,  1.03s/it] 11%|█         | 28/252 [00:32<03:49,  1.02s/it] 12%|█▏        | 29/252 [00:33<03:46,  1.02s/it] 12%|█▏        | 30/252 [00:34<03:43,  1.01s/it] 12%|█▏        | 31/252 [00:35<03:44,  1.02s/it] 13%|█▎        | 32/252 [00:36<03:43,  1.02s/it] 13%|█▎        | 33/252 [00:37<03:44,  1.03s/it] 13%|█▎        | 34/252 [00:38<03:41,  1.02s/it] 14%|█▍        | 35/252 [00:39<03:41,  1.02s/it] 14%|█▍        | 36/252 [00:40<03:39,  1.02s/it] 15%|█▍        | 37/252 [00:41<03:40,  1.03s/it] 15%|█▌        | 38/252 [00:42<03:39,  1.02s/it] 15%|█▌        | 39/252 [00:43<03:40,  1.03s/it] 16%|█▌        | 40/252 [00:44<03:35,  1.02s/it] 16%|█▋        | 41/252 [00:45<03:36,  1.02s/it] 17%|█▋        | 42/252 [00:46<03:37,  1.03s/it] 17%|█▋        | 43/252 [00:47<03:37,  1.04s/it] 17%|█▋        | 44/252 [00:48<03:37,  1.04s/it] 18%|█▊        | 45/252 [00:49<03:33,  1.03s/it] 18%|█▊        | 46/252 [00:50<03:29,  1.02s/it] 19%|█▊        | 47/252 [00:51<03:27,  1.01s/it] 19%|█▉        | 48/252 [00:52<03:27,  1.02s/it] 19%|█▉        | 49/252 [00:53<03:28,  1.03s/it] 20%|█▉        | 50/252 [00:54<03:29,  1.04s/it] 20%|██        | 51/252 [00:55<03:29,  1.04s/it] 21%|██        | 52/252 [00:56<03:26,  1.03s/it] 21%|██        | 53/252 [00:57<03:22,  1.02s/it] 21%|██▏       | 54/252 [00:58<03:19,  1.01s/it] 22%|██▏       | 55/252 [00:59<03:21,  1.02s/it] 22%|██▏       | 56/252 [01:00<03:20,  1.02s/it] 23%|██▎       | 57/252 [01:01<03:18,  1.02s/it] 23%|██▎       | 58/252 [01:02<03:16,  1.02s/it] 23%|██▎       | 59/252 [01:03<03:15,  1.01s/it] 24%|██▍       | 60/252 [01:04<03:17,  1.03s/it] 24%|██▍       | 61/252 [01:06<03:18,  1.04s/it] 25%|██▍       | 62/252 [01:07<03:17,  1.04s/it] 25%|██▌       | 63/252 [01:08<03:13,  1.02s/it] 25%|██▌       | 64/252 [01:09<03:10,  1.01s/it] 26%|██▌       | 65/252 [01:10<03:10,  1.02s/it] 26%|██▌       | 66/252 [01:11<03:07,  1.01s/it] 27%|██▋       | 67/252 [01:12<03:09,  1.02s/it] 27%|██▋       | 68/252 [01:13<03:07,  1.02s/it] 27%|██▋       | 69/252 [01:14<03:08,  1.03s/it] 28%|██▊       | 70/252 [01:15<03:06,  1.03s/it] 28%|██▊       | 71/252 [01:16<03:03,  1.02s/it] 29%|██▊       | 72/252 [01:17<03:05,  1.03s/it] 29%|██▉       | 73/252 [01:18<03:02,  1.02s/it] 29%|██▉       | 74/252 [01:19<03:02,  1.03s/it] 30%|██▉       | 75/252 [01:20<03:00,  1.02s/it] 30%|███       | 76/252 [01:21<03:00,  1.03s/it] 31%|███       | 77/252 [01:22<02:58,  1.02s/it] 31%|███       | 78/252 [01:23<02:58,  1.03s/it] 31%|███▏      | 79/252 [01:24<02:55,  1.02s/it] 32%|███▏      | 80/252 [01:25<02:55,  1.02s/it] 32%|███▏      | 81/252 [01:26<02:55,  1.03s/it] 33%|███▎      | 82/252 [01:27<02:53,  1.02s/it] 33%|███▎      | 83/252 [01:28<02:53,  1.03s/it] 33%|███▎      | 84/252 [01:29<02:51,  1.02s/it] 34%|███▎      | 85/252 [01:30<02:51,  1.03s/it] 34%|███▍      | 86/252 [01:31<02:51,  1.03s/it] 35%|███▍      | 87/252 [01:32<02:47,  1.02s/it] 35%|███▍      | 88/252 [01:33<02:48,  1.03s/it] 35%|███▌      | 89/252 [01:34<02:46,  1.02s/it] 36%|███▌      | 90/252 [01:35<02:44,  1.02s/it] 36%|███▌      | 91/252 [01:36<02:44,  1.02s/it] 37%|███▋      | 92/252 [01:37<02:45,  1.03s/it] 37%|███▋      | 93/252 [01:38<02:45,  1.04s/it] 37%|███▋      | 94/252 [01:39<02:44,  1.04s/it] 38%|███▊      | 95/252 [01:40<02:43,  1.04s/it] 38%|███▊      | 96/252 [01:41<02:40,  1.03s/it] 38%|███▊      | 97/252 [01:42<02:37,  1.02s/it] 39%|███▉      | 98/252 [01:43<02:34,  1.00s/it] 39%|███▉      | 99/252 [01:44<02:35,  1.02s/it] 40%|███▉      | 100/252 [01:45<02:36,  1.03s/it] 40%|████      | 101/252 [01:46<02:32,  1.01s/it] 40%|████      | 102/252 [01:47<02:32,  1.02s/it] 41%|████      | 103/252 [01:49<02:32,  1.02s/it] 41%|████▏     | 104/252 [01:50<02:31,  1.02s/it] 42%|████▏     | 105/252 [01:51<02:29,  1.02s/it] 42%|████▏     | 106/252 [01:52<02:30,  1.03s/it] 42%|████▏     | 107/252 [01:53<02:30,  1.04s/it] 43%|████▎     | 108/252 [01:54<02:30,  1.04s/it] 43%|████▎     | 109/252 [01:55<02:26,  1.02s/it] 44%|████▎     | 110/252 [01:56<02:22,  1.01s/it] 44%|████▍     | 111/252 [01:57<02:23,  1.02s/it] 44%|████▍     | 112/252 [01:58<02:23,  1.02s/it] 45%|████▍     | 113/252 [01:59<02:21,  1.02s/it] 45%|████▌     | 114/252 [02:00<02:20,  1.02s/it] 46%|████▌     | 115/252 [02:01<02:20,  1.02s/it] 46%|████▌     | 116/252 [02:02<02:20,  1.03s/it] 46%|████▋     | 117/252 [02:03<02:19,  1.04s/it] 47%|████▋     | 118/252 [02:04<02:18,  1.03s/it] 47%|████▋     | 119/252 [02:05<02:15,  1.02s/it] 48%|████▊     | 120/252 [02:06<02:13,  1.01s/it] 48%|████▊     | 121/252 [02:07<02:14,  1.02s/it] 48%|████▊     | 122/252 [02:08<02:12,  1.02s/it] 49%|████▉     | 123/252 [02:09<02:12,  1.03s/it] 49%|████▉     | 124/252 [02:10<02:10,  1.02s/it] 50%|████▉     | 125/252 [02:11<02:09,  1.02s/it] 50%|█████     | 126/252 [02:12<02:09,  1.03s/it] 50%|█████     | 127/252 [02:13<02:09,  1.03s/it] 51%|█████     | 128/252 [02:14<02:09,  1.04s/it] 51%|█████     | 129/252 [02:15<02:05,  1.02s/it] 52%|█████▏    | 130/252 [02:16<02:03,  1.02s/it] 52%|█████▏    | 131/252 [02:17<02:02,  1.01s/it] 52%|█████▏    | 132/252 [02:18<02:02,  1.02s/it] 53%|█████▎    | 133/252 [02:19<02:01,  1.02s/it] 53%|█████▎    | 134/252 [02:20<01:59,  1.01s/it] 54%|█████▎    | 135/252 [02:21<01:59,  1.03s/it] 54%|█████▍    | 136/252 [02:22<01:59,  1.03s/it] 54%|█████▍    | 137/252 [02:23<01:58,  1.03s/it] 55%|█████▍    | 138/252 [02:24<01:58,  1.04s/it] 55%|█████▌    | 139/252 [02:25<01:56,  1.03s/it] 56%|█████▌    | 140/252 [02:26<01:53,  1.01s/it] 56%|█████▌    | 141/252 [02:27<01:51,  1.01s/it] 56%|█████▋    | 142/252 [02:28<01:52,  1.02s/it] 57%|█████▋    | 143/252 [02:30<01:52,  1.03s/it] 57%|█████▋    | 144/252 [02:31<01:52,  1.04s/it] 58%|█████▊    | 145/252 [02:32<01:49,  1.02s/it] 58%|█████▊    | 146/252 [02:33<01:46,  1.01s/it] 58%|█████▊    | 147/252 [02:34<01:47,  1.02s/it] 59%|█████▊    | 148/252 [02:35<01:46,  1.03s/it] 59%|█████▉    | 149/252 [02:36<01:46,  1.04s/it] 60%|█████▉    | 150/252 [02:37<01:45,  1.04s/it] 60%|█████▉    | 151/252 [02:38<01:43,  1.03s/it] 60%|██████    | 152/252 [02:39<01:41,  1.02s/it] 61%|██████    | 153/252 [02:40<01:39,  1.01s/it] 61%|██████    | 154/252 [02:41<01:39,  1.02s/it] 62%|██████▏   | 155/252 [02:42<01:40,  1.03s/it] 62%|██████▏   | 156/252 [02:43<01:40,  1.04s/it] 62%|██████▏   | 157/252 [02:44<01:38,  1.03s/it] 63%|██████▎   | 158/252 [02:45<01:35,  1.02s/it] 63%|██████▎   | 159/252 [02:46<01:34,  1.02s/it] 63%|██████▎   | 160/252 [02:47<01:34,  1.03s/it] 64%|██████▍   | 161/252 [02:48<01:33,  1.03s/it] 64%|██████▍   | 162/252 [02:49<01:31,  1.01s/it] 65%|██████▍   | 163/252 [02:50<01:30,  1.02s/it] 65%|██████▌   | 164/252 [02:51<01:30,  1.03s/it] 65%|██████▌   | 165/252 [02:52<01:29,  1.03s/it] 66%|██████▌   | 166/252 [02:53<01:27,  1.02s/it] 66%|██████▋   | 167/252 [02:54<01:25,  1.01s/it] 67%|██████▋   | 168/252 [02:55<01:25,  1.02s/it] 67%|██████▋   | 169/252 [02:56<01:25,  1.03s/it] 67%|██████▋   | 170/252 [02:57<01:25,  1.04s/it] 68%|██████▊   | 171/252 [02:58<01:23,  1.03s/it] 68%|██████▊   | 172/252 [02:59<01:20,  1.01s/it] 69%|██████▊   | 173/252 [03:00<01:20,  1.02s/it] 69%|██████▉   | 174/252 [03:01<01:19,  1.02s/it] 69%|██████▉   | 175/252 [03:02<01:18,  1.02s/it] 70%|██████▉   | 176/252 [03:03<01:17,  1.03s/it] 70%|███████   | 177/252 [03:04<01:16,  1.02s/it] 71%|███████   | 178/252 [03:05<01:14,  1.01s/it] 71%|███████   | 179/252 [03:06<01:14,  1.02s/it] 71%|███████▏  | 180/252 [03:07<01:14,  1.03s/it] 72%|███████▏  | 181/252 [03:08<01:13,  1.04s/it] 72%|███████▏  | 182/252 [03:09<01:12,  1.03s/it] 73%|███████▎  | 183/252 [03:10<01:10,  1.02s/it] 73%|███████▎  | 184/252 [03:11<01:08,  1.01s/it] 73%|███████▎  | 185/252 [03:12<01:08,  1.02s/it] 74%|███████▍  | 186/252 [03:14<01:08,  1.03s/it] 74%|███████▍  | 187/252 [03:15<01:07,  1.03s/it] 75%|███████▍  | 188/252 [03:16<01:05,  1.03s/it] 75%|███████▌  | 189/252 [03:17<01:04,  1.02s/it] 75%|███████▌  | 190/252 [03:18<01:03,  1.03s/it] 76%|███████▌  | 191/252 [03:19<01:03,  1.04s/it] 76%|███████▌  | 192/252 [03:20<01:01,  1.03s/it] 77%|███████▋  | 193/252 [03:21<01:00,  1.02s/it] 77%|███████▋  | 194/252 [03:22<00:59,  1.02s/it] 77%|███████▋  | 195/252 [03:23<00:57,  1.01s/it] 78%|███████▊  | 196/252 [03:24<00:57,  1.02s/it] 78%|███████▊  | 197/252 [03:25<00:56,  1.02s/it] 79%|███████▊  | 198/252 [03:26<00:55,  1.03s/it] 79%|███████▉  | 199/252 [03:27<00:54,  1.04s/it] 79%|███████▉  | 200/252 [03:28<00:53,  1.03s/it] 80%|███████▉  | 201/252 [03:29<00:52,  1.03s/it] 80%|████████  | 202/252 [03:30<00:51,  1.03s/it] 81%|████████  | 203/252 [03:31<00:49,  1.01s/it] 81%|████████  | 204/252 [03:32<00:48,  1.01s/it] 81%|████████▏ | 205/252 [03:33<00:47,  1.02s/it] 82%|████████▏ | 206/252 [03:34<00:47,  1.03s/it] 82%|████████▏ | 207/252 [03:35<00:46,  1.04s/it] 83%|████████▎ | 208/252 [03:36<00:45,  1.03s/it] 83%|████████▎ | 209/252 [03:37<00:43,  1.02s/it] 83%|████████▎ | 210/252 [03:38<00:42,  1.01s/it] 84%|████████▎ | 211/252 [03:39<00:41,  1.01s/it] 84%|████████▍ | 212/252 [03:40<00:40,  1.02s/it] 85%|████████▍ | 213/252 [03:41<00:40,  1.03s/it] 85%|████████▍ | 214/252 [03:42<00:39,  1.03s/it] 85%|████████▌ | 215/252 [03:43<00:37,  1.02s/it] 86%|████████▌ | 216/252 [03:44<00:36,  1.01s/it] 86%|████████▌ | 217/252 [03:45<00:35,  1.02s/it] 87%|████████▋ | 218/252 [03:46<00:34,  1.02s/it] 87%|████████▋ | 219/252 [03:47<00:33,  1.01s/it] 87%|████████▋ | 220/252 [03:48<00:32,  1.02s/it] 88%|████████▊ | 221/252 [03:49<00:31,  1.03s/it] 88%|████████▊ | 222/252 [03:50<00:30,  1.02s/it] 88%|████████▊ | 223/252 [03:51<00:29,  1.03s/it] 89%|████████▉ | 224/252 [03:52<00:28,  1.02s/it] 89%|████████▉ | 225/252 [03:53<00:27,  1.02s/it] 90%|████████▉ | 226/252 [03:54<00:26,  1.03s/it] 90%|█████████ | 227/252 [03:56<00:25,  1.03s/it] 90%|█████████ | 228/252 [03:57<00:24,  1.04s/it] 91%|█████████ | 229/252 [03:58<00:23,  1.04s/it] 91%|█████████▏| 230/252 [03:59<00:22,  1.02s/it] 92%|█████████▏| 231/252 [04:00<00:21,  1.01s/it] 92%|█████████▏| 232/252 [04:01<00:20,  1.02s/it] 92%|█████████▏| 233/252 [04:02<00:19,  1.04s/it] 93%|█████████▎| 234/252 [04:03<00:18,  1.04s/it] 93%|█████████▎| 235/252 [04:04<00:17,  1.03s/it] 94%|█████████▎| 236/252 [04:05<00:16,  1.01s/it] 94%|█████████▍| 237/252 [04:06<00:15,  1.01s/it] 94%|█████████▍| 238/252 [04:07<00:14,  1.02s/it] 95%|█████████▍| 239/252 [04:08<00:13,  1.02s/it] 95%|█████████▌| 240/252 [04:09<00:12,  1.01s/it] 96%|█████████▌| 241/252 [04:10<00:11,  1.02s/it] 96%|█████████▌| 242/252 [04:11<00:10,  1.03s/it] 96%|█████████▋| 243/252 [04:12<00:09,  1.04s/it] 97%|█████████▋| 244/252 [04:13<00:08,  1.05s/it] 97%|█████████▋| 245/252 [04:14<00:07,  1.04s/it] 98%|█████████▊| 246/252 [04:15<00:06,  1.02s/it] 98%|█████████▊| 247/252 [04:16<00:05,  1.01s/it] 98%|█████████▊| 248/252 [04:17<00:04,  1.02s/it] 99%|█████████▉| 249/252 [04:18<00:03,  1.01s/it] 99%|█████████▉| 250/252 [04:19<00:02,  1.01s/it]100%|█████████▉| 251/252 [04:20<00:01,  1.02s/it]100%|██████████| 252/252 [04:21<00:00,  1.04s/it]100%|██████████| 252/252 [04:21<00:00,  1.04s/it]
/disk1/lhl/env/airs/lib/python3.8/site-packages/torch/functional.py:478: UserWarning:

torch.meshgrid: in an upcoming release, it will be required to pass the indexing argument. (Triggered internally at  /opt/conda/conda-bld/pytorch_1659484657607/work/aten/src/ATen/native/TensorShape.cpp:2895.)

GPU available: True, used: True
/disk1/lhl/env/airs/lib/python3.8/site-packages/torch/functional.py:478: UserWarning:

torch.meshgrid: in an upcoming release, it will be required to pass the indexing argument. (Triggered internally at  /opt/conda/conda-bld/pytorch_1659484657607/work/aten/src/ATen/native/TensorShape.cpp:2895.)

GPU available: True, used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0,1,2]
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0,1,2]

  | Name | Type           | Params
----------------------------------------
0 | net  | UNetFormer     | 11.7 M
1 | loss | UnetFormerLoss | 0     
----------------------------------------
11.7 M    Trainable params
0         Non-trainable params
11.7 M    Total params
46.900    Total estimated model params size (MB)

  | Name | Type           | Params
----------------------------------------
0 | net  | UNetFormer     | 11.7 M
1 | loss | UnetFormerLoss | 0     
----------------------------------------
11.7 M    Trainable params
0         Non-trainable params
11.7 M    Total params
46.900    Total estimated model params size (MB)
Traceback (most recent call last):
  File "./train_supervision.py", line 201, in <module>
    main()
  File "./train_supervision.py", line 197, in main
    trainer.fit(model=model)
  File "/disk1/lhl/env/airs/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 740, in fit
    self._call_and_handle_interrupt(
  File "/disk1/lhl/env/airs/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 685, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "/disk1/lhl/env/airs/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 777, in _fit_impl
    self._run(model, ckpt_path=ckpt_path)
  File "/disk1/lhl/env/airs/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1199, in _run
    self._dispatch()
  File "/disk1/lhl/env/airs/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1279, in _dispatch
    self.training_type_plugin.start_training(self)
  File "/disk1/lhl/env/airs/lib/python3.8/site-packages/pytorch_lightning/plugins/training_type/training_type_plugin.py", line 202, in start_training
    self._results = trainer.run_stage()
  File "/disk1/lhl/env/airs/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1289, in run_stage
    return self._run_train()
  File "/disk1/lhl/env/airs/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1311, in _run_train
    self._run_sanity_check(self.lightning_module)
  File "/disk1/lhl/env/airs/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1371, in _run_sanity_check
    self._evaluation_loop._reload_evaluation_dataloaders()
  File "/disk1/lhl/env/airs/lib/python3.8/site-packages/pytorch_lightning/loops/dataloader/evaluation_loop.py", line 170, in _reload_evaluation_dataloaders
    self.trainer.reset_val_dataloader()
  File "/disk1/lhl/env/airs/lib/python3.8/site-packages/pytorch_lightning/trainer/data_loading.py", line 551, in reset_val_dataloader
    self.num_val_batches, self.val_dataloaders = self._reset_eval_dataloader(
  File "/disk1/lhl/env/airs/lib/python3.8/site-packages/pytorch_lightning/trainer/data_loading.py", line 508, in _reset_eval_dataloader
    if has_len_all_ranks(dataloader, self.training_type_plugin, module)
  File "/disk1/lhl/env/airs/lib/python3.8/site-packages/pytorch_lightning/utilities/data.py", line 118, in has_len_all_ranks
    raise MisconfigurationException(
pytorch_lightning.utilities.exceptions.MisconfigurationException: Total length of `Dataloader` across ranks is zero. Please make sure that it returns at least 1 batch.
/disk1/lhl/env/airs/lib/python3.8/site-packages/pytorch_lightning/trainer/data_loading.py:132: UserWarning:

The dataloader, val_dataloader 0, does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` (try 16 which is the number of cpus on this machine) in the `DataLoader` init to improve performance.

/disk1/lhl/workspace/unetformer/GeoSeg/tools/metric.py:31: RuntimeWarning:

invalid value encountered in divide

/disk1/lhl/env/airs/lib/python3.8/site-packages/pytorch_lightning/trainer/data_loading.py:132: UserWarning:

The dataloader, train_dataloader, does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` (try 16 which is the number of cpus on this machine) in the `DataLoader` init to improve performance.

/disk1/lhl/env/airs/lib/python3.8/site-packages/torch/functional.py:478: UserWarning:

torch.meshgrid: in an upcoming release, it will be required to pass the indexing argument. (Triggered internally at  /opt/conda/conda-bld/pytorch_1659484657607/work/aten/src/ATen/native/TensorShape.cpp:2895.)

Traceback (most recent call last):
  File "./potsdam_test.py", line 134, in <module>
    main()
  File "./potsdam_test.py", line 69, in main
    model = Supervision_Train.load_from_checkpoint(
  File "/disk1/lhl/env/airs/lib/python3.8/site-packages/pytorch_lightning/core/saving.py", line 134, in load_from_checkpoint
    checkpoint = pl_load(checkpoint_path, map_location=lambda storage, loc: storage)
  File "/disk1/lhl/env/airs/lib/python3.8/site-packages/pytorch_lightning/utilities/cloud_io.py", line 37, in load
    with fs.open(path_or_url, "rb") as f:
  File "/disk1/lhl/env/airs/lib/python3.8/site-packages/fsspec/spec.py", line 1034, in open
    f = self._open(
  File "/disk1/lhl/env/airs/lib/python3.8/site-packages/fsspec/implementations/local.py", line 162, in _open
    return LocalFileOpener(path, mode, fs=self, **kwargs)
  File "/disk1/lhl/env/airs/lib/python3.8/site-packages/fsspec/implementations/local.py", line 260, in __init__
    self._open()
  File "/disk1/lhl/env/airs/lib/python3.8/site-packages/fsspec/implementations/local.py", line 265, in _open
    self.f = open(self.path, mode=self.mode)
FileNotFoundError: [Errno 2] No such file or directory: '/disk1/lhl/workspace/unetformer/GeoSeg/model_weights/potsdam/unetformer-r18-512-ms-e45/unetformer-r18-512-ms-e45.ckpt'
/disk1/lhl/env/airs/lib/python3.8/site-packages/torch/functional.py:478: UserWarning:

torch.meshgrid: in an upcoming release, it will be required to pass the indexing argument. (Triggered internally at  /opt/conda/conda-bld/pytorch_1659484657607/work/aten/src/ATen/native/TensorShape.cpp:2895.)

GPU available: True, used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0,1,2]

  | Name | Type           | Params
----------------------------------------
0 | net  | UNetFormer     | 11.7 M
1 | loss | UnetFormerLoss | 0     
----------------------------------------
11.7 M    Trainable params
0         Non-trainable params
11.7 M    Total params
46.900    Total estimated model params size (MB)
/disk1/lhl/env/airs/lib/python3.8/site-packages/pytorch_lightning/trainer/data_loading.py:132: UserWarning:

The dataloader, val_dataloader 0, does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` (try 16 which is the number of cpus on this machine) in the `DataLoader` init to improve performance.

/disk1/lhl/env/airs/lib/python3.8/site-packages/pytorch_lightning/trainer/data_loading.py:132: UserWarning:

The dataloader, train_dataloader, does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` (try 16 which is the number of cpus on this machine) in the `DataLoader` init to improve performance.

/disk1/lhl/env/airs/lib/python3.8/site-packages/torch/functional.py:478: UserWarning:

torch.meshgrid: in an upcoming release, it will be required to pass the indexing argument. (Triggered internally at  /opt/conda/conda-bld/pytorch_1659484657607/work/aten/src/ATen/native/TensorShape.cpp:2895.)

  0%|          | 0/639 [00:00<?, ?it/s]  0%|          | 0/639 [00:01<?, ?it/s]
Traceback (most recent call last):
  File "./vaihingen_test.py", line 132, in <module>
    main()
  File "./vaihingen_test.py", line 104, in main
    raw_predictions = model(input['img'].cuda(config.gpus[0]))
  File "/disk1/lhl/env/airs/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1130, in _call_impl
    return forward_call(*input, **kwargs)
  File "/disk1/lhl/env/airs/lib/python3.8/site-packages/ttach/wrappers.py", line 39, in forward
    augmented_output = self.model(augmented_image, *args)
  File "/disk1/lhl/env/airs/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1130, in _call_impl
    return forward_call(*input, **kwargs)
  File "/disk1/lhl/workspace/unetformer/GeoSeg/train_supervision.py", line 47, in forward
    seg_pre = self.net(x)
  File "/disk1/lhl/env/airs/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1130, in _call_impl
    return forward_call(*input, **kwargs)
  File "/disk1/lhl/workspace/unetformer/GeoSeg/geoseg/models/UNetFormer.py", line 375, in forward
    x = self.decoder(res1, res2, res3, res4, h, w)
  File "/disk1/lhl/env/airs/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1130, in _call_impl
    return forward_call(*input, **kwargs)
  File "/disk1/lhl/workspace/unetformer/GeoSeg/geoseg/models/UNetFormer.py", line 329, in forward
    x = self.b4(self.pre_conv(res4))
  File "/disk1/lhl/env/airs/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1130, in _call_impl
    return forward_call(*input, **kwargs)
  File "/disk1/lhl/workspace/unetformer/GeoSeg/geoseg/models/UNetFormer.py", line 201, in forward
    x = x + self.drop_path(self.attn(self.norm1(x)))
  File "/disk1/lhl/env/airs/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1130, in _call_impl
    return forward_call(*input, **kwargs)
  File "/disk1/lhl/workspace/unetformer/GeoSeg/geoseg/models/UNetFormer.py", line 152, in forward
    x = self.pad(x, self.ws)
  File "/disk1/lhl/workspace/unetformer/GeoSeg/geoseg/models/UNetFormer.py", line 138, in pad
    x = F.pad(x, (0, ps - W % ps), mode='reflect')
NotImplementedError: Only 2D, 3D, 4D, 5D padding with non-constant padding are supported for now
Killed
/disk1/lhl/env/airs/lib/python3.8/site-packages/torch/functional.py:478: UserWarning:

torch.meshgrid: in an upcoming release, it will be required to pass the indexing argument. (Triggered internally at  /opt/conda/conda-bld/pytorch_1659484657607/work/aten/src/ATen/native/TensorShape.cpp:2895.)

  0%|          | 0/3703 [00:00<?, ?it/s]  0%|          | 0/3703 [00:01<?, ?it/s]
Traceback (most recent call last):
  File "./potsdam_test.py", line 134, in <module>
    main()
  File "./potsdam_test.py", line 107, in main
    raw_predictions = model(input['img'].cuda(config.gpus[0]))
  File "/disk1/lhl/env/airs/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1130, in _call_impl
    return forward_call(*input, **kwargs)
  File "/disk1/lhl/env/airs/lib/python3.8/site-packages/ttach/wrappers.py", line 39, in forward
    augmented_output = self.model(augmented_image, *args)
  File "/disk1/lhl/env/airs/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1130, in _call_impl
    return forward_call(*input, **kwargs)
  File "/disk1/lhl/workspace/unetformer/GeoSeg/train_supervision.py", line 47, in forward
    seg_pre = self.net(x)
  File "/disk1/lhl/env/airs/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1130, in _call_impl
    return forward_call(*input, **kwargs)
  File "/disk1/lhl/workspace/unetformer/GeoSeg/geoseg/models/UNetFormer.py", line 375, in forward
    x = self.decoder(res1, res2, res3, res4, h, w)
  File "/disk1/lhl/env/airs/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1130, in _call_impl
    return forward_call(*input, **kwargs)
  File "/disk1/lhl/workspace/unetformer/GeoSeg/geoseg/models/UNetFormer.py", line 329, in forward
    x = self.b4(self.pre_conv(res4))
  File "/disk1/lhl/env/airs/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1130, in _call_impl
    return forward_call(*input, **kwargs)
  File "/disk1/lhl/workspace/unetformer/GeoSeg/geoseg/models/UNetFormer.py", line 201, in forward
    x = x + self.drop_path(self.attn(self.norm1(x)))
  File "/disk1/lhl/env/airs/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1130, in _call_impl
    return forward_call(*input, **kwargs)
  File "/disk1/lhl/workspace/unetformer/GeoSeg/geoseg/models/UNetFormer.py", line 152, in forward
    x = self.pad(x, self.ws)
  File "/disk1/lhl/workspace/unetformer/GeoSeg/geoseg/models/UNetFormer.py", line 138, in pad
    x = F.pad(x, (0, ps - W % ps), mode='reflect')
NotImplementedError: Only 2D, 3D, 4D, 5D padding with non-constant padding are supported for now
/disk1/lhl/env/airs/lib/python3.8/site-packages/torch/functional.py:478: UserWarning:

torch.meshgrid: in an upcoming release, it will be required to pass the indexing argument. (Triggered internally at  /opt/conda/conda-bld/pytorch_1659484657607/work/aten/src/ATen/native/TensorShape.cpp:2895.)

Traceback (most recent call last):
  File "./train_supervision.py", line 201, in <module>
    main()
  File "./train_supervision.py", line 180, in main
    config = py2cfg(args.config_path)
  File "/disk1/lhl/workspace/unetformer/GeoSeg/tools/cfg.py", line 67, in py2cfg
    cfg_dict = py2dict(file_path)
  File "/disk1/lhl/workspace/unetformer/GeoSeg/tools/cfg.py", line 59, in py2dict
    mod = import_module(module_name)
  File "/disk1/lhl/env/airs/lib/python3.8/importlib/__init__.py", line 127, in import_module
    return _bootstrap._gcd_import(name[level:], package, level)
  File "<frozen importlib._bootstrap>", line 1014, in _gcd_import
  File "<frozen importlib._bootstrap>", line 991, in _find_and_load
  File "<frozen importlib._bootstrap>", line 975, in _find_and_load_unlocked
  File "<frozen importlib._bootstrap>", line 671, in _load_unlocked
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/disk1/lhl/workspace/unetformer/GeoSeg/config/potsdam/unetformer.py", line 49, in <module>
    val_dataset = PotsdamDataset(transform=val_aug)
  File "/disk1/lhl/workspace/unetformer/GeoSeg/geoseg/datasets/potsdam_dataset.py", line 76, in __init__
    self.img_ids = self.get_img_ids(self.data_root, self.img_dir, self.mask_dir)
  File "/disk1/lhl/workspace/unetformer/GeoSeg/geoseg/datasets/potsdam_dataset.py", line 99, in get_img_ids
    img_filename_list = os.listdir(osp.join(data_root, img_dir))
FileNotFoundError: [Errno 2] No such file or directory: 'data/potsdam/test/images'
/disk1/lhl/env/airs/lib/python3.8/site-packages/torch/functional.py:478: UserWarning:

torch.meshgrid: in an upcoming release, it will be required to pass the indexing argument. (Triggered internally at  /opt/conda/conda-bld/pytorch_1659484657607/work/aten/src/ATen/native/TensorShape.cpp:2895.)

GPU available: True, used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0,1,2]
usage: potsdam_test.py [-h] -c CONFIG_PATH -o OUTPUT_PATH [-t {None,d4,lr}]
                       [--rgb]
potsdam_test.py: error: argument -t/--tta: invalid choice: 'none' (choose from None, 'd4', 'lr')
/disk1/lhl/env/airs/lib/python3.8/site-packages/torch/functional.py:478: UserWarning:

torch.meshgrid: in an upcoming release, it will be required to pass the indexing argument. (Triggered internally at  /opt/conda/conda-bld/pytorch_1659484657607/work/aten/src/ATen/native/TensorShape.cpp:2895.)

Traceback (most recent call last):
  File "./potsdam_test.py", line 134, in <module>
    main()
  File "./potsdam_test.py", line 66, in main
    config = py2cfg(args.config_path)
  File "/disk1/lhl/workspace/unetformer/GeoSeg/tools/cfg.py", line 67, in py2cfg
    cfg_dict = py2dict(file_path)
  File "/disk1/lhl/workspace/unetformer/GeoSeg/tools/cfg.py", line 59, in py2dict
    mod = import_module(module_name)
  File "/disk1/lhl/env/airs/lib/python3.8/importlib/__init__.py", line 127, in import_module
    return _bootstrap._gcd_import(name[level:], package, level)
  File "<frozen importlib._bootstrap>", line 1014, in _gcd_import
  File "<frozen importlib._bootstrap>", line 991, in _find_and_load
  File "<frozen importlib._bootstrap>", line 975, in _find_and_load_unlocked
  File "<frozen importlib._bootstrap>", line 671, in _load_unlocked
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/disk1/lhl/workspace/unetformer/GeoSeg/config/potsdam/unetformer.py", line 49, in <module>
    val_dataset = PotsdamDataset(transform=val_aug)
  File "/disk1/lhl/workspace/unetformer/GeoSeg/geoseg/datasets/potsdam_dataset.py", line 76, in __init__
    self.img_ids = self.get_img_ids(self.data_root, self.img_dir, self.mask_dir)
  File "/disk1/lhl/workspace/unetformer/GeoSeg/geoseg/datasets/potsdam_dataset.py", line 99, in get_img_ids
    img_filename_list = os.listdir(osp.join(data_root, img_dir))
FileNotFoundError: [Errno 2] No such file or directory: 'data/potsdam/test/images'

  | Name | Type           | Params
----------------------------------------
0 | net  | UNetFormer     | 11.7 M
1 | loss | UnetFormerLoss | 0     
----------------------------------------
11.7 M    Trainable params
0         Non-trainable params
11.7 M    Total params
46.900    Total estimated model params size (MB)
/disk1/lhl/env/airs/lib/python3.8/site-packages/torch/functional.py:478: UserWarning:

torch.meshgrid: in an upcoming release, it will be required to pass the indexing argument. (Triggered internally at  /opt/conda/conda-bld/pytorch_1659484657607/work/aten/src/ATen/native/TensorShape.cpp:2895.)

Traceback (most recent call last):
  File "./potsdam_test.py", line 134, in <module>
    main()
  File "./potsdam_test.py", line 66, in main
    config = py2cfg(args.config_path)
  File "/disk1/lhl/workspace/unetformer/GeoSeg/tools/cfg.py", line 67, in py2cfg
    cfg_dict = py2dict(file_path)
  File "/disk1/lhl/workspace/unetformer/GeoSeg/tools/cfg.py", line 59, in py2dict
    mod = import_module(module_name)
  File "/disk1/lhl/env/airs/lib/python3.8/importlib/__init__.py", line 127, in import_module
    return _bootstrap._gcd_import(name[level:], package, level)
  File "<frozen importlib._bootstrap>", line 1014, in _gcd_import
  File "<frozen importlib._bootstrap>", line 991, in _find_and_load
  File "<frozen importlib._bootstrap>", line 975, in _find_and_load_unlocked
  File "<frozen importlib._bootstrap>", line 671, in _load_unlocked
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/disk1/lhl/workspace/unetformer/GeoSeg/config/potsdam/unetformer.py", line 49, in <module>
    val_dataset = PotsdamDataset(transform=val_aug)
  File "/disk1/lhl/workspace/unetformer/GeoSeg/geoseg/datasets/potsdam_dataset.py", line 76, in __init__
    self.img_ids = self.get_img_ids(self.data_root, self.img_dir, self.mask_dir)
  File "/disk1/lhl/workspace/unetformer/GeoSeg/geoseg/datasets/potsdam_dataset.py", line 99, in get_img_ids
    img_filename_list = os.listdir(osp.join(data_root, img_dir))
FileNotFoundError: [Errno 2] No such file or directory: 'data/potsdam/test/images'
/disk1/lhl/env/airs/lib/python3.8/site-packages/pytorch_lightning/trainer/data_loading.py:132: UserWarning:

The dataloader, val_dataloader 0, does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` (try 16 which is the number of cpus on this machine) in the `DataLoader` init to improve performance.

/disk1/lhl/workspace/unetformer/GeoSeg/tools/metric.py:31: RuntimeWarning:

invalid value encountered in divide

/disk1/lhl/env/airs/lib/python3.8/site-packages/pytorch_lightning/trainer/data_loading.py:132: UserWarning:

The dataloader, train_dataloader, does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` (try 16 which is the number of cpus on this machine) in the `DataLoader` init to improve performance.

/disk1/lhl/env/airs/lib/python3.8/site-packages/pytorch_lightning/trainer/data_loading.py:432: UserWarning:

The number of training samples (46) is smaller than the logging interval Trainer(log_every_n_steps=50). Set a lower value for log_every_n_steps if you want to see logs for the training epoch.

Killed
usage: vaihingen_test.py [-h] -c CONFIG_PATH -o OUTPUT_PATH [-t {None,d4,lr}]
                         [--rgb]
vaihingen_test.py: error: argument -t/--tta: invalid choice: 'none' (choose from None, 'd4', 'lr')
/disk1/lhl/env/airs/lib/python3.8/site-packages/torch/functional.py:478: UserWarning:

torch.meshgrid: in an upcoming release, it will be required to pass the indexing argument. (Triggered internally at  /opt/conda/conda-bld/pytorch_1659484657607/work/aten/src/ATen/native/TensorShape.cpp:2895.)

Traceback (most recent call last):
  File "./vaihingen_test.py", line 133, in <module>
    main()
  File "./vaihingen_test.py", line 67, in main
    model = Supervision_Train.load_from_checkpoint(os.path.join(config.weights_path, config.test_weights_name+'.ckpt'), config=config)
  File "/disk1/lhl/env/airs/lib/python3.8/site-packages/pytorch_lightning/core/saving.py", line 134, in load_from_checkpoint
    checkpoint = pl_load(checkpoint_path, map_location=lambda storage, loc: storage)
  File "/disk1/lhl/env/airs/lib/python3.8/site-packages/pytorch_lightning/utilities/cloud_io.py", line 37, in load
    with fs.open(path_or_url, "rb") as f:
  File "/disk1/lhl/env/airs/lib/python3.8/site-packages/fsspec/spec.py", line 1034, in open
    f = self._open(
  File "/disk1/lhl/env/airs/lib/python3.8/site-packages/fsspec/implementations/local.py", line 162, in _open
    return LocalFileOpener(path, mode, fs=self, **kwargs)
  File "/disk1/lhl/env/airs/lib/python3.8/site-packages/fsspec/implementations/local.py", line 260, in __init__
    self._open()
  File "/disk1/lhl/env/airs/lib/python3.8/site-packages/fsspec/implementations/local.py", line 265, in _open
    self.f = open(self.path, mode=self.mode)
FileNotFoundError: [Errno 2] No such file or directory: '/disk1/lhl/workspace/unetformer/GeoSeg/model_weights/vaihingen/unetformer-r18-1024crop512-ms-e100/unetformer-r18-1024crop512-ms-e100.ckpt'
/disk1/lhl/env/airs/lib/python3.8/site-packages/torch/functional.py:478: UserWarning:

torch.meshgrid: in an upcoming release, it will be required to pass the indexing argument. (Triggered internally at  /opt/conda/conda-bld/pytorch_1659484657607/work/aten/src/ATen/native/TensorShape.cpp:2895.)

Traceback (most recent call last):
  File "./vaihingen_test.py", line 133, in <module>
    main()
  File "./vaihingen_test.py", line 67, in main
    model = Supervision_Train.load_from_checkpoint(os.path.join(config.weights_path, config.test_weights_name+'.ckpt'), config=config)
  File "/disk1/lhl/env/airs/lib/python3.8/site-packages/pytorch_lightning/core/saving.py", line 134, in load_from_checkpoint
    checkpoint = pl_load(checkpoint_path, map_location=lambda storage, loc: storage)
  File "/disk1/lhl/env/airs/lib/python3.8/site-packages/pytorch_lightning/utilities/cloud_io.py", line 37, in load
    with fs.open(path_or_url, "rb") as f:
  File "/disk1/lhl/env/airs/lib/python3.8/site-packages/fsspec/spec.py", line 1034, in open
    f = self._open(
  File "/disk1/lhl/env/airs/lib/python3.8/site-packages/fsspec/implementations/local.py", line 162, in _open
    return LocalFileOpener(path, mode, fs=self, **kwargs)
  File "/disk1/lhl/env/airs/lib/python3.8/site-packages/fsspec/implementations/local.py", line 260, in __init__
    self._open()
  File "/disk1/lhl/env/airs/lib/python3.8/site-packages/fsspec/implementations/local.py", line 265, in _open
    self.f = open(self.path, mode=self.mode)
FileNotFoundError: [Errno 2] No such file or directory: '/disk1/lhl/workspace/unetformer/GeoSeg/model_weights/vaihingen/unetformer-r18-1024crop512-ms-e100/unetformer-r18-1024crop512-ms-e100.ckpt'
/disk1/lhl/env/airs/lib/python3.8/site-packages/torch/functional.py:478: UserWarning:

torch.meshgrid: in an upcoming release, it will be required to pass the indexing argument. (Triggered internally at  /opt/conda/conda-bld/pytorch_1659484657607/work/aten/src/ATen/native/TensorShape.cpp:2895.)

GPU available: True, used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0,1,2]
/disk1/lhl/env/airs/lib/python3.8/site-packages/torch/functional.py:478: UserWarning:

torch.meshgrid: in an upcoming release, it will be required to pass the indexing argument. (Triggered internally at  /opt/conda/conda-bld/pytorch_1659484657607/work/aten/src/ATen/native/TensorShape.cpp:2895.)

Traceback (most recent call last):
  File "./train_supervision.py", line 201, in <module>
    main()
  File "./train_supervision.py", line 180, in main
    config = py2cfg(args.config_path)
  File "/disk1/lhl/workspace/unetformer/GeoSeg/tools/cfg.py", line 67, in py2cfg
    cfg_dict = py2dict(file_path)
  File "/disk1/lhl/workspace/unetformer/GeoSeg/tools/cfg.py", line 59, in py2dict
    mod = import_module(module_name)
  File "/disk1/lhl/env/airs/lib/python3.8/importlib/__init__.py", line 127, in import_module
    return _bootstrap._gcd_import(name[level:], package, level)
  File "<frozen importlib._bootstrap>", line 1014, in _gcd_import
  File "<frozen importlib._bootstrap>", line 991, in _find_and_load
  File "<frozen importlib._bootstrap>", line 975, in _find_and_load_unlocked
  File "<frozen importlib._bootstrap>", line 671, in _load_unlocked
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/disk1/lhl/workspace/unetformer/GeoSeg/config/potsdam/unetformer.py", line 49, in <module>
    val_dataset = PotsdamDataset(transform=val_aug)
  File "/disk1/lhl/workspace/unetformer/GeoSeg/geoseg/datasets/potsdam_dataset.py", line 76, in __init__
    self.img_ids = self.get_img_ids(self.data_root, self.img_dir, self.mask_dir)
  File "/disk1/lhl/workspace/unetformer/GeoSeg/geoseg/datasets/potsdam_dataset.py", line 99, in get_img_ids
    img_filename_list = os.listdir(osp.join(data_root, img_dir))
FileNotFoundError: [Errno 2] No such file or directory: 'data/potsdam/test/images'

  | Name | Type           | Params
----------------------------------------
0 | net  | UNetFormer     | 11.7 M
1 | loss | UnetFormerLoss | 0     
----------------------------------------
11.7 M    Trainable params
0         Non-trainable params
11.7 M    Total params
46.900    Total estimated model params size (MB)
usage: potsdam_test.py [-h] -c CONFIG_PATH -o OUTPUT_PATH [-t {None,d4,lr}]
                       [--rgb]
potsdam_test.py: error: argument -t/--tta: invalid choice: 'none' (choose from None, 'd4', 'lr')
/disk1/lhl/env/airs/lib/python3.8/site-packages/pytorch_lightning/trainer/data_loading.py:132: UserWarning:

The dataloader, val_dataloader 0, does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` (try 16 which is the number of cpus on this machine) in the `DataLoader` init to improve performance.

/disk1/lhl/env/airs/lib/python3.8/site-packages/pytorch_lightning/trainer/data_loading.py:132: UserWarning:

The dataloader, train_dataloader, does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` (try 16 which is the number of cpus on this machine) in the `DataLoader` init to improve performance.

/disk1/lhl/env/airs/lib/python3.8/site-packages/pytorch_lightning/trainer/data_loading.py:432: UserWarning:

The number of training samples (46) is smaller than the logging interval Trainer(log_every_n_steps=50). Set a lower value for log_every_n_steps if you want to see logs for the training epoch.

/disk1/lhl/env/airs/lib/python3.8/site-packages/torch/functional.py:478: UserWarning:

torch.meshgrid: in an upcoming release, it will be required to pass the indexing argument. (Triggered internally at  /opt/conda/conda-bld/pytorch_1659484657607/work/aten/src/ATen/native/TensorShape.cpp:2895.)

Traceback (most recent call last):
  File "./potsdam_test.py", line 134, in <module>
    main()
  File "./potsdam_test.py", line 66, in main
    config = py2cfg(args.config_path)
  File "/disk1/lhl/workspace/unetformer/GeoSeg/tools/cfg.py", line 67, in py2cfg
    cfg_dict = py2dict(file_path)
  File "/disk1/lhl/workspace/unetformer/GeoSeg/tools/cfg.py", line 59, in py2dict
    mod = import_module(module_name)
  File "/disk1/lhl/env/airs/lib/python3.8/importlib/__init__.py", line 127, in import_module
    return _bootstrap._gcd_import(name[level:], package, level)
  File "<frozen importlib._bootstrap>", line 1014, in _gcd_import
  File "<frozen importlib._bootstrap>", line 991, in _find_and_load
  File "<frozen importlib._bootstrap>", line 975, in _find_and_load_unlocked
  File "<frozen importlib._bootstrap>", line 671, in _load_unlocked
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/disk1/lhl/workspace/unetformer/GeoSeg/config/potsdam/unetformer.py", line 49, in <module>
    val_dataset = PotsdamDataset(transform=val_aug)
  File "/disk1/lhl/workspace/unetformer/GeoSeg/geoseg/datasets/potsdam_dataset.py", line 76, in __init__
    self.img_ids = self.get_img_ids(self.data_root, self.img_dir, self.mask_dir)
  File "/disk1/lhl/workspace/unetformer/GeoSeg/geoseg/datasets/potsdam_dataset.py", line 99, in get_img_ids
    img_filename_list = os.listdir(osp.join(data_root, img_dir))
FileNotFoundError: [Errno 2] No such file or directory: 'data/potsdam/test/images'
/disk1/lhl/env/airs/lib/python3.8/site-packages/torch/functional.py:478: UserWarning:

torch.meshgrid: in an upcoming release, it will be required to pass the indexing argument. (Triggered internally at  /opt/conda/conda-bld/pytorch_1659484657607/work/aten/src/ATen/native/TensorShape.cpp:2895.)

Traceback (most recent call last):
  File "./potsdam_test.py", line 134, in <module>
    main()
  File "./potsdam_test.py", line 66, in main
    config = py2cfg(args.config_path)
  File "/disk1/lhl/workspace/unetformer/GeoSeg/tools/cfg.py", line 67, in py2cfg
    cfg_dict = py2dict(file_path)
  File "/disk1/lhl/workspace/unetformer/GeoSeg/tools/cfg.py", line 59, in py2dict
    mod = import_module(module_name)
  File "/disk1/lhl/env/airs/lib/python3.8/importlib/__init__.py", line 127, in import_module
    return _bootstrap._gcd_import(name[level:], package, level)
  File "<frozen importlib._bootstrap>", line 1014, in _gcd_import
  File "<frozen importlib._bootstrap>", line 991, in _find_and_load
  File "<frozen importlib._bootstrap>", line 975, in _find_and_load_unlocked
  File "<frozen importlib._bootstrap>", line 671, in _load_unlocked
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/disk1/lhl/workspace/unetformer/GeoSeg/config/potsdam/unetformer.py", line 49, in <module>
    val_dataset = PotsdamDataset(transform=val_aug)
  File "/disk1/lhl/workspace/unetformer/GeoSeg/geoseg/datasets/potsdam_dataset.py", line 76, in __init__
    self.img_ids = self.get_img_ids(self.data_root, self.img_dir, self.mask_dir)
  File "/disk1/lhl/workspace/unetformer/GeoSeg/geoseg/datasets/potsdam_dataset.py", line 99, in get_img_ids
    img_filename_list = os.listdir(osp.join(data_root, img_dir))
FileNotFoundError: [Errno 2] No such file or directory: 'data/potsdam/test/images'
/disk1/lhl/env/airs/lib/python3.8/site-packages/torch/functional.py:478: UserWarning:

torch.meshgrid: in an upcoming release, it will be required to pass the indexing argument. (Triggered internally at  /opt/conda/conda-bld/pytorch_1659484657607/work/aten/src/ATen/native/TensorShape.cpp:2895.)

GPU available: True, used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0,1,2]

  | Name | Type           | Params
----------------------------------------
0 | net  | UNetFormer     | 11.7 M
1 | loss | UnetFormerLoss | 0     
----------------------------------------
11.7 M    Trainable params
0         Non-trainable params
11.7 M    Total params
46.900    Total estimated model params size (MB)
/disk1/lhl/env/airs/lib/python3.8/site-packages/pytorch_lightning/trainer/data_loading.py:132: UserWarning:

The dataloader, val_dataloader 0, does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` (try 16 which is the number of cpus on this machine) in the `DataLoader` init to improve performance.

/disk1/lhl/workspace/unetformer/GeoSeg/tools/metric.py:31: RuntimeWarning:

invalid value encountered in divide

/disk1/lhl/env/airs/lib/python3.8/site-packages/pytorch_lightning/trainer/data_loading.py:132: UserWarning:

The dataloader, train_dataloader, does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` (try 16 which is the number of cpus on this machine) in the `DataLoader` init to improve performance.

/disk1/lhl/workspace/unetformer/GeoSeg/tools/metric.py:29: RuntimeWarning:

invalid value encountered in divide

usage: vaihingen_test.py [-h] -c CONFIG_PATH -o OUTPUT_PATH [-t {None,d4,lr}]
                         [--rgb]
vaihingen_test.py: error: argument -t/--tta: invalid choice: 'none' (choose from None, 'd4', 'lr')
/disk1/lhl/env/airs/lib/python3.8/site-packages/torch/functional.py:478: UserWarning:

torch.meshgrid: in an upcoming release, it will be required to pass the indexing argument. (Triggered internally at  /opt/conda/conda-bld/pytorch_1659484657607/work/aten/src/ATen/native/TensorShape.cpp:2895.)

  0%|          | 0/113 [00:00<?, ?it/s]  1%|          | 1/113 [00:02<04:01,  2.16s/it]  2%|▏         | 2/113 [00:02<01:54,  1.03s/it]  3%|▎         | 3/113 [00:02<01:11,  1.54it/s]  4%|▎         | 4/113 [00:02<00:52,  2.08it/s]  4%|▍         | 5/113 [00:03<00:42,  2.57it/s]  5%|▌         | 6/113 [00:03<00:35,  3.01it/s]  6%|▌         | 7/113 [00:03<00:31,  3.32it/s]  7%|▋         | 8/113 [00:03<00:28,  3.70it/s]  8%|▊         | 9/113 [00:03<00:26,  3.99it/s]  9%|▉         | 10/113 [00:04<00:24,  4.23it/s] 10%|▉         | 11/113 [00:04<00:23,  4.30it/s] 11%|█         | 12/113 [00:04<00:22,  4.42it/s] 12%|█▏        | 13/113 [00:04<00:22,  4.47it/s] 12%|█▏        | 14/113 [00:04<00:22,  4.47it/s] 13%|█▎        | 15/113 [00:05<00:22,  4.33it/s] 14%|█▍        | 16/113 [00:05<00:21,  4.55it/s] 15%|█▌        | 17/113 [00:05<00:21,  4.50it/s] 16%|█▌        | 18/113 [00:05<00:21,  4.49it/s] 17%|█▋        | 19/113 [00:06<00:21,  4.45it/s] 18%|█▊        | 20/113 [00:06<00:20,  4.56it/s] 19%|█▊        | 21/113 [00:06<00:20,  4.47it/s] 19%|█▉        | 22/113 [00:06<00:20,  4.41it/s] 20%|██        | 23/113 [00:07<00:20,  4.40it/s] 21%|██        | 24/113 [00:07<00:20,  4.37it/s] 22%|██▏       | 25/113 [00:07<00:20,  4.40it/s] 23%|██▎       | 26/113 [00:07<00:18,  4.59it/s] 24%|██▍       | 27/113 [00:07<00:19,  4.36it/s] 25%|██▍       | 28/113 [00:08<00:18,  4.51it/s] 26%|██▌       | 29/113 [00:08<00:18,  4.48it/s] 27%|██▋       | 30/113 [00:08<00:17,  4.65it/s] 27%|██▋       | 31/113 [00:08<00:17,  4.78it/s] 28%|██▊       | 32/113 [00:08<00:16,  4.88it/s] 29%|██▉       | 33/113 [00:09<00:16,  4.74it/s] 30%|███       | 34/113 [00:09<00:17,  4.64it/s] 31%|███       | 35/113 [00:09<00:16,  4.59it/s] 32%|███▏      | 36/113 [00:09<00:17,  4.51it/s] 33%|███▎      | 37/113 [00:10<00:16,  4.61it/s] 34%|███▎      | 38/113 [00:10<00:16,  4.52it/s] 35%|███▍      | 39/113 [00:10<00:16,  4.60it/s] 35%|███▌      | 40/113 [00:10<00:15,  4.58it/s] 36%|███▋      | 41/113 [00:10<00:15,  4.68it/s] 37%|███▋      | 42/113 [00:11<00:15,  4.64it/s] 38%|███▊      | 43/113 [00:11<00:14,  4.68it/s] 39%|███▉      | 44/113 [00:11<00:14,  4.66it/s] 40%|███▉      | 45/113 [00:11<00:15,  4.49it/s] 41%|████      | 46/113 [00:12<00:15,  4.44it/s] 42%|████▏     | 47/113 [00:12<00:14,  4.43it/s] 42%|████▏     | 48/113 [00:12<00:14,  4.55it/s] 43%|████▎     | 49/113 [00:12<00:13,  4.62it/s] 44%|████▍     | 50/113 [00:12<00:14,  4.46it/s] 45%|████▌     | 51/113 [00:13<00:14,  4.39it/s] 46%|████▌     | 52/113 [00:13<00:14,  4.32it/s] 47%|████▋     | 53/113 [00:13<00:13,  4.42it/s] 48%|████▊     | 54/113 [00:13<00:14,  4.18it/s] 49%|████▊     | 55/113 [00:14<00:13,  4.35it/s] 50%|████▉     | 56/113 [00:14<00:12,  4.39it/s] 50%|█████     | 57/113 [00:14<00:12,  4.34it/s] 51%|█████▏    | 58/113 [00:14<00:12,  4.49it/s] 52%|█████▏    | 59/113 [00:14<00:12,  4.43it/s] 53%|█████▎    | 60/113 [00:15<00:11,  4.42it/s] 54%|█████▍    | 61/113 [00:15<00:12,  4.32it/s] 55%|█████▍    | 62/113 [00:15<00:12,  4.23it/s] 56%|█████▌    | 63/113 [00:15<00:11,  4.27it/s] 57%|█████▋    | 64/113 [00:16<00:11,  4.27it/s] 58%|█████▊    | 65/113 [00:16<00:10,  4.41it/s] 58%|█████▊    | 66/113 [00:16<00:10,  4.34it/s] 59%|█████▉    | 67/113 [00:16<00:10,  4.35it/s] 60%|██████    | 68/113 [00:17<00:10,  4.49it/s] 61%|██████    | 69/113 [00:17<00:09,  4.52it/s] 62%|██████▏   | 70/113 [00:17<00:09,  4.61it/s] 63%|██████▎   | 71/113 [00:17<00:09,  4.54it/s] 64%|██████▎   | 72/113 [00:17<00:09,  4.48it/s] 65%|██████▍   | 73/113 [00:18<00:08,  4.56it/s] 65%|██████▌   | 74/113 [00:18<00:08,  4.47it/s] 66%|██████▋   | 75/113 [00:18<00:08,  4.54it/s] 67%|██████▋   | 76/113 [00:18<00:08,  4.47it/s] 68%|██████▊   | 77/113 [00:19<00:08,  4.42it/s] 69%|██████▉   | 78/113 [00:19<00:07,  4.39it/s] 70%|██████▉   | 79/113 [00:19<00:07,  4.59it/s] 71%|███████   | 80/113 [00:19<00:07,  4.63it/s] 72%|███████▏  | 81/113 [00:19<00:06,  4.71it/s] 73%|███████▎  | 82/113 [00:20<00:06,  4.91it/s] 73%|███████▎  | 83/113 [00:20<00:06,  4.73it/s] 74%|███████▍  | 84/113 [00:20<00:06,  4.61it/s] 75%|███████▌  | 85/113 [00:20<00:06,  4.53it/s] 76%|███████▌  | 86/113 [00:21<00:06,  4.32it/s] 77%|███████▋  | 87/113 [00:21<00:06,  4.30it/s] 78%|███████▊  | 88/113 [00:21<00:05,  4.28it/s] 79%|███████▉  | 89/113 [00:21<00:05,  4.41it/s] 80%|███████▉  | 90/113 [00:21<00:05,  4.53it/s] 81%|████████  | 91/113 [00:22<00:05,  4.35it/s] 81%|████████▏ | 92/113 [00:22<00:04,  4.33it/s] 82%|████████▏ | 93/113 [00:22<00:04,  4.39it/s] 83%|████████▎ | 94/113 [00:22<00:04,  4.36it/s] 84%|████████▍ | 95/113 [00:23<00:04,  4.35it/s] 85%|████████▍ | 96/113 [00:23<00:03,  4.52it/s] 86%|████████▌ | 97/113 [00:23<00:03,  4.49it/s] 87%|████████▋ | 98/113 [00:23<00:03,  4.49it/s] 88%|████████▊ | 99/113 [00:23<00:03,  4.42it/s] 88%|████████▊ | 100/113 [00:24<00:02,  4.40it/s] 89%|████████▉ | 101/113 [00:24<00:02,  4.46it/s] 90%|█████████ | 102/113 [00:24<00:02,  4.45it/s] 91%|█████████ | 103/113 [00:24<00:02,  4.37it/s] 92%|█████████▏| 104/113 [00:25<00:02,  4.42it/s] 93%|█████████▎| 105/113 [00:25<00:01,  4.51it/s] 94%|█████████▍| 106/113 [00:25<00:01,  4.50it/s] 95%|█████████▍| 107/113 [00:25<00:01,  4.52it/s] 96%|█████████▌| 108/113 [00:25<00:01,  4.52it/s] 96%|█████████▋| 109/113 [00:26<00:00,  4.61it/s] 97%|█████████▋| 110/113 [00:26<00:00,  4.55it/s] 98%|█████████▊| 111/113 [00:26<00:00,  4.49it/s] 99%|█████████▉| 112/113 [00:26<00:00,  4.55it/s]100%|██████████| 113/113 [00:27<00:00,  4.52it/s]100%|██████████| 113/113 [00:27<00:00,  4.17it/s]
/disk1/lhl/env/airs/lib/python3.8/site-packages/torch/functional.py:478: UserWarning:

torch.meshgrid: in an upcoming release, it will be required to pass the indexing argument. (Triggered internally at  /opt/conda/conda-bld/pytorch_1659484657607/work/aten/src/ATen/native/TensorShape.cpp:2895.)

  0%|          | 0/113 [00:00<?, ?it/s]  1%|          | 1/113 [00:03<06:37,  3.55s/it]  2%|▏         | 2/113 [00:04<03:24,  1.84s/it]  3%|▎         | 3/113 [00:04<02:20,  1.28s/it]  4%|▎         | 4/113 [00:05<01:51,  1.03s/it]  4%|▍         | 5/113 [00:06<01:36,  1.12it/s]  5%|▌         | 6/113 [00:06<01:26,  1.24it/s]  6%|▌         | 7/113 [00:07<01:20,  1.32it/s]  7%|▋         | 8/113 [00:08<01:14,  1.41it/s]  8%|▊         | 9/113 [00:08<01:10,  1.47it/s]  9%|▉         | 10/113 [00:09<01:08,  1.50it/s] 10%|▉         | 11/113 [00:09<01:07,  1.52it/s] 11%|█         | 12/113 [00:10<01:05,  1.54it/s] 12%|█▏        | 13/113 [00:11<01:04,  1.56it/s] 12%|█▏        | 14/113 [00:11<01:03,  1.56it/s] 13%|█▎        | 15/113 [00:12<01:02,  1.56it/s] 14%|█▍        | 16/113 [00:13<01:01,  1.58it/s] 15%|█▌        | 17/113 [00:13<01:01,  1.56it/s] 16%|█▌        | 18/113 [00:14<01:01,  1.56it/s] 17%|█▋        | 19/113 [00:14<01:00,  1.56it/s] 18%|█▊        | 20/113 [00:15<00:59,  1.57it/s] 19%|█▊        | 21/113 [00:16<00:58,  1.56it/s] 19%|█▉        | 22/113 [00:16<00:58,  1.56it/s] 20%|██        | 23/113 [00:17<00:57,  1.58it/s] 21%|██        | 24/113 [00:18<00:57,  1.56it/s] 22%|██▏       | 25/113 [00:18<00:56,  1.56it/s] 23%|██▎       | 26/113 [00:19<00:54,  1.58it/s] 24%|██▍       | 27/113 [00:20<00:54,  1.58it/s] 25%|██▍       | 28/113 [00:20<00:53,  1.59it/s] 26%|██▌       | 29/113 [00:21<00:53,  1.57it/s] 27%|██▋       | 30/113 [00:21<00:52,  1.58it/s] 27%|██▋       | 31/113 [00:22<00:51,  1.59it/s] 28%|██▊       | 32/113 [00:23<00:50,  1.62it/s] 29%|██▉       | 33/113 [00:23<00:50,  1.60it/s] 30%|███       | 34/113 [00:24<00:49,  1.59it/s] 31%|███       | 35/113 [00:25<00:49,  1.58it/s] 32%|███▏      | 36/113 [00:25<00:49,  1.57it/s] 33%|███▎      | 37/113 [00:26<00:48,  1.55it/s] 34%|███▎      | 38/113 [00:27<00:49,  1.52it/s] 35%|███▍      | 39/113 [00:27<00:48,  1.52it/s] 35%|███▌      | 40/113 [00:28<00:47,  1.53it/s] 36%|███▋      | 41/113 [00:29<00:47,  1.53it/s] 37%|███▋      | 42/113 [00:29<00:46,  1.52it/s] 38%|███▊      | 43/113 [00:30<00:46,  1.50it/s] 39%|███▉      | 44/113 [00:31<00:46,  1.50it/s] 40%|███▉      | 45/113 [00:31<00:45,  1.49it/s] 41%|████      | 46/113 [00:32<00:45,  1.48it/s] 42%|████▏     | 47/113 [00:33<00:44,  1.50it/s] 42%|████▏     | 48/113 [00:33<00:43,  1.49it/s] 43%|████▎     | 49/113 [00:34<00:42,  1.49it/s] 44%|████▍     | 50/113 [00:35<00:42,  1.47it/s] 45%|████▌     | 51/113 [00:35<00:42,  1.47it/s] 46%|████▌     | 52/113 [00:36<00:41,  1.47it/s] 47%|████▋     | 53/113 [00:37<00:39,  1.51it/s] 48%|████▊     | 54/113 [00:37<00:39,  1.51it/s] 49%|████▊     | 55/113 [00:38<00:37,  1.53it/s] 50%|████▉     | 56/113 [00:39<00:37,  1.50it/s] 50%|█████     | 57/113 [00:39<00:37,  1.48it/s] 51%|█████▏    | 58/113 [00:40<00:36,  1.50it/s] 52%|█████▏    | 59/113 [00:41<00:36,  1.49it/s] 53%|█████▎    | 60/113 [00:41<00:35,  1.49it/s] 54%|█████▍    | 61/113 [00:42<00:35,  1.48it/s] 55%|█████▍    | 62/113 [00:43<00:34,  1.49it/s] 56%|█████▌    | 63/113 [00:43<00:33,  1.48it/s] 57%|█████▋    | 64/113 [00:44<00:33,  1.47it/s] 58%|█████▊    | 65/113 [00:45<00:31,  1.51it/s] 58%|█████▊    | 66/113 [00:45<00:30,  1.52it/s] 59%|█████▉    | 67/113 [00:46<00:30,  1.48it/s] 60%|██████    | 68/113 [00:47<00:30,  1.48it/s] 61%|██████    | 69/113 [00:47<00:30,  1.46it/s] 62%|██████▏   | 70/113 [00:48<00:29,  1.47it/s] 63%|██████▎   | 71/113 [00:49<00:28,  1.48it/s] 64%|██████▎   | 72/113 [00:49<00:27,  1.50it/s] 65%|██████▍   | 73/113 [00:50<00:27,  1.46it/s] 65%|██████▌   | 74/113 [00:51<00:26,  1.46it/s] 66%|██████▋   | 75/113 [00:51<00:25,  1.47it/s] 67%|██████▋   | 76/113 [00:52<00:25,  1.47it/s] 68%|██████▊   | 77/113 [00:53<00:24,  1.44it/s] 69%|██████▉   | 78/113 [00:54<00:23,  1.47it/s] 70%|██████▉   | 79/113 [00:54<00:22,  1.48it/s] 71%|███████   | 80/113 [00:55<00:22,  1.49it/s] 72%|███████▏  | 81/113 [00:55<00:20,  1.53it/s] 73%|███████▎  | 82/113 [00:56<00:19,  1.56it/s] 73%|███████▎  | 83/113 [00:57<00:19,  1.55it/s] 74%|███████▍  | 84/113 [00:57<00:18,  1.55it/s] 75%|███████▌  | 85/113 [00:58<00:18,  1.52it/s] 76%|███████▌  | 86/113 [00:59<00:18,  1.50it/s] 77%|███████▋  | 87/113 [00:59<00:17,  1.51it/s] 78%|███████▊  | 88/113 [01:00<00:16,  1.52it/s] 79%|███████▉  | 89/113 [01:01<00:16,  1.50it/s] 80%|███████▉  | 90/113 [01:01<00:15,  1.49it/s] 81%|████████  | 91/113 [01:02<00:14,  1.48it/s] 81%|████████▏ | 92/113 [01:03<00:14,  1.47it/s] 82%|████████▏ | 93/113 [01:04<00:13,  1.43it/s] 83%|████████▎ | 94/113 [01:04<00:13,  1.43it/s] 84%|████████▍ | 95/113 [01:05<00:12,  1.42it/s] 85%|████████▍ | 96/113 [01:06<00:11,  1.45it/s] 86%|████████▌ | 97/113 [01:06<00:11,  1.44it/s] 87%|████████▋ | 98/113 [01:07<00:10,  1.44it/s] 88%|████████▊ | 99/113 [01:08<00:09,  1.43it/s] 88%|████████▊ | 100/113 [01:08<00:09,  1.43it/s] 89%|████████▉ | 101/113 [01:09<00:08,  1.43it/s] 90%|█████████ | 102/113 [01:10<00:07,  1.43it/s] 91%|█████████ | 103/113 [01:10<00:06,  1.45it/s] 92%|█████████▏| 104/113 [01:11<00:06,  1.44it/s] 93%|█████████▎| 105/113 [01:12<00:05,  1.45it/s] 94%|█████████▍| 106/113 [01:13<00:04,  1.46it/s] 95%|█████████▍| 107/113 [01:13<00:04,  1.46it/s] 96%|█████████▌| 108/113 [01:14<00:03,  1.45it/s] 96%|█████████▋| 109/113 [01:15<00:02,  1.46it/s] 97%|█████████▋| 110/113 [01:15<00:02,  1.46it/s] 98%|█████████▊| 111/113 [01:16<00:01,  1.45it/s] 99%|█████████▉| 112/113 [01:17<00:00,  1.49it/s]100%|██████████| 113/113 [01:17<00:00,  1.48it/s]100%|██████████| 113/113 [01:17<00:00,  1.45it/s]
GPU available: True, used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0,1,2]

  | Name | Type            | Params
-----------------------------------------
0 | net  | HRNet_W48_Proto | 44.9 M
1 | loss | FSAuxCELoss     | 0     
-----------------------------------------
44.9 M    Trainable params
0         Non-trainable params
44.9 M    Total params
179.447   Total estimated model params size (MB)
Traceback (most recent call last):
  File "./train_hrnet.py", line 206, in <module>
    main()
  File "./train_hrnet.py", line 202, in main
    trainer.fit(model=model)
  File "/disk1/lhl/env/airs/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 740, in fit
    self._call_and_handle_interrupt(
  File "/disk1/lhl/env/airs/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 685, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "/disk1/lhl/env/airs/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 777, in _fit_impl
    self._run(model, ckpt_path=ckpt_path)
  File "/disk1/lhl/env/airs/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1199, in _run
    self._dispatch()
  File "/disk1/lhl/env/airs/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1279, in _dispatch
    self.training_type_plugin.start_training(self)
  File "/disk1/lhl/env/airs/lib/python3.8/site-packages/pytorch_lightning/plugins/training_type/training_type_plugin.py", line 202, in start_training
    self._results = trainer.run_stage()
  File "/disk1/lhl/env/airs/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1289, in run_stage
    return self._run_train()
  File "/disk1/lhl/env/airs/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1311, in _run_train
    self._run_sanity_check(self.lightning_module)
  File "/disk1/lhl/env/airs/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1375, in _run_sanity_check
    self._evaluation_loop.run()
  File "/disk1/lhl/env/airs/lib/python3.8/site-packages/pytorch_lightning/loops/base.py", line 145, in run
    self.advance(*args, **kwargs)
  File "/disk1/lhl/env/airs/lib/python3.8/site-packages/pytorch_lightning/loops/dataloader/evaluation_loop.py", line 110, in advance
    dl_outputs = self.epoch_loop.run(dataloader, dataloader_idx, dl_max_batches, self.num_dataloaders)
  File "/disk1/lhl/env/airs/lib/python3.8/site-packages/pytorch_lightning/loops/base.py", line 145, in run
    self.advance(*args, **kwargs)
  File "/disk1/lhl/env/airs/lib/python3.8/site-packages/pytorch_lightning/loops/epoch/evaluation_epoch_loop.py", line 122, in advance
    output = self._evaluation_step(batch, batch_idx, dataloader_idx)
  File "/disk1/lhl/env/airs/lib/python3.8/site-packages/pytorch_lightning/loops/epoch/evaluation_epoch_loop.py", line 217, in _evaluation_step
    output = self.trainer.accelerator.validation_step(step_kwargs)
  File "/disk1/lhl/env/airs/lib/python3.8/site-packages/pytorch_lightning/accelerators/accelerator.py", line 236, in validation_step
    return self.training_type_plugin.validation_step(*step_kwargs.values())
  File "/disk1/lhl/env/airs/lib/python3.8/site-packages/pytorch_lightning/plugins/training_type/training_type_plugin.py", line 219, in validation_step
    return self.model.validation_step(*args, **kwargs)
  File "./train_hrnet.py", line 119, in validation_step
    prediction = self.forward(img)
  File "./train_hrnet.py", line 46, in forward
    seg_pre = self.net(x)
  File "/disk1/lhl/env/airs/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1130, in _call_impl
    return forward_call(*input, **kwargs)
  File "/disk1/lhl/workspace/unetformer/GeoSeg/geoseg/models/HRNet.py", line 149, in forward
    c = self.cls_head(feats)
  File "/disk1/lhl/env/airs/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1130, in _call_impl
    return forward_call(*input, **kwargs)
  File "/disk1/lhl/env/airs/lib/python3.8/site-packages/torch/nn/modules/container.py", line 139, in forward
    input = module(input)
  File "/disk1/lhl/env/airs/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1130, in _call_impl
    return forward_call(*input, **kwargs)
  File "/disk1/lhl/env/airs/lib/python3.8/site-packages/torch/nn/modules/conv.py", line 457, in forward
    return self._conv_forward(input, self.weight, self.bias)
  File "/disk1/lhl/env/airs/lib/python3.8/site-packages/torch/nn/modules/conv.py", line 453, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
RuntimeError: Given groups=1, weight of size [448, 448, 3, 3], expected input[1, 1024, 512, 512] to have 448 channels, but got 1024 channels instead
Traceback (most recent call last):
  File "./vaihingen_test.py", line 133, in <module>
    main()
  File "./vaihingen_test.py", line 67, in main
    model = Supervision_Train.load_from_checkpoint(os.path.join(config.weights_path, config.test_weights_name+'.ckpt'), config=config)
  File "/disk1/lhl/env/airs/lib/python3.8/site-packages/pytorch_lightning/core/saving.py", line 134, in load_from_checkpoint
    checkpoint = pl_load(checkpoint_path, map_location=lambda storage, loc: storage)
  File "/disk1/lhl/env/airs/lib/python3.8/site-packages/pytorch_lightning/utilities/cloud_io.py", line 37, in load
    with fs.open(path_or_url, "rb") as f:
  File "/disk1/lhl/env/airs/lib/python3.8/site-packages/fsspec/spec.py", line 1034, in open
    f = self._open(
  File "/disk1/lhl/env/airs/lib/python3.8/site-packages/fsspec/implementations/local.py", line 162, in _open
    return LocalFileOpener(path, mode, fs=self, **kwargs)
  File "/disk1/lhl/env/airs/lib/python3.8/site-packages/fsspec/implementations/local.py", line 260, in __init__
    self._open()
  File "/disk1/lhl/env/airs/lib/python3.8/site-packages/fsspec/implementations/local.py", line 265, in _open
    self.f = open(self.path, mode=self.mode)
FileNotFoundError: [Errno 2] No such file or directory: '/disk1/lhl/workspace/unetformer/GeoSeg/model_weights/vaihingen/hr18-r18-1024crop512-crop-ms-e100/hr18-r18-1024crop512-crop-ms-e100.ckpt'
Traceback (most recent call last):
  File "./vaihingen_test.py", line 133, in <module>
    main()
  File "./vaihingen_test.py", line 67, in main
    model = Supervision_Train.load_from_checkpoint(os.path.join(config.weights_path, config.test_weights_name+'.ckpt'), config=config)
  File "/disk1/lhl/env/airs/lib/python3.8/site-packages/pytorch_lightning/core/saving.py", line 134, in load_from_checkpoint
    checkpoint = pl_load(checkpoint_path, map_location=lambda storage, loc: storage)
  File "/disk1/lhl/env/airs/lib/python3.8/site-packages/pytorch_lightning/utilities/cloud_io.py", line 37, in load
    with fs.open(path_or_url, "rb") as f:
  File "/disk1/lhl/env/airs/lib/python3.8/site-packages/fsspec/spec.py", line 1034, in open
    f = self._open(
  File "/disk1/lhl/env/airs/lib/python3.8/site-packages/fsspec/implementations/local.py", line 162, in _open
    return LocalFileOpener(path, mode, fs=self, **kwargs)
  File "/disk1/lhl/env/airs/lib/python3.8/site-packages/fsspec/implementations/local.py", line 260, in __init__
    self._open()
  File "/disk1/lhl/env/airs/lib/python3.8/site-packages/fsspec/implementations/local.py", line 265, in _open
    self.f = open(self.path, mode=self.mode)
FileNotFoundError: [Errno 2] No such file or directory: '/disk1/lhl/workspace/unetformer/GeoSeg/model_weights/vaihingen/hr18-r18-1024crop512-crop-ms-e100/hr18-r18-1024crop512-crop-ms-e100.ckpt'
Traceback (most recent call last):
  File "./vaihingen_test.py", line 133, in <module>
    main()
  File "./vaihingen_test.py", line 67, in main
    model = Supervision_Train.load_from_checkpoint(os.path.join(config.weights_path, config.test_weights_name+'.ckpt'), config=config)
  File "/disk1/lhl/env/airs/lib/python3.8/site-packages/pytorch_lightning/core/saving.py", line 134, in load_from_checkpoint
    checkpoint = pl_load(checkpoint_path, map_location=lambda storage, loc: storage)
  File "/disk1/lhl/env/airs/lib/python3.8/site-packages/pytorch_lightning/utilities/cloud_io.py", line 37, in load
    with fs.open(path_or_url, "rb") as f:
  File "/disk1/lhl/env/airs/lib/python3.8/site-packages/fsspec/spec.py", line 1034, in open
    f = self._open(
  File "/disk1/lhl/env/airs/lib/python3.8/site-packages/fsspec/implementations/local.py", line 162, in _open
    return LocalFileOpener(path, mode, fs=self, **kwargs)
  File "/disk1/lhl/env/airs/lib/python3.8/site-packages/fsspec/implementations/local.py", line 260, in __init__
    self._open()
  File "/disk1/lhl/env/airs/lib/python3.8/site-packages/fsspec/implementations/local.py", line 265, in _open
    self.f = open(self.path, mode=self.mode)
FileNotFoundError: [Errno 2] No such file or directory: '/disk1/lhl/workspace/unetformer/GeoSeg/model_weights/vaihingen/hr18-r18-1024crop512-crop-ms-e100/hr18-r18-1024crop512-crop-ms-e100.ckpt'
GPU available: True, used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0,1,2]

  | Name | Type            | Params
-----------------------------------------
0 | net  | HRNet_W48_Proto | 44.9 M
1 | loss | FSAuxCELoss     | 0     
-----------------------------------------
44.9 M    Trainable params
0         Non-trainable params
44.9 M    Total params
179.447   Total estimated model params size (MB)
Traceback (most recent call last):
  File "./train_proto.py", line 206, in <module>
    main()
  File "./train_proto.py", line 202, in main
    trainer.fit(model=model)
  File "/disk1/lhl/env/airs/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 740, in fit
    self._call_and_handle_interrupt(
  File "/disk1/lhl/env/airs/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 685, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "/disk1/lhl/env/airs/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 777, in _fit_impl
    self._run(model, ckpt_path=ckpt_path)
  File "/disk1/lhl/env/airs/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1199, in _run
    self._dispatch()
  File "/disk1/lhl/env/airs/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1279, in _dispatch
    self.training_type_plugin.start_training(self)
  File "/disk1/lhl/env/airs/lib/python3.8/site-packages/pytorch_lightning/plugins/training_type/training_type_plugin.py", line 202, in start_training
    self._results = trainer.run_stage()
  File "/disk1/lhl/env/airs/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1289, in run_stage
    return self._run_train()
  File "/disk1/lhl/env/airs/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1311, in _run_train
    self._run_sanity_check(self.lightning_module)
  File "/disk1/lhl/env/airs/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1375, in _run_sanity_check
    self._evaluation_loop.run()
  File "/disk1/lhl/env/airs/lib/python3.8/site-packages/pytorch_lightning/loops/base.py", line 145, in run
    self.advance(*args, **kwargs)
  File "/disk1/lhl/env/airs/lib/python3.8/site-packages/pytorch_lightning/loops/dataloader/evaluation_loop.py", line 110, in advance
    dl_outputs = self.epoch_loop.run(dataloader, dataloader_idx, dl_max_batches, self.num_dataloaders)
  File "/disk1/lhl/env/airs/lib/python3.8/site-packages/pytorch_lightning/loops/base.py", line 145, in run
    self.advance(*args, **kwargs)
  File "/disk1/lhl/env/airs/lib/python3.8/site-packages/pytorch_lightning/loops/epoch/evaluation_epoch_loop.py", line 122, in advance
    output = self._evaluation_step(batch, batch_idx, dataloader_idx)
  File "/disk1/lhl/env/airs/lib/python3.8/site-packages/pytorch_lightning/loops/epoch/evaluation_epoch_loop.py", line 217, in _evaluation_step
    output = self.trainer.accelerator.validation_step(step_kwargs)
  File "/disk1/lhl/env/airs/lib/python3.8/site-packages/pytorch_lightning/accelerators/accelerator.py", line 236, in validation_step
    return self.training_type_plugin.validation_step(*step_kwargs.values())
  File "/disk1/lhl/env/airs/lib/python3.8/site-packages/pytorch_lightning/plugins/training_type/training_type_plugin.py", line 219, in validation_step
    return self.model.validation_step(*args, **kwargs)
  File "./train_proto.py", line 119, in validation_step
    prediction = self.forward(img)
  File "./train_proto.py", line 46, in forward
    seg_pre = self.net(x)
  File "/disk1/lhl/env/airs/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1130, in _call_impl
    return forward_call(*input, **kwargs)
  File "/disk1/lhl/workspace/unetformer/GeoSeg/geoseg/models/HRNet.py", line 149, in forward
    c = self.cls_head(feats)
  File "/disk1/lhl/env/airs/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1130, in _call_impl
    return forward_call(*input, **kwargs)
  File "/disk1/lhl/env/airs/lib/python3.8/site-packages/torch/nn/modules/container.py", line 139, in forward
    input = module(input)
  File "/disk1/lhl/env/airs/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1130, in _call_impl
    return forward_call(*input, **kwargs)
  File "/disk1/lhl/env/airs/lib/python3.8/site-packages/torch/nn/modules/conv.py", line 457, in forward
    return self._conv_forward(input, self.weight, self.bias)
  File "/disk1/lhl/env/airs/lib/python3.8/site-packages/torch/nn/modules/conv.py", line 453, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
RuntimeError: Given groups=1, weight of size [448, 448, 3, 3], expected input[1, 1024, 512, 512] to have 448 channels, but got 1024 channels instead
Traceback (most recent call last):
  File "./vaihingen_test.py", line 133, in <module>
    main()
  File "./vaihingen_test.py", line 67, in main
    model = Supervision_Train.load_from_checkpoint(os.path.join(config.weights_path, config.test_weights_name+'.ckpt'), config=config)
  File "/disk1/lhl/env/airs/lib/python3.8/site-packages/pytorch_lightning/core/saving.py", line 134, in load_from_checkpoint
    checkpoint = pl_load(checkpoint_path, map_location=lambda storage, loc: storage)
  File "/disk1/lhl/env/airs/lib/python3.8/site-packages/pytorch_lightning/utilities/cloud_io.py", line 37, in load
    with fs.open(path_or_url, "rb") as f:
  File "/disk1/lhl/env/airs/lib/python3.8/site-packages/fsspec/spec.py", line 1034, in open
    f = self._open(
  File "/disk1/lhl/env/airs/lib/python3.8/site-packages/fsspec/implementations/local.py", line 162, in _open
    return LocalFileOpener(path, mode, fs=self, **kwargs)
  File "/disk1/lhl/env/airs/lib/python3.8/site-packages/fsspec/implementations/local.py", line 260, in __init__
    self._open()
  File "/disk1/lhl/env/airs/lib/python3.8/site-packages/fsspec/implementations/local.py", line 265, in _open
    self.f = open(self.path, mode=self.mode)
FileNotFoundError: [Errno 2] No such file or directory: '/disk1/lhl/workspace/unetformer/GeoSeg/model_weights/vaihingen/hr18-r18-512-1024crop512-ms-e100-proto/hr18-r18-512-1024crop512-ms-e100-proto.ckpt'
Traceback (most recent call last):
  File "./vaihingen_test.py", line 133, in <module>
    main()
  File "./vaihingen_test.py", line 67, in main
    model = Supervision_Train.load_from_checkpoint(os.path.join(config.weights_path, config.test_weights_name+'.ckpt'), config=config)
  File "/disk1/lhl/env/airs/lib/python3.8/site-packages/pytorch_lightning/core/saving.py", line 134, in load_from_checkpoint
    checkpoint = pl_load(checkpoint_path, map_location=lambda storage, loc: storage)
  File "/disk1/lhl/env/airs/lib/python3.8/site-packages/pytorch_lightning/utilities/cloud_io.py", line 37, in load
    with fs.open(path_or_url, "rb") as f:
  File "/disk1/lhl/env/airs/lib/python3.8/site-packages/fsspec/spec.py", line 1034, in open
    f = self._open(
  File "/disk1/lhl/env/airs/lib/python3.8/site-packages/fsspec/implementations/local.py", line 162, in _open
    return LocalFileOpener(path, mode, fs=self, **kwargs)
  File "/disk1/lhl/env/airs/lib/python3.8/site-packages/fsspec/implementations/local.py", line 260, in __init__
    self._open()
  File "/disk1/lhl/env/airs/lib/python3.8/site-packages/fsspec/implementations/local.py", line 265, in _open
    self.f = open(self.path, mode=self.mode)
FileNotFoundError: [Errno 2] No such file or directory: '/disk1/lhl/workspace/unetformer/GeoSeg/model_weights/vaihingen/hr18-r18-512-1024crop512-ms-e100-proto/hr18-r18-512-1024crop512-ms-e100-proto.ckpt'
Traceback (most recent call last):
  File "./vaihingen_test.py", line 133, in <module>
    main()
  File "./vaihingen_test.py", line 67, in main
    model = Supervision_Train.load_from_checkpoint(os.path.join(config.weights_path, config.test_weights_name+'.ckpt'), config=config)
  File "/disk1/lhl/env/airs/lib/python3.8/site-packages/pytorch_lightning/core/saving.py", line 134, in load_from_checkpoint
    checkpoint = pl_load(checkpoint_path, map_location=lambda storage, loc: storage)
  File "/disk1/lhl/env/airs/lib/python3.8/site-packages/pytorch_lightning/utilities/cloud_io.py", line 37, in load
    with fs.open(path_or_url, "rb") as f:
  File "/disk1/lhl/env/airs/lib/python3.8/site-packages/fsspec/spec.py", line 1034, in open
    f = self._open(
  File "/disk1/lhl/env/airs/lib/python3.8/site-packages/fsspec/implementations/local.py", line 162, in _open
    return LocalFileOpener(path, mode, fs=self, **kwargs)
  File "/disk1/lhl/env/airs/lib/python3.8/site-packages/fsspec/implementations/local.py", line 260, in __init__
    self._open()
  File "/disk1/lhl/env/airs/lib/python3.8/site-packages/fsspec/implementations/local.py", line 265, in _open
    self.f = open(self.path, mode=self.mode)
FileNotFoundError: [Errno 2] No such file or directory: '/disk1/lhl/workspace/unetformer/GeoSeg/model_weights/vaihingen/hr18-r18-512-1024crop512-ms-e100-proto/hr18-r18-512-1024crop512-ms-e100-proto.ckpt'
GPU available: True, used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0,1,2]

  | Name | Type            | Params
-----------------------------------------
0 | net  | HRNet_W48_Proto | 54.2 M
1 | loss | FSAuxCELoss     | 0     
-----------------------------------------
54.2 M    Trainable params
0         Non-trainable params
54.2 M    Total params
216.908   Total estimated model params size (MB)
/disk1/lhl/env/airs/lib/python3.8/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:631: UserWarning:

Checkpoint directory /disk1/lhl/workspace/unetformer/GeoSeg/model_weights/vaihingen/hr18-r18-1024crop512-crop-ms-e100 exists and is not empty.

/disk1/lhl/env/airs/lib/python3.8/site-packages/torch/nn/_reduction.py:13: UserWarning:

reduction='elementwise_mean' is deprecated, please use reduction='mean' instead.

/disk1/lhl/workspace/unetformer/GeoSeg/tools/metric.py:29: RuntimeWarning:

invalid value encountered in divide

  0%|          | 0/113 [00:00<?, ?it/s]  1%|          | 1/113 [00:09<18:01,  9.65s/it]  2%|▏         | 2/113 [00:10<08:31,  4.61s/it]  3%|▎         | 3/113 [00:11<05:27,  2.97s/it]  4%|▎         | 4/113 [00:12<04:02,  2.22s/it]  4%|▍         | 5/113 [00:13<03:14,  1.80s/it]  5%|▌         | 6/113 [00:14<02:46,  1.55s/it]  6%|▌         | 7/113 [00:16<02:28,  1.40s/it]  7%|▋         | 8/113 [00:17<02:15,  1.29s/it]  8%|▊         | 9/113 [00:18<02:05,  1.21s/it]  9%|▉         | 10/113 [00:19<01:59,  1.16s/it] 10%|▉         | 11/113 [00:20<01:55,  1.13s/it] 11%|█         | 12/113 [00:21<01:52,  1.11s/it] 12%|█▏        | 13/113 [00:22<01:49,  1.10s/it] 12%|█▏        | 14/113 [00:23<01:47,  1.09s/it] 13%|█▎        | 15/113 [00:24<01:47,  1.09s/it] 14%|█▍        | 16/113 [00:25<01:44,  1.08s/it] 15%|█▌        | 17/113 [00:26<01:43,  1.08s/it] 16%|█▌        | 18/113 [00:27<01:42,  1.08s/it] 17%|█▋        | 19/113 [00:28<01:41,  1.08s/it] 18%|█▊        | 20/113 [00:29<01:41,  1.09s/it] 19%|█▊        | 21/113 [00:31<01:41,  1.10s/it] 19%|█▉        | 22/113 [00:32<01:40,  1.10s/it] 20%|██        | 23/113 [00:33<01:39,  1.10s/it] 21%|██        | 24/113 [00:34<01:37,  1.09s/it] 22%|██▏       | 25/113 [00:35<01:36,  1.09s/it] 23%|██▎       | 26/113 [00:36<01:34,  1.09s/it] 24%|██▍       | 27/113 [00:37<01:33,  1.09s/it] 25%|██▍       | 28/113 [00:38<01:32,  1.09s/it] 26%|██▌       | 29/113 [00:39<01:31,  1.10s/it] 27%|██▋       | 30/113 [00:40<01:30,  1.09s/it] 27%|██▋       | 31/113 [00:41<01:28,  1.08s/it] 28%|██▊       | 32/113 [00:42<01:26,  1.07s/it] 29%|██▉       | 33/113 [00:44<01:26,  1.08s/it] 30%|███       | 34/113 [00:45<01:25,  1.09s/it] 31%|███       | 35/113 [00:46<01:24,  1.09s/it] 32%|███▏      | 36/113 [00:47<01:25,  1.10s/it] 33%|███▎      | 37/113 [00:48<01:23,  1.10s/it] 34%|███▎      | 38/113 [00:49<01:23,  1.11s/it] 35%|███▍      | 39/113 [00:50<01:21,  1.10s/it] 35%|███▌      | 40/113 [00:51<01:19,  1.09s/it] 36%|███▋      | 41/113 [00:52<01:18,  1.09s/it] 37%|███▋      | 42/113 [00:53<01:18,  1.10s/it] 38%|███▊      | 43/113 [00:55<01:16,  1.09s/it] 39%|███▉      | 44/113 [00:56<01:15,  1.10s/it] 40%|███▉      | 45/113 [00:57<01:14,  1.10s/it] 41%|████      | 46/113 [00:58<01:13,  1.10s/it] 42%|████▏     | 47/113 [00:59<01:13,  1.11s/it] 42%|████▏     | 48/113 [01:00<01:10,  1.09s/it] 43%|████▎     | 49/113 [01:01<01:09,  1.08s/it] 44%|████▍     | 50/113 [01:02<01:08,  1.09s/it] 45%|████▌     | 51/113 [01:03<01:08,  1.10s/it] 46%|████▌     | 52/113 [01:04<01:07,  1.11s/it] 47%|████▋     | 53/113 [01:06<01:06,  1.11s/it] 48%|████▊     | 54/113 [01:07<01:05,  1.11s/it] 49%|████▊     | 55/113 [01:08<01:04,  1.11s/it] 50%|████▉     | 56/113 [01:09<01:02,  1.10s/it] 50%|█████     | 57/113 [01:10<01:02,  1.11s/it] 51%|█████▏    | 58/113 [01:11<01:00,  1.10s/it] 52%|█████▏    | 59/113 [01:12<00:59,  1.10s/it] 53%|█████▎    | 60/113 [01:13<00:58,  1.10s/it] 54%|█████▍    | 61/113 [01:14<00:56,  1.09s/it] 55%|█████▍    | 62/113 [01:16<00:57,  1.12s/it] 56%|█████▌    | 63/113 [01:17<00:57,  1.14s/it] 57%|█████▋    | 64/113 [01:18<00:55,  1.14s/it] 58%|█████▊    | 65/113 [01:19<00:54,  1.13s/it] 58%|█████▊    | 66/113 [01:20<00:52,  1.12s/it] 59%|█████▉    | 67/113 [01:21<00:51,  1.11s/it] 60%|██████    | 68/113 [01:22<00:49,  1.11s/it] 61%|██████    | 69/113 [01:23<00:49,  1.12s/it] 62%|██████▏   | 70/113 [01:25<00:48,  1.14s/it] 63%|██████▎   | 71/113 [01:26<00:47,  1.14s/it] 64%|██████▎   | 72/113 [01:27<00:46,  1.14s/it] 65%|██████▍   | 73/113 [01:28<00:45,  1.13s/it] 65%|██████▌   | 74/113 [01:29<00:43,  1.13s/it] 66%|██████▋   | 75/113 [01:30<00:41,  1.10s/it] 67%|██████▋   | 76/113 [01:31<00:41,  1.12s/it] 68%|██████▊   | 77/113 [01:33<00:41,  1.14s/it] 69%|██████▉   | 78/113 [01:34<00:39,  1.14s/it] 70%|██████▉   | 79/113 [01:35<00:38,  1.13s/it] 71%|███████   | 80/113 [01:36<00:36,  1.12s/it] 72%|███████▏  | 81/113 [01:37<00:35,  1.11s/it] 73%|███████▎  | 82/113 [01:38<00:33,  1.08s/it] 73%|███████▎  | 83/113 [01:39<00:33,  1.11s/it] 74%|███████▍  | 84/113 [01:40<00:33,  1.15s/it] 75%|███████▌  | 85/113 [01:41<00:31,  1.13s/it] 76%|███████▌  | 86/113 [01:43<00:30,  1.12s/it] 77%|███████▋  | 87/113 [01:44<00:29,  1.13s/it] 78%|███████▊  | 88/113 [01:45<00:28,  1.12s/it] 79%|███████▉  | 89/113 [01:46<00:26,  1.11s/it] 80%|███████▉  | 90/113 [01:47<00:25,  1.11s/it] 81%|████████  | 91/113 [01:48<00:24,  1.11s/it] 81%|████████▏ | 92/113 [01:49<00:23,  1.10s/it] 82%|████████▏ | 93/113 [01:50<00:22,  1.10s/it] 83%|████████▎ | 94/113 [01:51<00:21,  1.11s/it] 84%|████████▍ | 95/113 [01:53<00:20,  1.11s/it] 85%|████████▍ | 96/113 [01:54<00:18,  1.11s/it] 86%|████████▌ | 97/113 [01:55<00:17,  1.09s/it] 87%|████████▋ | 98/113 [01:56<00:16,  1.09s/it] 88%|████████▊ | 99/113 [01:57<00:15,  1.09s/it] 88%|████████▊ | 100/113 [01:58<00:14,  1.10s/it] 89%|████████▉ | 101/113 [01:59<00:13,  1.09s/it] 90%|█████████ | 102/113 [02:00<00:12,  1.11s/it] 91%|█████████ | 103/113 [02:01<00:11,  1.14s/it] 92%|█████████▏| 104/113 [02:03<00:10,  1.13s/it] 93%|█████████▎| 105/113 [02:04<00:08,  1.11s/it] 94%|█████████▍| 106/113 [02:05<00:07,  1.11s/it] 95%|█████████▍| 107/113 [02:06<00:06,  1.11s/it] 96%|█████████▌| 108/113 [02:07<00:05,  1.10s/it] 96%|█████████▋| 109/113 [02:08<00:04,  1.10s/it] 97%|█████████▋| 110/113 [02:09<00:03,  1.13s/it] 98%|█████████▊| 111/113 [02:10<00:02,  1.13s/it] 99%|█████████▉| 112/113 [02:11<00:01,  1.11s/it]100%|██████████| 113/113 [02:12<00:00,  1.11s/it]100%|██████████| 113/113 [02:12<00:00,  1.18s/it]
/disk1/lhl/workspace/unetformer/GeoSeg/tools/metric.py:29: RuntimeWarning:

invalid value encountered in divide

  0%|          | 0/113 [00:00<?, ?it/s]  1%|          | 1/113 [00:11<22:13, 11.90s/it]  2%|▏         | 2/113 [00:15<13:22,  7.23s/it]  3%|▎         | 3/113 [00:19<10:23,  5.66s/it]  4%|▎         | 4/113 [00:23<09:02,  4.98s/it]  4%|▍         | 5/113 [00:27<08:18,  4.61s/it]  5%|▌         | 6/113 [00:31<07:50,  4.40s/it]  6%|▌         | 7/113 [00:35<07:36,  4.31s/it]  7%|▋         | 8/113 [00:39<07:26,  4.25s/it]  8%|▊         | 9/113 [00:43<07:13,  4.17s/it]  9%|▉         | 10/113 [00:47<07:03,  4.12s/it] 10%|▉         | 11/113 [00:51<06:54,  4.06s/it] 11%|█         | 12/113 [00:55<06:50,  4.06s/it] 12%|█▏        | 13/113 [00:59<06:47,  4.08s/it] 12%|█▏        | 14/113 [01:03<06:42,  4.07s/it] 13%|█▎        | 15/113 [01:07<06:36,  4.05s/it] 14%|█▍        | 16/113 [01:11<06:32,  4.05s/it] 15%|█▌        | 17/113 [01:16<06:28,  4.04s/it] 16%|█▌        | 18/113 [01:20<06:23,  4.03s/it] 17%|█▋        | 19/113 [01:24<06:22,  4.07s/it] 18%|█▊        | 20/113 [01:28<06:14,  4.02s/it] 19%|█▊        | 21/113 [01:32<06:08,  4.01s/it] 19%|█▉        | 22/113 [01:36<06:07,  4.04s/it] 20%|██        | 23/113 [01:40<06:02,  4.02s/it] 21%|██        | 24/113 [01:44<05:56,  4.00s/it] 22%|██▏       | 25/113 [01:48<05:51,  4.00s/it] 23%|██▎       | 26/113 [01:52<05:49,  4.02s/it] 24%|██▍       | 27/113 [01:56<05:45,  4.01s/it] 25%|██▍       | 28/113 [02:00<05:42,  4.03s/it] 26%|██▌       | 29/113 [02:04<05:39,  4.05s/it] 27%|██▋       | 30/113 [02:08<05:31,  4.00s/it] 27%|██▋       | 31/113 [02:12<05:24,  3.96s/it] 28%|██▊       | 32/113 [02:16<05:22,  3.98s/it] 29%|██▉       | 33/113 [02:20<05:18,  3.98s/it] 30%|███       | 34/113 [02:24<05:18,  4.03s/it] 31%|███       | 35/113 [02:28<05:14,  4.04s/it] 32%|███▏      | 36/113 [02:32<05:11,  4.04s/it] 33%|███▎      | 37/113 [02:36<05:04,  4.00s/it] 34%|███▎      | 38/113 [02:40<04:59,  4.00s/it] 35%|███▍      | 39/113 [02:44<04:54,  3.98s/it] 35%|███▌      | 40/113 [02:48<04:49,  3.97s/it] 36%|███▋      | 41/113 [02:52<04:44,  3.95s/it] 37%|███▋      | 42/113 [02:56<04:41,  3.97s/it] 38%|███▊      | 43/113 [03:00<04:39,  3.99s/it] 39%|███▉      | 44/113 [03:04<04:36,  4.01s/it] 40%|███▉      | 45/113 [03:08<04:32,  4.00s/it] 41%|████      | 46/113 [03:12<04:28,  4.00s/it] 42%|████▏     | 47/113 [03:16<04:22,  3.97s/it] 42%|████▏     | 48/113 [03:20<04:20,  4.01s/it] 43%|████▎     | 49/113 [03:23<04:14,  3.98s/it] 44%|████▍     | 50/113 [03:27<04:10,  3.98s/it] 45%|████▌     | 51/113 [03:32<04:08,  4.01s/it] 46%|████▌     | 52/113 [03:36<04:06,  4.04s/it] 47%|████▋     | 53/113 [03:40<04:02,  4.04s/it] 48%|████▊     | 54/113 [03:44<03:58,  4.04s/it] 49%|████▊     | 55/113 [03:48<03:53,  4.03s/it] 50%|████▉     | 56/113 [03:52<03:51,  4.06s/it] 50%|█████     | 57/113 [03:56<03:46,  4.04s/it] 51%|█████▏    | 58/113 [04:00<03:40,  4.01s/it] 52%|█████▏    | 59/113 [04:04<03:36,  4.00s/it] 53%|█████▎    | 60/113 [04:08<03:30,  3.98s/it] 54%|█████▍    | 61/113 [04:12<03:27,  3.99s/it] 55%|█████▍    | 62/113 [04:16<03:24,  4.02s/it] 56%|█████▌    | 63/113 [04:20<03:20,  4.00s/it] 57%|█████▋    | 64/113 [04:24<03:18,  4.05s/it] 58%|█████▊    | 65/113 [04:28<03:12,  4.00s/it] 58%|█████▊    | 66/113 [04:32<03:08,  4.01s/it] 59%|█████▉    | 67/113 [04:36<03:04,  4.01s/it] 60%|██████    | 68/113 [04:40<02:59,  4.00s/it] 61%|██████    | 69/113 [04:44<02:55,  3.99s/it] 62%|██████▏   | 70/113 [04:48<02:50,  3.97s/it] 63%|██████▎   | 71/113 [04:52<02:47,  3.99s/it] 64%|██████▎   | 72/113 [04:56<02:43,  3.99s/it] 65%|██████▍   | 73/113 [05:00<02:39,  3.98s/it] 65%|██████▌   | 74/113 [05:04<02:35,  3.97s/it] 66%|██████▋   | 75/113 [05:08<02:30,  3.96s/it] 67%|██████▋   | 76/113 [05:12<02:26,  3.96s/it] 68%|██████▊   | 77/113 [05:16<02:22,  3.96s/it] 69%|██████▉   | 78/113 [05:19<02:18,  3.96s/it] 70%|██████▉   | 79/113 [05:23<02:12,  3.90s/it] 71%|███████   | 80/113 [05:27<02:08,  3.90s/it] 72%|███████▏  | 81/113 [05:31<02:05,  3.93s/it] 73%|███████▎  | 82/113 [05:35<02:01,  3.91s/it] 73%|███████▎  | 83/113 [05:39<01:56,  3.90s/it] 74%|███████▍  | 84/113 [05:43<01:52,  3.89s/it] 75%|███████▌  | 85/113 [05:47<01:48,  3.88s/it] 76%|███████▌  | 86/113 [05:51<01:45,  3.92s/it] 77%|███████▋  | 87/113 [05:55<01:41,  3.91s/it] 78%|███████▊  | 88/113 [05:58<01:37,  3.92s/it] 79%|███████▉  | 89/113 [06:02<01:34,  3.92s/it] 80%|███████▉  | 90/113 [06:06<01:29,  3.91s/it] 81%|████████  | 91/113 [06:10<01:26,  3.93s/it] 81%|████████▏ | 92/113 [06:14<01:22,  3.95s/it] 82%|████████▏ | 93/113 [06:18<01:18,  3.94s/it] 83%|████████▎ | 94/113 [06:22<01:14,  3.92s/it] 84%|████████▍ | 95/113 [06:26<01:10,  3.93s/it] 85%|████████▍ | 96/113 [06:30<01:06,  3.91s/it] 86%|████████▌ | 97/113 [06:34<01:02,  3.90s/it] 87%|████████▋ | 98/113 [06:38<00:58,  3.92s/it] 88%|████████▊ | 99/113 [06:42<00:55,  3.93s/it] 88%|████████▊ | 100/113 [06:46<00:51,  3.96s/it] 89%|████████▉ | 101/113 [06:50<00:47,  3.95s/it] 90%|█████████ | 102/113 [06:54<00:43,  3.95s/it] 91%|█████████ | 103/113 [06:58<00:39,  3.98s/it] 92%|█████████▏| 104/113 [07:02<00:35,  3.99s/it] 93%|█████████▎| 105/113 [07:06<00:31,  3.97s/it] 94%|█████████▍| 106/113 [07:10<00:27,  3.99s/it] 95%|█████████▍| 107/113 [07:14<00:24,  4.04s/it] 96%|█████████▌| 108/113 [07:18<00:19,  4.00s/it] 96%|█████████▋| 109/113 [07:22<00:15,  3.96s/it] 97%|█████████▋| 110/113 [07:26<00:11,  3.97s/it] 98%|█████████▊| 111/113 [07:29<00:07,  3.97s/it] 99%|█████████▉| 112/113 [07:34<00:03,  3.98s/it]100%|██████████| 113/113 [07:37<00:00,  3.98s/it]100%|██████████| 113/113 [07:37<00:00,  4.05s/it]
/disk1/lhl/workspace/unetformer/GeoSeg/tools/metric.py:29: RuntimeWarning:

invalid value encountered in divide

  0%|          | 0/113 [00:00<?, ?it/s]  0%|          | 0/113 [00:34<?, ?it/s]
Traceback (most recent call last):
  File "./vaihingen_test.py", line 133, in <module>
    main()
  File "./vaihingen_test.py", line 105, in main
    raw_predictions = model(img)
  File "/disk1/lhl/env/airs/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1130, in _call_impl
    return forward_call(*input, **kwargs)
  File "/disk1/lhl/env/airs/lib/python3.8/site-packages/ttach/wrappers.py", line 39, in forward
    augmented_output = self.model(augmented_image, *args)
  File "/disk1/lhl/env/airs/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1130, in _call_impl
    return forward_call(*input, **kwargs)
  File "/disk1/lhl/workspace/unetformer/GeoSeg/train_supervision.py", line 47, in forward
    seg_pre = self.net(x)
  File "/disk1/lhl/env/airs/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1130, in _call_impl
    return forward_call(*input, **kwargs)
  File "/disk1/lhl/workspace/unetformer/GeoSeg/geoseg/models/HRNet.py", line 150, in forward
    c = self.cls_head(feats)
  File "/disk1/lhl/env/airs/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1130, in _call_impl
    return forward_call(*input, **kwargs)
  File "/disk1/lhl/env/airs/lib/python3.8/site-packages/torch/nn/modules/container.py", line 139, in forward
    input = module(input)
  File "/disk1/lhl/env/airs/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1130, in _call_impl
    return forward_call(*input, **kwargs)
  File "/disk1/lhl/env/airs/lib/python3.8/site-packages/torch/nn/modules/container.py", line 139, in forward
    input = module(input)
  File "/disk1/lhl/env/airs/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1130, in _call_impl
    return forward_call(*input, **kwargs)
  File "/disk1/lhl/env/airs/lib/python3.8/site-packages/torch/nn/modules/batchnorm.py", line 168, in forward
    return F.batch_norm(
  File "/disk1/lhl/env/airs/lib/python3.8/site-packages/torch/nn/functional.py", line 2438, in batch_norm
    return torch.batch_norm(
RuntimeError: CUDA out of memory. Tried to allocate 2.25 GiB (GPU 0; 10.92 GiB total capacity; 7.78 GiB already allocated; 1.44 GiB free; 8.32 GiB reserved in total by PyTorch) If reserved memory is >> allocated memory try setting max_split_size_mb to avoid fragmentation.  See documentation for Memory Management and PYTORCH_CUDA_ALLOC_CONF
GPU available: True, used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0,1,2]

  | Name | Type            | Params
-----------------------------------------
0 | net  | HRNet_W48_Proto | 54.2 M
1 | loss | FSAuxCELoss     | 0     
-----------------------------------------
54.2 M    Trainable params
0         Non-trainable params
54.2 M    Total params
216.908   Total estimated model params size (MB)
/disk1/lhl/env/airs/lib/python3.8/site-packages/torch/nn/_reduction.py:13: UserWarning:

reduction='elementwise_mean' is deprecated, please use reduction='mean' instead.

/disk1/lhl/workspace/unetformer/GeoSeg/tools/metric.py:29: RuntimeWarning:

invalid value encountered in divide

Killed
usage: potsdam_test.py [-h] -c CONFIG_PATH -o OUTPUT_PATH [-t {None,d4,lr}]
                       [--rgb]
potsdam_test.py: error: argument -t/--tta: invalid choice: 'none' (choose from None, 'd4', 'lr')
/disk1/lhl/env/airs/lib/python3.8/site-packages/torch/functional.py:478: UserWarning:

torch.meshgrid: in an upcoming release, it will be required to pass the indexing argument. (Triggered internally at  /opt/conda/conda-bld/pytorch_1659484657607/work/aten/src/ATen/native/TensorShape.cpp:2895.)

Traceback (most recent call last):
  File "./potsdam_test.py", line 134, in <module>
    main()
  File "./potsdam_test.py", line 69, in main
    model = Supervision_Train.load_from_checkpoint(
  File "/disk1/lhl/env/airs/lib/python3.8/site-packages/pytorch_lightning/core/saving.py", line 134, in load_from_checkpoint
    checkpoint = pl_load(checkpoint_path, map_location=lambda storage, loc: storage)
  File "/disk1/lhl/env/airs/lib/python3.8/site-packages/pytorch_lightning/utilities/cloud_io.py", line 37, in load
    with fs.open(path_or_url, "rb") as f:
  File "/disk1/lhl/env/airs/lib/python3.8/site-packages/fsspec/spec.py", line 1034, in open
    f = self._open(
  File "/disk1/lhl/env/airs/lib/python3.8/site-packages/fsspec/implementations/local.py", line 162, in _open
    return LocalFileOpener(path, mode, fs=self, **kwargs)
  File "/disk1/lhl/env/airs/lib/python3.8/site-packages/fsspec/implementations/local.py", line 260, in __init__
    self._open()
  File "/disk1/lhl/env/airs/lib/python3.8/site-packages/fsspec/implementations/local.py", line 265, in _open
    self.f = open(self.path, mode=self.mode)
FileNotFoundError: [Errno 2] No such file or directory: '/disk1/lhl/workspace/unetformer/GeoSeg/model_weights/potsdam/unetformer-r18-1024crop512-ms-e100/unetformer-1024crop512-512-ms-e100.ckpt'
/disk1/lhl/env/airs/lib/python3.8/site-packages/torch/functional.py:478: UserWarning:

torch.meshgrid: in an upcoming release, it will be required to pass the indexing argument. (Triggered internally at  /opt/conda/conda-bld/pytorch_1659484657607/work/aten/src/ATen/native/TensorShape.cpp:2895.)

Traceback (most recent call last):
  File "./potsdam_test.py", line 134, in <module>
    main()
  File "./potsdam_test.py", line 69, in main
    model = Supervision_Train.load_from_checkpoint(
  File "/disk1/lhl/env/airs/lib/python3.8/site-packages/pytorch_lightning/core/saving.py", line 134, in load_from_checkpoint
    checkpoint = pl_load(checkpoint_path, map_location=lambda storage, loc: storage)
  File "/disk1/lhl/env/airs/lib/python3.8/site-packages/pytorch_lightning/utilities/cloud_io.py", line 37, in load
    with fs.open(path_or_url, "rb") as f:
  File "/disk1/lhl/env/airs/lib/python3.8/site-packages/fsspec/spec.py", line 1034, in open
    f = self._open(
  File "/disk1/lhl/env/airs/lib/python3.8/site-packages/fsspec/implementations/local.py", line 162, in _open
    return LocalFileOpener(path, mode, fs=self, **kwargs)
  File "/disk1/lhl/env/airs/lib/python3.8/site-packages/fsspec/implementations/local.py", line 260, in __init__
    self._open()
  File "/disk1/lhl/env/airs/lib/python3.8/site-packages/fsspec/implementations/local.py", line 265, in _open
    self.f = open(self.path, mode=self.mode)
FileNotFoundError: [Errno 2] No such file or directory: '/disk1/lhl/workspace/unetformer/GeoSeg/model_weights/potsdam/unetformer-r18-1024crop512-ms-e100/unetformer-1024crop512-512-ms-e100.ckpt'
/disk1/lhl/env/airs/lib/python3.8/site-packages/torch/functional.py:478: UserWarning:

torch.meshgrid: in an upcoming release, it will be required to pass the indexing argument. (Triggered internally at  /opt/conda/conda-bld/pytorch_1659484657607/work/aten/src/ATen/native/TensorShape.cpp:2895.)

Traceback (most recent call last):
  File "./potsdam_test.py", line 134, in <module>
    main()
  File "./potsdam_test.py", line 69, in main
    model = Supervision_Train.load_from_checkpoint(
  File "/disk1/lhl/env/airs/lib/python3.8/site-packages/pytorch_lightning/core/saving.py", line 134, in load_from_checkpoint
    checkpoint = pl_load(checkpoint_path, map_location=lambda storage, loc: storage)
  File "/disk1/lhl/env/airs/lib/python3.8/site-packages/pytorch_lightning/utilities/cloud_io.py", line 37, in load
    with fs.open(path_or_url, "rb") as f:
  File "/disk1/lhl/env/airs/lib/python3.8/site-packages/fsspec/spec.py", line 1034, in open
    f = self._open(
  File "/disk1/lhl/env/airs/lib/python3.8/site-packages/fsspec/implementations/local.py", line 162, in _open
    return LocalFileOpener(path, mode, fs=self, **kwargs)
  File "/disk1/lhl/env/airs/lib/python3.8/site-packages/fsspec/implementations/local.py", line 260, in __init__
    self._open()
  File "/disk1/lhl/env/airs/lib/python3.8/site-packages/fsspec/implementations/local.py", line 265, in _open
    self.f = open(self.path, mode=self.mode)
FileNotFoundError: [Errno 2] No such file or directory: '/disk1/lhl/workspace/unetformer/GeoSeg/model_weights/potsdam/unetformer-r18-1024crop512-ms-e100/unetformer-1024crop512-512-ms-e100.ckpt'
/disk1/lhl/env/airs/lib/python3.8/site-packages/torch/functional.py:478: UserWarning:

torch.meshgrid: in an upcoming release, it will be required to pass the indexing argument. (Triggered internally at  /opt/conda/conda-bld/pytorch_1659484657607/work/aten/src/ATen/native/TensorShape.cpp:2895.)

Traceback (most recent call last):
  File "./potsdam_test.py", line 134, in <module>
    main()
  File "./potsdam_test.py", line 69, in main
    model = Supervision_Train.load_from_checkpoint(
  File "/disk1/lhl/env/airs/lib/python3.8/site-packages/pytorch_lightning/core/saving.py", line 134, in load_from_checkpoint
    checkpoint = pl_load(checkpoint_path, map_location=lambda storage, loc: storage)
  File "/disk1/lhl/env/airs/lib/python3.8/site-packages/pytorch_lightning/utilities/cloud_io.py", line 37, in load
    with fs.open(path_or_url, "rb") as f:
  File "/disk1/lhl/env/airs/lib/python3.8/site-packages/fsspec/spec.py", line 1034, in open
    f = self._open(
  File "/disk1/lhl/env/airs/lib/python3.8/site-packages/fsspec/implementations/local.py", line 162, in _open
    return LocalFileOpener(path, mode, fs=self, **kwargs)
  File "/disk1/lhl/env/airs/lib/python3.8/site-packages/fsspec/implementations/local.py", line 260, in __init__
    self._open()
  File "/disk1/lhl/env/airs/lib/python3.8/site-packages/fsspec/implementations/local.py", line 265, in _open
    self.f = open(self.path, mode=self.mode)
FileNotFoundError: [Errno 2] No such file or directory: '/disk1/lhl/workspace/unetformer/GeoSeg/model_weights/potsdam/unetformer-r18-1024crop512-ms-e100/unetformer-1024crop512-512-ms-e100.ckpt'
/disk1/lhl/env/airs/lib/python3.8/site-packages/torch/functional.py:478: UserWarning:

torch.meshgrid: in an upcoming release, it will be required to pass the indexing argument. (Triggered internally at  /opt/conda/conda-bld/pytorch_1659484657607/work/aten/src/ATen/native/TensorShape.cpp:2895.)

Traceback (most recent call last):
  File "./potsdam_test.py", line 134, in <module>
    main()
  File "./potsdam_test.py", line 69, in main
    model = Supervision_Train.load_from_checkpoint(
  File "/disk1/lhl/env/airs/lib/python3.8/site-packages/pytorch_lightning/core/saving.py", line 134, in load_from_checkpoint
    checkpoint = pl_load(checkpoint_path, map_location=lambda storage, loc: storage)
  File "/disk1/lhl/env/airs/lib/python3.8/site-packages/pytorch_lightning/utilities/cloud_io.py", line 37, in load
    with fs.open(path_or_url, "rb") as f:
  File "/disk1/lhl/env/airs/lib/python3.8/site-packages/fsspec/spec.py", line 1034, in open
    f = self._open(
  File "/disk1/lhl/env/airs/lib/python3.8/site-packages/fsspec/implementations/local.py", line 162, in _open
    return LocalFileOpener(path, mode, fs=self, **kwargs)
  File "/disk1/lhl/env/airs/lib/python3.8/site-packages/fsspec/implementations/local.py", line 260, in __init__
    self._open()
  File "/disk1/lhl/env/airs/lib/python3.8/site-packages/fsspec/implementations/local.py", line 265, in _open
    self.f = open(self.path, mode=self.mode)
FileNotFoundError: [Errno 2] No such file or directory: '/disk1/lhl/workspace/unetformer/GeoSeg/model_weights/potsdam/unetformer-r18-1024crop512-ms-e100/unetformer-1024crop512-512-ms-e100.ckpt'
Traceback (most recent call last):
  File "/disk1/lhl/env/airs/lib/python3.8/multiprocessing/resource_sharer.py", line 149, in _serve
    send(conn, destination_pid)
  File "/disk1/lhl/env/airs/lib/python3.8/multiprocessing/resource_sharer.py", line 50, in send
    reduction.send_handle(conn, new_fd, pid)
  File "/disk1/lhl/env/airs/lib/python3.8/multiprocessing/reduction.py", line 183, in send_handle
    with socket.fromfd(conn.fileno(), socket.AF_UNIX, socket.SOCK_STREAM) as s:
  File "/disk1/lhl/env/airs/lib/python3.8/socket.py", line 544, in fromfd
    return socket(family, type, proto, nfd)
  File "/disk1/lhl/env/airs/lib/python3.8/socket.py", line 231, in __init__
    _socket.socket.__init__(self, family, type, proto, fileno)
OSError: [Errno 9] Bad file descriptor
Exception in thread Thread-36:
Traceback (most recent call last):
  File "/disk1/lhl/env/airs/lib/python3.8/threading.py", line 932, in _bootstrap_inner
    self.run()
  File "/disk1/lhl/env/airs/lib/python3.8/threading.py", line 870, in run
    self._target(*self._args, **self._kwargs)
  File "/disk1/lhl/env/airs/lib/python3.8/site-packages/torch/utils/data/_utils/pin_memory.py", line 28, in _pin_memory_loop
    r = in_queue.get(timeout=MP_STATUS_CHECK_INTERVAL)
  File "/disk1/lhl/env/airs/lib/python3.8/multiprocessing/queues.py", line 116, in get
    return _ForkingPickler.loads(res)
  File "/disk1/lhl/env/airs/lib/python3.8/site-packages/torch/multiprocessing/reductions.py", line 297, in rebuild_storage_fd
    fd = df.detach()
  File "/disk1/lhl/env/airs/lib/python3.8/multiprocessing/resource_sharer.py", line 58, in detach
    return reduction.recv_handle(conn)
  File "/disk1/lhl/env/airs/lib/python3.8/multiprocessing/reduction.py", line 189, in recv_handle
    return recvfds(s, 1)[0]
  File "/disk1/lhl/env/airs/lib/python3.8/multiprocessing/reduction.py", line 159, in recvfds
    raise EOFError
EOFError
Traceback (most recent call last):
  File "./train_proto.py", line 206, in <module>
    main()
  File "./train_proto.py", line 202, in main
    trainer.fit(model=model)
  File "/disk1/lhl/env/airs/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 740, in fit
    self._call_and_handle_interrupt(
  File "/disk1/lhl/env/airs/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 685, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "/disk1/lhl/env/airs/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 777, in _fit_impl
    self._run(model, ckpt_path=ckpt_path)
  File "/disk1/lhl/env/airs/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1199, in _run
    self._dispatch()
  File "/disk1/lhl/env/airs/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1279, in _dispatch
    self.training_type_plugin.start_training(self)
  File "/disk1/lhl/env/airs/lib/python3.8/site-packages/pytorch_lightning/plugins/training_type/training_type_plugin.py", line 202, in start_training
    self._results = trainer.run_stage()
  File "/disk1/lhl/env/airs/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1289, in run_stage
    return self._run_train()
  File "/disk1/lhl/env/airs/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1319, in _run_train
    self.fit_loop.run()
  File "/disk1/lhl/env/airs/lib/python3.8/site-packages/pytorch_lightning/loops/base.py", line 145, in run
    self.advance(*args, **kwargs)
  File "/disk1/lhl/env/airs/lib/python3.8/site-packages/pytorch_lightning/loops/fit_loop.py", line 234, in advance
    self.epoch_loop.run(data_fetcher)
  File "/disk1/lhl/env/airs/lib/python3.8/site-packages/pytorch_lightning/loops/base.py", line 146, in run
    self.on_advance_end()
  File "/disk1/lhl/env/airs/lib/python3.8/site-packages/pytorch_lightning/loops/epoch/training_epoch_loop.py", line 242, in on_advance_end
    self._run_validation()
  File "/disk1/lhl/env/airs/lib/python3.8/site-packages/pytorch_lightning/loops/epoch/training_epoch_loop.py", line 337, in _run_validation
    self.val_loop.run()
  File "/disk1/lhl/env/airs/lib/python3.8/site-packages/pytorch_lightning/loops/base.py", line 145, in run
    self.advance(*args, **kwargs)
  File "/disk1/lhl/env/airs/lib/python3.8/site-packages/pytorch_lightning/loops/dataloader/evaluation_loop.py", line 110, in advance
    dl_outputs = self.epoch_loop.run(dataloader, dataloader_idx, dl_max_batches, self.num_dataloaders)
  File "/disk1/lhl/env/airs/lib/python3.8/site-packages/pytorch_lightning/loops/base.py", line 140, in run
    self.on_run_start(*args, **kwargs)
  File "/disk1/lhl/env/airs/lib/python3.8/site-packages/pytorch_lightning/loops/epoch/evaluation_epoch_loop.py", line 86, in on_run_start
    self._dataloader_iter = _update_dataloader_iter(data_fetcher, self.batch_progress.current.ready)
  File "/disk1/lhl/env/airs/lib/python3.8/site-packages/pytorch_lightning/loops/utilities.py", line 121, in _update_dataloader_iter
    dataloader_iter = enumerate(data_fetcher, batch_idx)
  File "/disk1/lhl/env/airs/lib/python3.8/site-packages/pytorch_lightning/utilities/fetching.py", line 199, in __iter__
    self.prefetching(self.prefetch_batches)
  File "/disk1/lhl/env/airs/lib/python3.8/site-packages/pytorch_lightning/utilities/fetching.py", line 258, in prefetching
    self._fetch_next_batch()
  File "/disk1/lhl/env/airs/lib/python3.8/site-packages/pytorch_lightning/utilities/fetching.py", line 300, in _fetch_next_batch
    batch = next(self.dataloader_iter)
  File "/disk1/lhl/env/airs/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 681, in __next__
    data = self._next_data()
  File "/disk1/lhl/env/airs/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 1359, in _next_data
    idx, data = self._get_data()
  File "/disk1/lhl/env/airs/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 1320, in _get_data
    raise RuntimeError('Pin memory thread exited unexpectedly')
RuntimeError: Pin memory thread exited unexpectedly
  0%|          | 0/113 [00:00<?, ?it/s]  1%|          | 1/113 [00:08<16:26,  8.81s/it]  2%|▏         | 2/113 [00:09<07:52,  4.25s/it]  3%|▎         | 3/113 [00:10<05:05,  2.78s/it]  4%|▎         | 4/113 [00:11<03:48,  2.10s/it]  4%|▍         | 5/113 [00:13<03:06,  1.72s/it]  5%|▌         | 6/113 [00:14<02:40,  1.50s/it]  6%|▌         | 7/113 [00:15<02:23,  1.36s/it]  7%|▋         | 8/113 [00:16<02:11,  1.25s/it]  8%|▊         | 9/113 [00:17<02:02,  1.18s/it]  9%|▉         | 10/113 [00:18<01:56,  1.13s/it] 10%|▉         | 11/113 [00:19<01:54,  1.12s/it] 11%|█         | 12/113 [00:20<01:51,  1.10s/it] 12%|█▏        | 13/113 [00:21<01:48,  1.08s/it] 12%|█▏        | 14/113 [00:22<01:47,  1.08s/it] 13%|█▎        | 15/113 [00:23<01:46,  1.09s/it] 14%|█▍        | 16/113 [00:24<01:44,  1.08s/it] 15%|█▌        | 17/113 [00:25<01:43,  1.08s/it] 16%|█▌        | 18/113 [00:26<01:43,  1.08s/it] 17%|█▋        | 19/113 [00:27<01:42,  1.09s/it] 18%|█▊        | 20/113 [00:28<01:40,  1.08s/it] 19%|█▊        | 21/113 [00:30<01:39,  1.08s/it] 19%|█▉        | 22/113 [00:31<01:38,  1.09s/it] 20%|██        | 23/113 [00:32<01:37,  1.09s/it] 21%|██        | 24/113 [00:33<01:36,  1.08s/it] 22%|██▏       | 25/113 [00:34<01:35,  1.09s/it] 23%|██▎       | 26/113 [00:35<01:34,  1.09s/it] 24%|██▍       | 27/113 [00:36<01:33,  1.09s/it] 25%|██▍       | 28/113 [00:37<01:32,  1.09s/it] 26%|██▌       | 29/113 [00:38<01:32,  1.10s/it] 27%|██▋       | 30/113 [00:39<01:30,  1.09s/it] 27%|██▋       | 31/113 [00:40<01:28,  1.08s/it] 28%|██▊       | 32/113 [00:42<01:26,  1.07s/it] 29%|██▉       | 33/113 [00:43<01:26,  1.09s/it] 30%|███       | 34/113 [00:44<01:25,  1.09s/it] 31%|███       | 35/113 [00:45<01:24,  1.09s/it] 32%|███▏      | 36/113 [00:46<01:24,  1.09s/it] 33%|███▎      | 37/113 [00:47<01:22,  1.09s/it] 34%|███▎      | 38/113 [00:48<01:22,  1.10s/it] 35%|███▍      | 39/113 [00:49<01:20,  1.09s/it] 35%|███▌      | 40/113 [00:50<01:19,  1.08s/it] 36%|███▋      | 41/113 [00:51<01:17,  1.08s/it] 37%|███▋      | 42/113 [00:52<01:17,  1.08s/it] 38%|███▊      | 43/113 [00:53<01:15,  1.08s/it] 39%|███▉      | 44/113 [00:55<01:15,  1.09s/it] 40%|███▉      | 45/113 [00:56<01:14,  1.10s/it] 41%|████      | 46/113 [00:57<01:13,  1.09s/it] 42%|████▏     | 47/113 [00:58<01:12,  1.10s/it] 42%|████▏     | 48/113 [00:59<01:11,  1.09s/it] 43%|████▎     | 49/113 [01:00<01:09,  1.08s/it] 44%|████▍     | 50/113 [01:01<01:07,  1.08s/it] 45%|████▌     | 51/113 [01:02<01:07,  1.08s/it] 46%|████▌     | 52/113 [01:03<01:06,  1.09s/it] 47%|████▋     | 53/113 [01:04<01:04,  1.08s/it] 48%|████▊     | 54/113 [01:05<01:03,  1.07s/it] 49%|████▊     | 55/113 [01:07<01:02,  1.08s/it] 50%|████▉     | 56/113 [01:08<01:01,  1.07s/it] 50%|█████     | 57/113 [01:09<00:59,  1.07s/it] 51%|█████▏    | 58/113 [01:10<00:58,  1.06s/it] 52%|█████▏    | 59/113 [01:11<00:57,  1.06s/it] 53%|█████▎    | 60/113 [01:12<00:56,  1.08s/it] 54%|█████▍    | 61/113 [01:13<00:56,  1.09s/it] 55%|█████▍    | 62/113 [01:14<00:55,  1.09s/it] 56%|█████▌    | 63/113 [01:15<00:54,  1.10s/it] 57%|█████▋    | 64/113 [01:16<00:53,  1.10s/it] 58%|█████▊    | 65/113 [01:17<00:52,  1.09s/it] 58%|█████▊    | 66/113 [01:18<00:51,  1.09s/it] 59%|█████▉    | 67/113 [01:20<00:49,  1.09s/it] 60%|██████    | 68/113 [01:21<00:48,  1.08s/it] 61%|██████    | 69/113 [01:22<00:47,  1.08s/it] 62%|██████▏   | 70/113 [01:23<00:46,  1.09s/it] 63%|██████▎   | 71/113 [01:24<00:45,  1.09s/it] 64%|██████▎   | 72/113 [01:25<00:44,  1.09s/it] 65%|██████▍   | 73/113 [01:26<00:43,  1.09s/it] 65%|██████▌   | 74/113 [01:27<00:42,  1.08s/it] 66%|██████▋   | 75/113 [01:28<00:41,  1.09s/it] 67%|██████▋   | 76/113 [01:29<00:40,  1.09s/it] 68%|██████▊   | 77/113 [01:30<00:38,  1.08s/it] 69%|██████▉   | 78/113 [01:31<00:37,  1.07s/it] 70%|██████▉   | 79/113 [01:32<00:35,  1.05s/it] 71%|███████   | 80/113 [01:33<00:34,  1.05s/it] 72%|███████▏  | 81/113 [01:34<00:33,  1.04s/it] 73%|███████▎  | 82/113 [01:35<00:32,  1.04s/it] 73%|███████▎  | 83/113 [01:37<00:31,  1.04s/it] 74%|███████▍  | 84/113 [01:38<00:30,  1.06s/it] 75%|███████▌  | 85/113 [01:39<00:29,  1.07s/it] 76%|███████▌  | 86/113 [01:40<00:28,  1.07s/it] 77%|███████▋  | 87/113 [01:41<00:28,  1.08s/it] 78%|███████▊  | 88/113 [01:42<00:27,  1.09s/it] 79%|███████▉  | 89/113 [01:43<00:26,  1.09s/it] 80%|███████▉  | 90/113 [01:44<00:25,  1.09s/it] 81%|████████  | 91/113 [01:45<00:24,  1.10s/it] 81%|████████▏ | 92/113 [01:46<00:23,  1.10s/it] 82%|████████▏ | 93/113 [01:48<00:22,  1.10s/it] 83%|████████▎ | 94/113 [01:49<00:20,  1.10s/it] 84%|████████▍ | 95/113 [01:50<00:19,  1.10s/it] 85%|████████▍ | 96/113 [01:51<00:18,  1.10s/it] 86%|████████▌ | 97/113 [01:52<00:17,  1.08s/it] 87%|████████▋ | 98/113 [01:53<00:16,  1.07s/it] 88%|████████▊ | 99/113 [01:54<00:15,  1.08s/it] 88%|████████▊ | 100/113 [01:55<00:14,  1.09s/it] 89%|████████▉ | 101/113 [01:56<00:12,  1.08s/it] 90%|█████████ | 102/113 [01:57<00:11,  1.08s/it] 91%|█████████ | 103/113 [01:58<00:10,  1.09s/it] 92%|█████████▏| 104/113 [01:59<00:09,  1.09s/it] 93%|█████████▎| 105/113 [02:01<00:08,  1.09s/it] 94%|█████████▍| 106/113 [02:02<00:07,  1.10s/it] 95%|█████████▍| 107/113 [02:03<00:06,  1.09s/it] 96%|█████████▌| 108/113 [02:04<00:05,  1.10s/it] 96%|█████████▋| 109/113 [02:05<00:04,  1.09s/it] 97%|█████████▋| 110/113 [02:06<00:03,  1.09s/it] 98%|█████████▊| 111/113 [02:07<00:02,  1.08s/it] 99%|█████████▉| 112/113 [02:08<00:01,  1.09s/it]100%|██████████| 113/113 [02:09<00:00,  1.08s/it]100%|██████████| 113/113 [02:09<00:00,  1.15s/it]
/disk1/lhl/workspace/unetformer/GeoSeg/tools/metric.py:29: RuntimeWarning:

invalid value encountered in divide

  0%|          | 0/113 [00:00<?, ?it/s]  1%|          | 1/113 [00:11<21:57, 11.76s/it]  2%|▏         | 2/113 [00:15<13:12,  7.14s/it]  3%|▎         | 3/113 [00:19<10:19,  5.63s/it]  4%|▎         | 4/113 [00:23<09:01,  4.97s/it]  4%|▍         | 5/113 [00:27<08:16,  4.60s/it]  5%|▌         | 6/113 [00:31<07:52,  4.41s/it]  6%|▌         | 7/113 [00:35<07:33,  4.28s/it]  7%|▋         | 8/113 [00:39<07:19,  4.19s/it]  8%|▊         | 9/113 [00:43<07:08,  4.12s/it]  9%|▉         | 10/113 [00:47<06:56,  4.04s/it] 10%|▉         | 11/113 [00:51<06:49,  4.02s/it] 11%|█         | 12/113 [00:55<06:44,  4.00s/it] 12%|█▏        | 13/113 [00:59<06:39,  4.00s/it] 12%|█▏        | 14/113 [01:03<06:35,  4.00s/it] 13%|█▎        | 15/113 [01:07<06:32,  4.01s/it] 14%|█▍        | 16/113 [01:11<06:22,  3.95s/it] 15%|█▌        | 17/113 [01:15<06:20,  3.96s/it] 16%|█▌        | 18/113 [01:19<06:17,  3.97s/it] 17%|█▋        | 19/113 [01:23<06:14,  3.99s/it] 18%|█▊        | 20/113 [01:27<06:10,  3.99s/it] 19%|█▊        | 21/113 [01:31<06:07,  4.00s/it] 19%|█▉        | 22/113 [01:35<06:02,  3.99s/it] 20%|██        | 23/113 [01:38<05:57,  3.97s/it] 21%|██        | 24/113 [01:42<05:52,  3.96s/it] 22%|██▏       | 25/113 [01:46<05:48,  3.97s/it] 23%|██▎       | 26/113 [01:50<05:45,  3.97s/it] 24%|██▍       | 27/113 [01:54<05:43,  3.99s/it] 25%|██▍       | 28/113 [01:58<05:37,  3.97s/it] 26%|██▌       | 29/113 [02:02<05:31,  3.95s/it] 27%|██▋       | 30/113 [02:06<05:26,  3.93s/it] 27%|██▋       | 31/113 [02:10<05:20,  3.91s/it] 28%|██▊       | 32/113 [02:14<05:18,  3.93s/it] 29%|██▉       | 33/113 [02:18<05:14,  3.93s/it] 30%|███       | 34/113 [02:22<05:13,  3.97s/it] 31%|███       | 35/113 [02:26<05:10,  3.99s/it] 32%|███▏      | 36/113 [02:30<05:07,  4.00s/it] 33%|███▎      | 37/113 [02:34<05:02,  3.98s/it] 34%|███▎      | 38/113 [02:38<04:57,  3.97s/it] 35%|███▍      | 39/113 [02:42<04:52,  3.95s/it] 35%|███▌      | 40/113 [02:46<04:47,  3.94s/it] 36%|███▋      | 41/113 [02:50<04:43,  3.93s/it] 37%|███▋      | 42/113 [02:54<04:40,  3.95s/it] 38%|███▊      | 43/113 [02:58<04:36,  3.94s/it] 39%|███▉      | 44/113 [03:01<04:32,  3.95s/it] 40%|███▉      | 45/113 [03:06<04:30,  3.98s/it] 41%|████      | 46/113 [03:10<04:28,  4.00s/it] 42%|████▏     | 47/113 [03:14<04:23,  3.99s/it] 42%|████▏     | 48/113 [03:18<04:20,  4.00s/it] 43%|████▎     | 49/113 [03:21<04:14,  3.97s/it] 44%|████▍     | 50/113 [03:25<04:09,  3.97s/it] 45%|████▌     | 51/113 [03:29<04:07,  4.00s/it] 46%|████▌     | 52/113 [03:33<04:03,  3.99s/it] 47%|████▋     | 53/113 [03:37<03:58,  3.98s/it] 48%|████▊     | 54/113 [03:41<03:55,  3.98s/it] 49%|████▊     | 55/113 [03:45<03:52,  4.01s/it] 50%|████▉     | 56/113 [03:50<03:48,  4.02s/it] 50%|█████     | 57/113 [03:54<03:44,  4.00s/it] 51%|█████▏    | 58/113 [03:57<03:39,  4.00s/it] 52%|█████▏    | 59/113 [04:01<03:34,  3.97s/it] 53%|█████▎    | 60/113 [04:05<03:30,  3.98s/it] 54%|█████▍    | 61/113 [04:09<03:28,  4.01s/it] 55%|█████▍    | 62/113 [04:14<03:25,  4.02s/it] 56%|█████▌    | 63/113 [04:17<03:20,  4.00s/it] 57%|█████▋    | 64/113 [04:22<03:17,  4.02s/it] 58%|█████▊    | 65/113 [04:25<03:11,  4.00s/it] 58%|█████▊    | 66/113 [04:29<03:06,  3.98s/it] 59%|█████▉    | 67/113 [04:33<03:02,  3.97s/it] 60%|██████    | 68/113 [04:37<02:57,  3.94s/it] 61%|██████    | 69/113 [04:41<02:53,  3.95s/it] 62%|██████▏   | 70/113 [04:45<02:50,  3.96s/it] 63%|██████▎   | 71/113 [04:49<02:46,  3.95s/it] 64%|██████▎   | 72/113 [04:53<02:43,  3.98s/it] 65%|██████▍   | 73/113 [04:57<02:38,  3.96s/it] 65%|██████▌   | 74/113 [05:01<02:35,  3.98s/it] 66%|██████▋   | 75/113 [05:05<02:30,  3.97s/it] 67%|██████▋   | 76/113 [05:09<02:27,  3.98s/it] 68%|██████▊   | 77/113 [05:13<02:22,  3.96s/it] 69%|██████▉   | 78/113 [05:17<02:17,  3.94s/it] 70%|██████▉   | 79/113 [05:21<02:13,  3.94s/it] 71%|███████   | 80/113 [05:25<02:10,  3.95s/it] 72%|███████▏  | 81/113 [05:29<02:05,  3.91s/it] 73%|███████▎  | 82/113 [05:33<02:02,  3.94s/it] 73%|███████▎  | 83/113 [05:36<01:57,  3.91s/it] 74%|███████▍  | 84/113 [05:40<01:53,  3.91s/it] 75%|███████▌  | 85/113 [05:44<01:49,  3.91s/it] 76%|███████▌  | 86/113 [05:48<01:45,  3.92s/it] 77%|███████▋  | 87/113 [05:52<01:42,  3.93s/it] 78%|███████▊  | 88/113 [05:56<01:38,  3.94s/it] 79%|███████▉  | 89/113 [06:00<01:33,  3.90s/it] 80%|███████▉  | 90/113 [06:04<01:29,  3.91s/it] 81%|████████  | 91/113 [06:08<01:26,  3.93s/it] 81%|████████▏ | 92/113 [06:12<01:22,  3.93s/it] 82%|████████▏ | 93/113 [06:16<01:18,  3.94s/it] 83%|████████▎ | 94/113 [06:20<01:15,  3.96s/it] 84%|████████▍ | 95/113 [06:24<01:10,  3.94s/it] 85%|████████▍ | 96/113 [06:28<01:07,  3.94s/it] 86%|████████▌ | 97/113 [06:32<01:03,  3.95s/it] 87%|████████▋ | 98/113 [06:35<00:59,  3.93s/it] 88%|████████▊ | 99/113 [06:39<00:54,  3.92s/it] 88%|████████▊ | 100/113 [06:43<00:50,  3.90s/it] 89%|████████▉ | 101/113 [06:47<00:46,  3.89s/it] 90%|█████████ | 102/113 [06:51<00:43,  3.92s/it] 91%|█████████ | 103/113 [06:55<00:39,  3.92s/it] 92%|█████████▏| 104/113 [06:59<00:35,  3.93s/it] 93%|█████████▎| 105/113 [07:03<00:31,  3.94s/it] 94%|█████████▍| 106/113 [07:07<00:27,  3.93s/it] 95%|█████████▍| 107/113 [07:11<00:23,  3.93s/it] 96%|█████████▌| 108/113 [07:15<00:19,  3.92s/it] 96%|█████████▋| 109/113 [07:18<00:15,  3.91s/it] 97%|█████████▋| 110/113 [07:22<00:11,  3.90s/it] 98%|█████████▊| 111/113 [07:26<00:07,  3.89s/it] 99%|█████████▉| 112/113 [07:30<00:03,  3.91s/it]100%|██████████| 113/113 [07:34<00:00,  3.94s/it]100%|██████████| 113/113 [07:34<00:00,  4.02s/it]
/disk1/lhl/workspace/unetformer/GeoSeg/tools/metric.py:29: RuntimeWarning:

invalid value encountered in divide

  0%|          | 0/113 [00:00<?, ?it/s]  0%|          | 0/113 [00:19<?, ?it/s]
Traceback (most recent call last):
  File "./vaihingen_test.py", line 135, in <module>
    main()
  File "./vaihingen_test.py", line 107, in main
    raw_predictions = model(img)
  File "/disk1/lhl/env/airs/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1130, in _call_impl
    return forward_call(*input, **kwargs)
  File "/disk1/lhl/env/airs/lib/python3.8/site-packages/ttach/wrappers.py", line 39, in forward
    augmented_output = self.model(augmented_image, *args)
  File "/disk1/lhl/env/airs/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1130, in _call_impl
    return forward_call(*input, **kwargs)
  File "/disk1/lhl/workspace/unetformer/GeoSeg/train_supervision.py", line 47, in forward
    seg_pre = self.net(x)
  File "/disk1/lhl/env/airs/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1130, in _call_impl
    return forward_call(*input, **kwargs)
  File "/disk1/lhl/workspace/unetformer/GeoSeg/geoseg/models/HRNet.py", line 150, in forward
    c = self.cls_head(feats)
  File "/disk1/lhl/env/airs/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1130, in _call_impl
    return forward_call(*input, **kwargs)
  File "/disk1/lhl/env/airs/lib/python3.8/site-packages/torch/nn/modules/container.py", line 139, in forward
    input = module(input)
  File "/disk1/lhl/env/airs/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1130, in _call_impl
    return forward_call(*input, **kwargs)
  File "/disk1/lhl/env/airs/lib/python3.8/site-packages/torch/nn/modules/container.py", line 139, in forward
    input = module(input)
  File "/disk1/lhl/env/airs/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1130, in _call_impl
    return forward_call(*input, **kwargs)
  File "/disk1/lhl/env/airs/lib/python3.8/site-packages/torch/nn/modules/activation.py", line 98, in forward
    return F.relu(input, inplace=self.inplace)
  File "/disk1/lhl/env/airs/lib/python3.8/site-packages/torch/nn/functional.py", line 1457, in relu
    result = torch.relu(input)
RuntimeError: CUDA out of memory. Tried to allocate 1.56 GiB (GPU 0; 10.92 GiB total capacity; 7.02 GiB already allocated; 1.27 GiB free; 8.48 GiB reserved in total by PyTorch) If reserved memory is >> allocated memory try setting max_split_size_mb to avoid fragmentation.  See documentation for Memory Management and PYTORCH_CUDA_ALLOC_CONF
Traceback (most recent call last):
  File "./vaihingen_test.py", line 1, in <module>
    import ttach as tta
ModuleNotFoundError: No module named 'ttach'
Traceback (most recent call last):
  File "./vaihingen_test.py", line 1, in <module>
    import ttach as tta
ModuleNotFoundError: No module named 'ttach'
Traceback (most recent call last):
  File "./vaihingen_test.py", line 1, in <module>
    import ttach as tta
ModuleNotFoundError: No module named 'ttach'
Traceback (most recent call last):
  File "./vaihingen_test.py", line 1, in <module>
    import ttach as tta
ModuleNotFoundError: No module named 'ttach'
Traceback (most recent call last):
  File "./vaihingen_test.py", line 1, in <module>
    import ttach as tta
ModuleNotFoundError: No module named 'ttach'
Traceback (most recent call last):
  File "./vaihingen_test.py", line 1, in <module>
    import ttach as tta
ModuleNotFoundError: No module named 'ttach'
  0%|          | 0/113 [00:00<?, ?it/s]  1%|          | 1/113 [00:08<16:26,  8.80s/it]  2%|▏         | 2/113 [00:09<07:56,  4.29s/it]  3%|▎         | 3/113 [00:10<05:08,  2.81s/it]  4%|▎         | 4/113 [00:12<03:53,  2.15s/it]  4%|▍         | 5/113 [00:13<03:12,  1.78s/it]  5%|▌         | 6/113 [00:14<02:46,  1.56s/it]  6%|▌         | 7/113 [00:15<02:31,  1.43s/it]  7%|▋         | 8/113 [00:16<02:17,  1.31s/it]  8%|▊         | 9/113 [00:17<02:09,  1.24s/it]  9%|▉         | 10/113 [00:18<02:03,  1.20s/it] 10%|▉         | 11/113 [00:19<02:00,  1.18s/it] 11%|█         | 12/113 [00:21<01:56,  1.15s/it] 12%|█▏        | 13/113 [00:22<01:53,  1.14s/it] 12%|█▏        | 14/113 [00:23<01:51,  1.13s/it] 13%|█▎        | 15/113 [00:24<01:50,  1.13s/it] 14%|█▍        | 16/113 [00:25<01:46,  1.10s/it] 15%|█▌        | 17/113 [00:26<01:46,  1.11s/it] 16%|█▌        | 18/113 [00:27<01:44,  1.10s/it] 17%|█▋        | 19/113 [00:28<01:44,  1.11s/it] 18%|█▊        | 20/113 [00:29<01:42,  1.10s/it] 19%|█▊        | 21/113 [00:30<01:40,  1.09s/it] 19%|█▉        | 22/113 [00:32<01:40,  1.11s/it] 20%|██        | 23/113 [00:33<01:38,  1.10s/it] 21%|██        | 24/113 [00:34<01:38,  1.11s/it] 22%|██▏       | 25/113 [00:35<01:37,  1.11s/it] 23%|██▎       | 26/113 [00:36<01:34,  1.09s/it] 24%|██▍       | 27/113 [00:37<01:34,  1.10s/it] 25%|██▍       | 28/113 [00:38<01:32,  1.09s/it] 26%|██▌       | 29/113 [00:39<01:32,  1.10s/it] 27%|██▋       | 30/113 [00:40<01:31,  1.11s/it] 27%|██▋       | 31/113 [00:41<01:29,  1.09s/it] 28%|██▊       | 32/113 [00:42<01:27,  1.08s/it] 29%|██▉       | 33/113 [00:44<01:27,  1.10s/it] 30%|███       | 34/113 [00:45<01:27,  1.10s/it] 31%|███       | 35/113 [00:46<01:26,  1.11s/it] 32%|███▏      | 36/113 [00:47<01:26,  1.12s/it] 33%|███▎      | 37/113 [00:48<01:24,  1.11s/it] 34%|███▎      | 38/113 [00:49<01:23,  1.12s/it] 35%|███▍      | 39/113 [00:50<01:22,  1.12s/it] 35%|███▌      | 40/113 [00:51<01:21,  1.11s/it] 36%|███▋      | 41/113 [00:52<01:19,  1.11s/it] 37%|███▋      | 42/113 [00:54<01:18,  1.10s/it] 38%|███▊      | 43/113 [00:55<01:16,  1.10s/it] 39%|███▉      | 44/113 [00:56<01:16,  1.11s/it] 40%|███▉      | 45/113 [00:57<01:14,  1.10s/it] 41%|████      | 46/113 [00:58<01:14,  1.11s/it] 42%|████▏     | 47/113 [00:59<01:13,  1.11s/it] 42%|████▏     | 48/113 [01:00<01:12,  1.11s/it] 43%|████▎     | 49/113 [01:01<01:10,  1.10s/it] 44%|████▍     | 50/113 [01:02<01:10,  1.11s/it] 45%|████▌     | 51/113 [01:04<01:09,  1.12s/it] 46%|████▌     | 52/113 [01:05<01:08,  1.12s/it] 47%|████▋     | 53/113 [01:06<01:08,  1.14s/it] 48%|████▊     | 54/113 [01:07<01:07,  1.14s/it] 49%|████▊     | 55/113 [01:08<01:05,  1.13s/it] 50%|████▉     | 56/113 [01:09<01:04,  1.13s/it] 50%|█████     | 57/113 [01:10<01:03,  1.13s/it] 51%|█████▏    | 58/113 [01:12<01:02,  1.13s/it] 52%|█████▏    | 59/113 [01:13<01:00,  1.13s/it] 53%|█████▎    | 60/113 [01:14<00:59,  1.13s/it] 54%|█████▍    | 61/113 [01:15<00:58,  1.13s/it] 55%|█████▍    | 62/113 [01:16<00:57,  1.13s/it] 56%|█████▌    | 63/113 [01:17<00:56,  1.12s/it] 57%|█████▋    | 64/113 [01:18<00:54,  1.12s/it] 58%|█████▊    | 65/113 [01:19<00:53,  1.11s/it] 58%|█████▊    | 66/113 [01:21<00:53,  1.13s/it] 59%|█████▉    | 67/113 [01:22<00:52,  1.14s/it] 60%|██████    | 68/113 [01:23<00:50,  1.12s/it] 61%|██████    | 69/113 [01:24<00:49,  1.13s/it] 62%|██████▏   | 70/113 [01:25<00:48,  1.12s/it] 63%|██████▎   | 71/113 [01:26<00:47,  1.13s/it] 64%|██████▎   | 72/113 [01:27<00:46,  1.14s/it] 65%|██████▍   | 73/113 [01:28<00:44,  1.12s/it] 65%|██████▌   | 74/113 [01:30<00:43,  1.11s/it] 66%|██████▋   | 75/113 [01:31<00:41,  1.10s/it] 67%|██████▋   | 76/113 [01:32<00:40,  1.10s/it] 68%|██████▊   | 77/113 [01:33<00:39,  1.10s/it] 69%|██████▉   | 78/113 [01:34<00:38,  1.09s/it] 70%|██████▉   | 79/113 [01:35<00:36,  1.07s/it] 71%|███████   | 80/113 [01:36<00:35,  1.06s/it] 72%|███████▏  | 81/113 [01:37<00:33,  1.06s/it] 73%|███████▎  | 82/113 [01:38<00:32,  1.05s/it] 73%|███████▎  | 83/113 [01:39<00:31,  1.06s/it] 74%|███████▍  | 84/113 [01:40<00:31,  1.08s/it] 75%|███████▌  | 85/113 [01:41<00:30,  1.09s/it] 76%|███████▌  | 86/113 [01:42<00:29,  1.09s/it] 77%|███████▋  | 87/113 [01:43<00:28,  1.09s/it] 78%|███████▊  | 88/113 [01:45<00:27,  1.10s/it] 79%|███████▉  | 89/113 [01:46<00:26,  1.10s/it] 80%|███████▉  | 90/113 [01:47<00:25,  1.10s/it] 81%|████████  | 91/113 [01:48<00:24,  1.09s/it] 81%|████████▏ | 92/113 [01:49<00:22,  1.09s/it] 82%|████████▏ | 93/113 [01:50<00:22,  1.10s/it] 83%|████████▎ | 94/113 [01:51<00:21,  1.11s/it] 84%|████████▍ | 95/113 [01:52<00:20,  1.12s/it] 85%|████████▍ | 96/113 [01:53<00:18,  1.09s/it] 86%|████████▌ | 97/113 [01:54<00:17,  1.09s/it] 87%|████████▋ | 98/113 [01:56<00:16,  1.08s/it] 88%|████████▊ | 99/113 [01:57<00:15,  1.09s/it] 88%|████████▊ | 100/113 [01:58<00:14,  1.08s/it] 89%|████████▉ | 101/113 [01:59<00:12,  1.07s/it] 90%|█████████ | 102/113 [02:00<00:11,  1.07s/it] 91%|█████████ | 103/113 [02:01<00:10,  1.07s/it] 92%|█████████▏| 104/113 [02:02<00:09,  1.08s/it] 93%|█████████▎| 105/113 [02:03<00:08,  1.07s/it] 94%|█████████▍| 106/113 [02:04<00:07,  1.07s/it] 95%|█████████▍| 107/113 [02:05<00:06,  1.08s/it] 96%|█████████▌| 108/113 [02:06<00:05,  1.08s/it] 96%|█████████▋| 109/113 [02:07<00:04,  1.08s/it] 97%|█████████▋| 110/113 [02:08<00:03,  1.08s/it] 98%|█████████▊| 111/113 [02:10<00:02,  1.08s/it] 99%|█████████▉| 112/113 [02:11<00:01,  1.08s/it]100%|██████████| 113/113 [02:12<00:00,  1.08s/it]100%|██████████| 113/113 [02:12<00:00,  1.17s/it]
  0%|          | 0/113 [00:00<?, ?it/s]  1%|          | 1/113 [00:11<21:46, 11.67s/it]  2%|▏         | 2/113 [00:15<13:06,  7.08s/it]  3%|▎         | 3/113 [00:19<10:14,  5.59s/it]  4%|▎         | 4/113 [00:23<08:58,  4.94s/it]  4%|▍         | 5/113 [00:27<08:13,  4.57s/it]  5%|▌         | 6/113 [00:31<07:45,  4.35s/it]  6%|▌         | 7/113 [00:35<07:27,  4.22s/it]  7%|▋         | 8/113 [00:39<07:14,  4.13s/it]  8%|▊         | 9/113 [00:43<07:05,  4.09s/it]  9%|▉         | 10/113 [00:46<06:54,  4.02s/it] 10%|▉         | 11/113 [00:50<06:48,  4.00s/it] 11%|█         | 12/113 [00:54<06:43,  3.99s/it] 12%|█▏        | 13/113 [00:58<06:40,  4.01s/it] 12%|█▏        | 14/113 [01:02<06:34,  3.99s/it] 13%|█▎        | 15/113 [01:06<06:30,  3.98s/it] 14%|█▍        | 16/113 [01:10<06:23,  3.96s/it] 15%|█▌        | 17/113 [01:14<06:21,  3.97s/it] 16%|█▌        | 18/113 [01:18<06:16,  3.97s/it] 17%|█▋        | 19/113 [01:22<06:11,  3.95s/it] 18%|█▊        | 20/113 [01:26<06:06,  3.94s/it] 19%|█▊        | 21/113 [01:30<06:01,  3.93s/it] 19%|█▉        | 22/113 [01:34<05:58,  3.94s/it] 20%|██        | 23/113 [01:38<05:53,  3.93s/it] 21%|██        | 24/113 [01:42<05:50,  3.93s/it] 22%|██▏       | 25/113 [01:46<05:46,  3.94s/it] 23%|██▎       | 26/113 [01:49<05:40,  3.91s/it] 24%|██▍       | 27/113 [01:53<05:36,  3.92s/it] 25%|██▍       | 28/113 [01:57<05:31,  3.90s/it] 26%|██▌       | 29/113 [02:01<05:28,  3.92s/it] 27%|██▋       | 30/113 [02:05<05:23,  3.89s/it] 27%|██▋       | 31/113 [02:09<05:18,  3.89s/it] 28%|██▊       | 32/113 [02:13<05:16,  3.90s/it] 29%|██▉       | 33/113 [02:17<05:13,  3.92s/it] 30%|███       | 34/113 [02:21<05:10,  3.93s/it] 31%|███       | 35/113 [02:25<05:07,  3.94s/it] 32%|███▏      | 36/113 [02:29<05:03,  3.94s/it] 33%|███▎      | 37/113 [02:33<04:57,  3.91s/it] 34%|███▎      | 38/113 [02:37<04:54,  3.93s/it] 35%|███▍      | 39/113 [02:41<04:51,  3.94s/it] 35%|███▌      | 40/113 [02:44<04:47,  3.94s/it] 36%|███▋      | 41/113 [02:48<04:41,  3.91s/it] 37%|███▋      | 42/113 [02:52<04:38,  3.93s/it] 38%|███▊      | 43/113 [02:56<04:35,  3.94s/it] 39%|███▉      | 44/113 [03:00<04:32,  3.95s/it] 40%|███▉      | 45/113 [03:04<04:28,  3.95s/it] 41%|████      | 46/113 [03:08<04:24,  3.94s/it] 42%|████▏     | 47/113 [03:12<04:20,  3.95s/it] 42%|████▏     | 48/113 [03:16<04:16,  3.95s/it] 43%|████▎     | 49/113 [03:20<04:15,  3.99s/it] 44%|████▍     | 50/113 [03:24<04:10,  3.97s/it] 45%|████▌     | 51/113 [03:28<04:06,  3.98s/it] 46%|████▌     | 52/113 [03:32<04:03,  4.00s/it] 47%|████▋     | 53/113 [03:36<03:58,  3.97s/it] 48%|████▊     | 54/113 [03:40<03:54,  3.98s/it] 49%|████▊     | 55/113 [03:44<03:50,  3.98s/it] 50%|████▉     | 56/113 [03:48<03:46,  3.98s/it] 50%|█████     | 57/113 [03:52<03:43,  3.99s/it] 51%|█████▏    | 58/113 [03:56<03:38,  3.97s/it] 52%|█████▏    | 59/113 [04:00<03:34,  3.97s/it] 53%|█████▎    | 60/113 [04:04<03:30,  3.97s/it] 54%|█████▍    | 61/113 [04:08<03:26,  3.97s/it] 55%|█████▍    | 62/113 [04:12<03:22,  3.96s/it] 56%|█████▌    | 63/113 [04:16<03:18,  3.97s/it] 57%|█████▋    | 64/113 [04:20<03:13,  3.95s/it] 58%|█████▊    | 65/113 [04:24<03:10,  3.96s/it] 58%|█████▊    | 66/113 [04:27<03:05,  3.94s/it] 59%|█████▉    | 67/113 [04:31<03:02,  3.97s/it] 60%|██████    | 68/113 [04:35<02:57,  3.94s/it] 61%|██████    | 69/113 [04:39<02:53,  3.94s/it] 62%|██████▏   | 70/113 [04:43<02:50,  3.96s/it] 63%|██████▎   | 71/113 [04:47<02:45,  3.95s/it] 64%|██████▎   | 72/113 [04:51<02:41,  3.93s/it] 65%|██████▍   | 73/113 [04:55<02:38,  3.95s/it] 65%|██████▌   | 74/113 [04:59<02:34,  3.95s/it] 66%|██████▋   | 75/113 [05:03<02:30,  3.96s/it] 67%|██████▋   | 76/113 [05:07<02:27,  3.98s/it] 68%|██████▊   | 77/113 [05:11<02:22,  3.96s/it] 69%|██████▉   | 78/113 [05:15<02:18,  3.96s/it] 70%|██████▉   | 79/113 [05:19<02:14,  3.96s/it] 71%|███████   | 80/113 [05:23<02:09,  3.94s/it] 72%|███████▏  | 81/113 [05:27<02:04,  3.90s/it] 73%|███████▎  | 82/113 [05:31<02:01,  3.92s/it] 73%|███████▎  | 83/113 [05:35<01:57,  3.93s/it] 74%|███████▍  | 84/113 [05:38<01:54,  3.94s/it] 75%|███████▌  | 85/113 [05:42<01:50,  3.96s/it] 76%|███████▌  | 86/113 [05:46<01:47,  3.97s/it] 77%|███████▋  | 87/113 [05:50<01:43,  3.97s/it] 78%|███████▊  | 88/113 [05:55<01:40,  4.00s/it] 79%|███████▉  | 89/113 [05:58<01:35,  3.99s/it] 80%|███████▉  | 90/113 [06:02<01:31,  3.98s/it] 81%|████████  | 91/113 [06:06<01:27,  3.96s/it] 81%|████████▏ | 92/113 [06:10<01:22,  3.95s/it] 82%|████████▏ | 93/113 [06:14<01:20,  4.00s/it] 83%|████████▎ | 94/113 [06:18<01:16,  4.00s/it] 84%|████████▍ | 95/113 [06:22<01:11,  3.98s/it] 85%|████████▍ | 96/113 [06:26<01:07,  3.96s/it] 86%|████████▌ | 97/113 [06:30<01:03,  3.94s/it] 87%|████████▋ | 98/113 [06:34<00:59,  3.94s/it] 88%|████████▊ | 99/113 [06:38<00:55,  3.95s/it] 88%|████████▊ | 100/113 [06:42<00:51,  3.95s/it] 89%|████████▉ | 101/113 [06:46<00:47,  3.98s/it] 90%|█████████ | 102/113 [06:50<00:43,  3.97s/it] 91%|█████████ | 103/113 [06:54<00:40,  4.01s/it] 92%|█████████▏| 104/113 [06:58<00:35,  3.99s/it] 93%|█████████▎| 105/113 [07:02<00:32,  4.00s/it] 94%|█████████▍| 106/113 [07:06<00:27,  3.98s/it] 95%|█████████▍| 107/113 [07:10<00:23,  3.97s/it] 96%|█████████▌| 108/113 [07:14<00:19,  3.98s/it] 96%|█████████▋| 109/113 [07:18<00:15,  3.98s/it] 97%|█████████▋| 110/113 [07:22<00:11,  3.99s/it] 98%|█████████▊| 111/113 [07:26<00:07,  3.98s/it] 99%|█████████▉| 112/113 [07:30<00:03,  3.97s/it]100%|██████████| 113/113 [07:34<00:00,  3.95s/it]100%|██████████| 113/113 [07:34<00:00,  4.02s/it]
  0%|          | 0/113 [00:00<?, ?it/s]  1%|          | 1/113 [00:29<55:59, 29.99s/it]  2%|▏         | 2/113 [00:42<36:09, 19.54s/it]  3%|▎         | 3/113 [00:54<29:36, 16.15s/it]  4%|▎         | 4/113 [01:06<26:23, 14.53s/it]  4%|▍         | 5/113 [01:18<24:34, 13.65s/it]  5%|▌         | 6/113 [01:30<23:23, 13.11s/it]  6%|▌         | 7/113 [01:42<22:36, 12.80s/it]  7%|▋         | 8/113 [01:54<21:57, 12.54s/it]  8%|▊         | 9/113 [02:06<21:26, 12.37s/it]  9%|▉         | 10/113 [02:18<21:04, 12.28s/it] 10%|▉         | 11/113 [02:30<20:45, 12.21s/it] 11%|█         | 12/113 [02:42<20:26, 12.14s/it] 12%|█▏        | 13/113 [02:54<20:13, 12.14s/it] 12%|█▏        | 14/113 [03:07<20:01, 12.13s/it] 13%|█▎        | 15/113 [03:19<19:52, 12.17s/it] 14%|█▍        | 16/113 [03:31<19:37, 12.14s/it] 15%|█▌        | 17/113 [03:43<19:30, 12.19s/it] 16%|█▌        | 18/113 [03:55<19:15, 12.17s/it] 17%|█▋        | 19/113 [04:07<19:01, 12.15s/it] 18%|█▊        | 20/113 [04:19<18:48, 12.13s/it] 19%|█▊        | 21/113 [04:32<18:38, 12.15s/it] 19%|█▉        | 22/113 [04:44<18:25, 12.15s/it] 20%|██        | 23/113 [04:56<18:12, 12.14s/it] 21%|██        | 24/113 [05:08<18:02, 12.16s/it] 22%|██▏       | 25/113 [05:20<17:53, 12.20s/it] 23%|██▎       | 26/113 [05:33<17:41, 12.20s/it] 24%|██▍       | 27/113 [05:45<17:32, 12.24s/it] 25%|██▍       | 28/113 [05:57<17:13, 12.16s/it] 26%|██▌       | 29/113 [06:09<17:05, 12.21s/it] 27%|██▋       | 30/113 [06:21<16:50, 12.18s/it] 27%|██▋       | 31/113 [06:33<16:34, 12.13s/it] 28%|██▊       | 32/113 [06:45<16:19, 12.09s/it] 29%|██▉       | 33/113 [06:58<16:08, 12.11s/it] 30%|███       | 34/113 [07:10<15:58, 12.13s/it] 31%|███       | 35/113 [07:22<15:45, 12.12s/it] 32%|███▏      | 36/113 [07:34<15:39, 12.20s/it] 33%|███▎      | 37/113 [07:46<15:23, 12.15s/it] 34%|███▎      | 38/113 [07:59<15:14, 12.19s/it] 35%|███▍      | 39/113 [08:11<14:57, 12.13s/it] 35%|███▌      | 40/113 [08:23<14:48, 12.17s/it] 36%|███▋      | 41/113 [08:35<14:36, 12.18s/it] 37%|███▋      | 42/113 [08:47<14:23, 12.16s/it] 38%|███▊      | 43/113 [08:59<14:08, 12.12s/it] 39%|███▉      | 44/113 [09:11<13:56, 12.13s/it] 40%|███▉      | 45/113 [09:23<13:43, 12.11s/it] 41%|████      | 46/113 [09:36<13:32, 12.13s/it] 42%|████▏     | 47/113 [09:48<13:22, 12.15s/it] 42%|████▏     | 48/113 [10:00<13:12, 12.19s/it] 43%|████▎     | 49/113 [10:12<12:57, 12.15s/it] 44%|████▍     | 50/113 [10:24<12:47, 12.18s/it] 45%|████▌     | 51/113 [10:36<12:33, 12.15s/it] 46%|████▌     | 52/113 [10:49<12:21, 12.15s/it] 47%|████▋     | 53/113 [11:01<12:07, 12.13s/it] 48%|████▊     | 54/113 [11:13<11:57, 12.16s/it] 49%|████▊     | 55/113 [11:25<11:44, 12.15s/it] 50%|████▉     | 56/113 [11:37<11:34, 12.18s/it] 50%|█████     | 57/113 [11:49<11:21, 12.17s/it] 51%|█████▏    | 58/113 [12:01<11:07, 12.14s/it] 52%|█████▏    | 59/113 [12:14<10:58, 12.20s/it] 53%|█████▎    | 60/113 [12:26<10:47, 12.21s/it] 54%|█████▍    | 61/113 [12:38<10:35, 12.22s/it] 55%|█████▍    | 62/113 [12:51<10:23, 12.22s/it] 56%|█████▌    | 63/113 [13:03<10:10, 12.21s/it] 57%|█████▋    | 64/113 [13:15<09:58, 12.21s/it] 58%|█████▊    | 65/113 [13:27<09:44, 12.17s/it] 58%|█████▊    | 66/113 [13:39<09:32, 12.18s/it] 59%|█████▉    | 67/113 [13:51<09:22, 12.22s/it] 60%|██████    | 68/113 [14:04<09:07, 12.17s/it] 61%|██████    | 69/113 [14:16<08:55, 12.17s/it] 62%|██████▏   | 70/113 [14:28<08:41, 12.14s/it] 63%|██████▎   | 71/113 [14:40<08:31, 12.17s/it] 64%|██████▎   | 72/113 [14:52<08:19, 12.18s/it] 65%|██████▍   | 73/113 [15:04<08:07, 12.18s/it] 65%|██████▌   | 74/113 [15:17<07:54, 12.17s/it] 66%|██████▋   | 75/113 [15:29<07:44, 12.24s/it] 67%|██████▋   | 76/113 [15:41<07:33, 12.24s/it] 68%|██████▊   | 77/113 [15:53<07:18, 12.17s/it] 69%|██████▉   | 78/113 [16:05<07:06, 12.20s/it] 70%|██████▉   | 79/113 [16:18<06:53, 12.16s/it] 71%|███████   | 80/113 [16:30<06:39, 12.11s/it] 72%|███████▏  | 81/113 [16:42<06:27, 12.11s/it] 73%|███████▎  | 82/113 [16:54<06:16, 12.14s/it] 73%|███████▎  | 83/113 [17:06<06:04, 12.15s/it] 74%|███████▍  | 84/113 [17:18<05:52, 12.16s/it] 75%|███████▌  | 85/113 [17:30<05:40, 12.15s/it] 76%|███████▌  | 86/113 [17:43<05:28, 12.18s/it] 77%|███████▋  | 87/113 [17:55<05:17, 12.20s/it] 78%|███████▊  | 88/113 [18:07<05:05, 12.21s/it] 79%|███████▉  | 89/113 [18:19<04:51, 12.16s/it] 80%|███████▉  | 90/113 [18:31<04:39, 12.17s/it] 81%|████████  | 91/113 [18:44<04:28, 12.18s/it] 81%|████████▏ | 92/113 [18:56<04:15, 12.16s/it] 82%|████████▏ | 93/113 [19:08<04:03, 12.20s/it] 83%|████████▎ | 94/113 [19:20<03:53, 12.27s/it] 84%|████████▍ | 95/113 [19:33<03:40, 12.24s/it] 85%|████████▍ | 96/113 [19:45<03:26, 12.17s/it] 86%|████████▌ | 97/113 [19:57<03:15, 12.19s/it] 87%|████████▋ | 98/113 [20:09<03:02, 12.18s/it] 88%|████████▊ | 99/113 [20:21<02:50, 12.19s/it] 88%|████████▊ | 100/113 [20:33<02:37, 12.14s/it] 89%|████████▉ | 101/113 [20:45<02:25, 12.13s/it] 90%|█████████ | 102/113 [20:58<02:13, 12.17s/it] 91%|█████████ | 103/113 [21:10<02:02, 12.25s/it] 92%|█████████▏| 104/113 [21:22<01:49, 12.20s/it] 93%|█████████▎| 105/113 [21:34<01:37, 12.18s/it] 94%|█████████▍| 106/113 [21:47<01:25, 12.23s/it] 95%|█████████▍| 107/113 [21:59<01:13, 12.19s/it] 96%|█████████▌| 108/113 [22:11<01:00, 12.20s/it] 96%|█████████▋| 109/113 [22:23<00:49, 12.25s/it] 97%|█████████▋| 110/113 [22:35<00:36, 12.23s/it] 98%|█████████▊| 111/113 [22:48<00:24, 12.20s/it] 99%|█████████▉| 112/113 [23:00<00:12, 12.25s/it]100%|██████████| 113/113 [23:12<00:00, 12.22s/it]100%|██████████| 113/113 [23:12<00:00, 12.32s/it]
/disk1/lhl/workspace/unetformer/GeoSeg/tools/metric.py:31: RuntimeWarning:

invalid value encountered in divide

  0%|          | 0/113 [00:00<?, ?it/s]  1%|          | 1/113 [00:08<16:20,  8.76s/it]  2%|▏         | 2/113 [00:09<07:49,  4.23s/it]  3%|▎         | 3/113 [00:10<05:03,  2.76s/it]  4%|▎         | 4/113 [00:11<03:47,  2.09s/it]  4%|▍         | 5/113 [00:12<03:04,  1.71s/it]  5%|▌         | 6/113 [00:13<02:39,  1.49s/it]  6%|▌         | 7/113 [00:15<02:23,  1.35s/it]  7%|▋         | 8/113 [00:16<02:11,  1.25s/it]  8%|▊         | 9/113 [00:17<02:02,  1.18s/it]  9%|▉         | 10/113 [00:18<01:56,  1.13s/it] 10%|▉         | 11/113 [00:19<01:53,  1.11s/it] 11%|█         | 12/113 [00:20<01:49,  1.09s/it] 12%|█▏        | 13/113 [00:21<01:47,  1.08s/it] 12%|█▏        | 14/113 [00:22<01:46,  1.07s/it] 13%|█▎        | 15/113 [00:23<01:45,  1.07s/it] 14%|█▍        | 16/113 [00:24<01:42,  1.06s/it] 15%|█▌        | 17/113 [00:25<01:41,  1.06s/it] 16%|█▌        | 18/113 [00:26<01:41,  1.07s/it] 17%|█▋        | 19/113 [00:27<01:40,  1.07s/it] 18%|█▊        | 20/113 [00:28<01:38,  1.06s/it] 19%|█▊        | 21/113 [00:29<01:37,  1.06s/it] 19%|█▉        | 22/113 [00:30<01:36,  1.06s/it] 20%|██        | 23/113 [00:31<01:34,  1.05s/it] 21%|██        | 24/113 [00:32<01:32,  1.04s/it] 22%|██▏       | 25/113 [00:33<01:32,  1.05s/it] 23%|██▎       | 26/113 [00:34<01:30,  1.04s/it] 24%|██▍       | 27/113 [00:36<01:30,  1.05s/it] 25%|██▍       | 28/113 [00:37<01:29,  1.05s/it] 26%|██▌       | 29/113 [00:38<01:28,  1.06s/it] 27%|██▋       | 30/113 [00:39<01:27,  1.05s/it] 27%|██▋       | 31/113 [00:40<01:26,  1.06s/it] 28%|██▊       | 32/113 [00:41<01:25,  1.06s/it] 29%|██▉       | 33/113 [00:42<01:25,  1.07s/it] 30%|███       | 34/113 [00:43<01:24,  1.07s/it] 31%|███       | 35/113 [00:44<01:24,  1.08s/it] 32%|███▏      | 36/113 [00:45<01:23,  1.09s/it] 33%|███▎      | 37/113 [00:46<01:22,  1.08s/it] 34%|███▎      | 38/113 [00:47<01:21,  1.09s/it] 35%|███▍      | 39/113 [00:48<01:19,  1.08s/it] 35%|███▌      | 40/113 [00:49<01:18,  1.07s/it] 36%|███▋      | 41/113 [00:51<01:16,  1.06s/it] 37%|███▋      | 42/113 [00:52<01:16,  1.07s/it] 38%|███▊      | 43/113 [00:53<01:15,  1.08s/it] 39%|███▉      | 44/113 [00:54<01:14,  1.08s/it] 40%|███▉      | 45/113 [00:55<01:13,  1.08s/it] 41%|████      | 46/113 [00:56<01:12,  1.09s/it] 42%|████▏     | 47/113 [00:57<01:11,  1.08s/it] 42%|████▏     | 48/113 [00:58<01:09,  1.07s/it] 43%|████▎     | 49/113 [00:59<01:08,  1.07s/it] 44%|████▍     | 50/113 [01:00<01:08,  1.08s/it] 45%|████▌     | 51/113 [01:01<01:06,  1.08s/it] 46%|████▌     | 52/113 [01:02<01:05,  1.08s/it] 47%|████▋     | 53/113 [01:04<01:04,  1.08s/it] 48%|████▊     | 54/113 [01:05<01:04,  1.09s/it] 49%|████▊     | 55/113 [01:06<01:02,  1.08s/it] 50%|████▉     | 56/113 [01:07<01:02,  1.09s/it] 50%|█████     | 57/113 [01:08<01:01,  1.10s/it] 51%|█████▏    | 58/113 [01:09<00:59,  1.08s/it] 52%|█████▏    | 59/113 [01:10<00:58,  1.09s/it] 53%|█████▎    | 60/113 [01:11<00:58,  1.10s/it] 54%|█████▍    | 61/113 [01:12<00:56,  1.10s/it] 55%|█████▍    | 62/113 [01:13<00:56,  1.10s/it] 56%|█████▌    | 63/113 [01:14<00:54,  1.10s/it] 57%|█████▋    | 64/113 [01:16<00:53,  1.10s/it] 58%|█████▊    | 65/113 [01:17<00:52,  1.09s/it] 58%|█████▊    | 66/113 [01:18<00:51,  1.10s/it] 59%|█████▉    | 67/113 [01:19<00:50,  1.11s/it] 60%|██████    | 68/113 [01:20<00:49,  1.11s/it] 61%|██████    | 69/113 [01:21<00:48,  1.10s/it] 62%|██████▏   | 70/113 [01:22<00:47,  1.10s/it] 63%|██████▎   | 71/113 [01:23<00:45,  1.09s/it] 64%|██████▎   | 72/113 [01:24<00:44,  1.08s/it] 65%|██████▍   | 73/113 [01:25<00:43,  1.09s/it] 65%|██████▌   | 74/113 [01:27<00:42,  1.10s/it] 66%|██████▋   | 75/113 [01:28<00:41,  1.09s/it] 67%|██████▋   | 76/113 [01:29<00:40,  1.09s/it] 68%|██████▊   | 77/113 [01:30<00:39,  1.09s/it] 69%|██████▉   | 78/113 [01:31<00:38,  1.09s/it] 70%|██████▉   | 79/113 [01:32<00:36,  1.07s/it] 71%|███████   | 80/113 [01:33<00:35,  1.07s/it] 72%|███████▏  | 81/113 [01:34<00:34,  1.08s/it] 73%|███████▎  | 82/113 [01:35<00:33,  1.07s/it] 73%|███████▎  | 83/113 [01:36<00:32,  1.08s/it] 74%|███████▍  | 84/113 [01:37<00:31,  1.09s/it] 75%|███████▌  | 85/113 [01:38<00:30,  1.10s/it] 76%|███████▌  | 86/113 [01:40<00:29,  1.10s/it] 77%|███████▋  | 87/113 [01:41<00:28,  1.11s/it] 78%|███████▊  | 88/113 [01:42<00:27,  1.10s/it] 79%|███████▉  | 89/113 [01:43<00:26,  1.10s/it] 80%|███████▉  | 90/113 [01:44<00:24,  1.09s/it] 81%|████████  | 91/113 [01:45<00:23,  1.08s/it] 81%|████████▏ | 92/113 [01:46<00:22,  1.08s/it] 82%|████████▏ | 93/113 [01:47<00:21,  1.09s/it] 83%|████████▎ | 94/113 [01:48<00:20,  1.10s/it] 84%|████████▍ | 95/113 [01:49<00:19,  1.11s/it] 85%|████████▍ | 96/113 [01:50<00:18,  1.09s/it] 86%|████████▌ | 97/113 [01:52<00:17,  1.08s/it] 87%|████████▋ | 98/113 [01:53<00:15,  1.06s/it] 88%|████████▊ | 99/113 [01:54<00:14,  1.07s/it] 88%|████████▊ | 100/113 [01:55<00:14,  1.08s/it] 89%|████████▉ | 101/113 [01:56<00:12,  1.08s/it] 90%|█████████ | 102/113 [01:57<00:11,  1.08s/it] 91%|█████████ | 103/113 [01:58<00:10,  1.09s/it] 92%|█████████▏| 104/113 [01:59<00:09,  1.09s/it] 93%|█████████▎| 105/113 [02:00<00:08,  1.08s/it] 94%|█████████▍| 106/113 [02:01<00:07,  1.08s/it] 95%|█████████▍| 107/113 [02:02<00:06,  1.08s/it] 96%|█████████▌| 108/113 [02:03<00:05,  1.08s/it] 96%|█████████▋| 109/113 [02:04<00:04,  1.06s/it] 97%|█████████▋| 110/113 [02:05<00:03,  1.06s/it] 98%|█████████▊| 111/113 [02:07<00:02,  1.07s/it] 99%|█████████▉| 112/113 [02:08<00:01,  1.08s/it]100%|██████████| 113/113 [02:09<00:00,  1.09s/it]100%|██████████| 113/113 [02:09<00:00,  1.14s/it]
  0%|          | 0/113 [00:00<?, ?it/s]  1%|          | 1/113 [00:11<21:41, 11.62s/it]  2%|▏         | 2/113 [00:15<13:03,  7.06s/it]  3%|▎         | 3/113 [00:19<10:12,  5.57s/it]  4%|▎         | 4/113 [00:23<08:56,  4.92s/it]  4%|▍         | 5/113 [00:27<08:11,  4.55s/it]  5%|▌         | 6/113 [00:31<07:45,  4.35s/it]  6%|▌         | 7/113 [00:35<07:27,  4.22s/it]  7%|▋         | 8/113 [00:38<07:14,  4.14s/it]  8%|▊         | 9/113 [00:42<07:02,  4.06s/it]  9%|▉         | 10/113 [00:46<06:55,  4.04s/it] 10%|▉         | 11/113 [00:50<06:47,  4.00s/it] 11%|█         | 12/113 [00:54<06:42,  3.98s/it] 12%|█▏        | 13/113 [00:58<06:39,  3.99s/it] 12%|█▏        | 14/113 [01:02<06:31,  3.96s/it] 13%|█▎        | 15/113 [01:06<06:28,  3.97s/it] 14%|█▍        | 16/113 [01:10<06:24,  3.96s/it] 15%|█▌        | 17/113 [01:14<06:18,  3.95s/it] 16%|█▌        | 18/113 [01:18<06:15,  3.95s/it] 17%|█▋        | 19/113 [01:22<06:12,  3.96s/it] 18%|█▊        | 20/113 [01:26<06:06,  3.94s/it] 19%|█▊        | 21/113 [01:30<06:04,  3.96s/it] 19%|█▉        | 22/113 [01:34<06:00,  3.97s/it] 20%|██        | 23/113 [01:38<05:54,  3.93s/it] 21%|██        | 24/113 [01:42<05:52,  3.96s/it] 22%|██▏       | 25/113 [01:46<05:47,  3.94s/it] 23%|██▎       | 26/113 [01:50<05:43,  3.95s/it] 24%|██▍       | 27/113 [01:54<05:40,  3.96s/it] 25%|██▍       | 28/113 [01:57<05:33,  3.92s/it] 26%|██▌       | 29/113 [02:01<05:28,  3.91s/it] 27%|██▋       | 30/113 [02:05<05:24,  3.90s/it] 27%|██▋       | 31/113 [02:09<05:19,  3.90s/it] 28%|██▊       | 32/113 [02:13<05:14,  3.88s/it] 29%|██▉       | 33/113 [02:17<05:12,  3.90s/it] 30%|███       | 34/113 [02:21<05:08,  3.91s/it] 31%|███       | 35/113 [02:25<05:04,  3.91s/it] 32%|███▏      | 36/113 [02:29<05:01,  3.91s/it] 33%|███▎      | 37/113 [02:32<04:57,  3.91s/it] 34%|███▎      | 38/113 [02:36<04:55,  3.94s/it] 35%|███▍      | 39/113 [02:40<04:49,  3.92s/it] 35%|███▌      | 40/113 [02:44<04:45,  3.91s/it] 36%|███▋      | 41/113 [02:48<04:40,  3.90s/it] 37%|███▋      | 42/113 [02:52<04:38,  3.92s/it] 38%|███▊      | 43/113 [02:56<04:32,  3.89s/it] 39%|███▉      | 44/113 [03:00<04:30,  3.91s/it] 40%|███▉      | 45/113 [03:04<04:26,  3.91s/it] 41%|████      | 46/113 [03:08<04:23,  3.93s/it] 42%|████▏     | 47/113 [03:12<04:21,  3.96s/it] 42%|████▏     | 48/113 [03:16<04:15,  3.93s/it] 43%|████▎     | 49/113 [03:20<04:10,  3.91s/it] 44%|████▍     | 50/113 [03:23<04:05,  3.89s/it] 45%|████▌     | 51/113 [03:27<04:02,  3.91s/it] 46%|████▌     | 52/113 [03:31<03:58,  3.92s/it] 47%|████▋     | 53/113 [03:35<03:55,  3.93s/it] 48%|████▊     | 54/113 [03:39<03:53,  3.96s/it] 49%|████▊     | 55/113 [03:43<03:48,  3.94s/it] 50%|████▉     | 56/113 [03:47<03:44,  3.94s/it] 50%|█████     | 57/113 [03:51<03:40,  3.94s/it] 51%|█████▏    | 58/113 [03:55<03:37,  3.95s/it] 52%|█████▏    | 59/113 [03:59<03:33,  3.94s/it] 53%|█████▎    | 60/113 [04:03<03:29,  3.95s/it] 54%|█████▍    | 61/113 [04:07<03:26,  3.97s/it] 55%|█████▍    | 62/113 [04:11<03:21,  3.96s/it] 56%|█████▌    | 63/113 [04:15<03:18,  3.97s/it] 57%|█████▋    | 64/113 [04:19<03:13,  3.94s/it] 58%|█████▊    | 65/113 [04:23<03:08,  3.92s/it] 58%|█████▊    | 66/113 [04:27<03:05,  3.94s/it] 59%|█████▉    | 67/113 [04:31<03:02,  3.96s/it] 60%|██████    | 68/113 [04:34<02:56,  3.93s/it] 61%|██████    | 69/113 [04:38<02:53,  3.95s/it] 62%|██████▏   | 70/113 [04:42<02:49,  3.93s/it] 63%|██████▎   | 71/113 [04:46<02:45,  3.93s/it] 64%|██████▎   | 72/113 [04:50<02:41,  3.94s/it] 65%|██████▍   | 73/113 [04:54<02:37,  3.94s/it] 65%|██████▌   | 74/113 [04:58<02:32,  3.92s/it] 66%|██████▋   | 75/113 [05:02<02:28,  3.92s/it] 67%|██████▋   | 76/113 [05:06<02:24,  3.90s/it] 68%|██████▊   | 77/113 [05:10<02:20,  3.91s/it] 69%|██████▉   | 78/113 [05:14<02:17,  3.91s/it] 70%|██████▉   | 79/113 [05:18<02:12,  3.90s/it] 71%|███████   | 80/113 [05:21<02:08,  3.89s/it] 72%|███████▏  | 81/113 [05:25<02:04,  3.88s/it] 73%|███████▎  | 82/113 [05:29<01:59,  3.86s/it] 73%|███████▎  | 83/113 [05:33<01:56,  3.88s/it] 74%|███████▍  | 84/113 [05:37<01:53,  3.93s/it] 75%|███████▌  | 85/113 [05:41<01:50,  3.95s/it] 76%|███████▌  | 86/113 [05:45<01:46,  3.93s/it] 77%|███████▋  | 87/113 [05:49<01:42,  3.93s/it] 78%|███████▊  | 88/113 [05:53<01:38,  3.92s/it] 79%|███████▉  | 89/113 [05:57<01:33,  3.91s/it] 80%|███████▉  | 90/113 [06:01<01:29,  3.90s/it] 81%|████████  | 91/113 [06:04<01:25,  3.89s/it] 81%|████████▏ | 92/113 [06:08<01:22,  3.91s/it] 82%|████████▏ | 93/113 [06:12<01:18,  3.94s/it] 83%|████████▎ | 94/113 [06:16<01:14,  3.93s/it] 84%|████████▍ | 95/113 [06:20<01:10,  3.92s/it] 85%|████████▍ | 96/113 [06:24<01:06,  3.89s/it] 86%|████████▌ | 97/113 [06:28<01:02,  3.90s/it] 87%|████████▋ | 98/113 [06:32<00:58,  3.93s/it] 88%|████████▊ | 99/113 [06:36<00:55,  3.93s/it] 88%|████████▊ | 100/113 [06:40<00:51,  3.94s/it] 89%|████████▉ | 101/113 [06:44<00:47,  3.96s/it] 90%|█████████ | 102/113 [06:48<00:43,  3.94s/it] 91%|█████████ | 103/113 [06:52<00:39,  3.95s/it] 92%|█████████▏| 104/113 [06:56<00:35,  3.96s/it] 93%|█████████▎| 105/113 [07:00<00:31,  3.94s/it] 94%|█████████▍| 106/113 [07:03<00:27,  3.94s/it] 95%|█████████▍| 107/113 [07:07<00:23,  3.95s/it] 96%|█████████▌| 108/113 [07:11<00:19,  3.92s/it] 96%|█████████▋| 109/113 [07:15<00:15,  3.93s/it] 97%|█████████▋| 110/113 [07:19<00:11,  3.92s/it] 98%|█████████▊| 111/113 [07:23<00:07,  3.92s/it] 99%|█████████▉| 112/113 [07:27<00:03,  3.90s/it]100%|██████████| 113/113 [07:31<00:00,  3.90s/it]100%|██████████| 113/113 [07:31<00:00,  3.99s/it]
  0%|          | 0/113 [00:00<?, ?it/s]  0%|          | 0/113 [00:18<?, ?it/s]
Traceback (most recent call last):
  File "./vaihingen_test.py", line 135, in <module>
    main()
  File "./vaihingen_test.py", line 107, in main
    raw_predictions = model(img)
  File "/disk1/lhl/env/airs/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1130, in _call_impl
    return forward_call(*input, **kwargs)
  File "/disk1/lhl/env/airs/lib/python3.8/site-packages/ttach/wrappers.py", line 39, in forward
    augmented_output = self.model(augmented_image, *args)
  File "/disk1/lhl/env/airs/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1130, in _call_impl
    return forward_call(*input, **kwargs)
  File "/disk1/lhl/workspace/unetformer/GeoSeg/train_supervision.py", line 47, in forward
    seg_pre = self.net(x)
  File "/disk1/lhl/env/airs/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1130, in _call_impl
    return forward_call(*input, **kwargs)
  File "/disk1/lhl/workspace/unetformer/GeoSeg/geoseg/models/HRNet.py", line 150, in forward
    c = self.cls_head(feats)
  File "/disk1/lhl/env/airs/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1130, in _call_impl
    return forward_call(*input, **kwargs)
  File "/disk1/lhl/env/airs/lib/python3.8/site-packages/torch/nn/modules/container.py", line 139, in forward
    input = module(input)
  File "/disk1/lhl/env/airs/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1130, in _call_impl
    return forward_call(*input, **kwargs)
  File "/disk1/lhl/env/airs/lib/python3.8/site-packages/torch/nn/modules/container.py", line 139, in forward
    input = module(input)
  File "/disk1/lhl/env/airs/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1130, in _call_impl
    return forward_call(*input, **kwargs)
  File "/disk1/lhl/env/airs/lib/python3.8/site-packages/torch/nn/modules/activation.py", line 98, in forward
    return F.relu(input, inplace=self.inplace)
  File "/disk1/lhl/env/airs/lib/python3.8/site-packages/torch/nn/functional.py", line 1457, in relu
    result = torch.relu(input)
RuntimeError: CUDA out of memory. Tried to allocate 1.56 GiB (GPU 0; 10.92 GiB total capacity; 7.02 GiB already allocated; 1.28 GiB free; 8.48 GiB reserved in total by PyTorch) If reserved memory is >> allocated memory try setting max_split_size_mb to avoid fragmentation.  See documentation for Memory Management and PYTORCH_CUDA_ALLOC_CONF
